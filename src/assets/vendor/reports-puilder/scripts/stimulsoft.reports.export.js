/*
Stimulsoft.Reports.JS
Version: 2020.4.2
Build date: 2020.09.09
License: https://www.stimulsoft.com/en/licensing/reports
*/
var Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft,Stimulsoft;!function(t){var e;!function(e){var i;!function(i){var r=t.Report.Export.StiExportService,n=t.System.IO.StreamWriter,s=t.Base.Localization.StiLocalization;class o extends r{constructor(){super(...arguments),this.multipleFiles=!1}implements(){return[i.IStiCsvExportService]}get defaultExtension(){return"csv"}get exportFormat(){return e.StiExportFormat.Csv}get groupCategory(){return"Data"}get position(){return i.StiExportPosition.Data}get exportNameInMenu(){return s.get("Export","ExportTypeCsvFile")}exportTo(t,e,r){this.exportCsv(t,e,r.stimulsoft.as(i.StiDataExportSettings))}exportToAsync(t,e,i,r){let n=this;setTimeout((function(){n.exportTo(e,i,r),t()}))}get getFilter(){return s.get("FileFilters","CsvFiles")}exportCsv(t,r,s){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Csv format"),null==s)throw new Error("The 'settings' argument cannot be equal in null.");let o=s.pageRange,a=s.separator,l=s.encoding,m=s.skipColumnHeaders,c=s.dataExportMode;"\\t"==a&&(a="\t");let g=o.getSelectedPages(t.renderedPages);this.currentPassNumber=0,this.maximumPassNumber=3;let h=new i.StiMatrix(g,!1,this,null,c);if(h.scanComponentsPlacement(!1),this.isStopped)return;if(h.prepareDocument(this,c),this.writer=new n(r,l),!m){for(let t=0;t<h.fields.length;t++){let e=h.fields[t].name.stimulsoft.replaceAll('"','""');-1==e.indexOf(a)&&-1==e.indexOf('"')&&-1==e.indexOf("\n")||(e='"'+e+'"'),this.writer.write(e),t<h.fields.length-1&&this.writer.write(a)}this.writer.writeLine("")}this.currentPassNumber=2;for(let t=0;t<h.dataArrayLength;t++){if(this.invokeExporting2(t,h.dataArrayLength-1,this.currentPassNumber,this.maximumPassNumber),this.isStopped)return;for(let e=0;e<h.fields.length;e++){let i=h.fields[e].dataArray[t];null==i&&(i=""),""!=i&&(-1==i.indexOf(a)&&-1==i.indexOf('"')&&-1==i.indexOf("\n")||(i=i.stimulsoft.replaceAll('"','""'),i='"'+i+'"'),this.writer.write(i)),e<h.fields.length-1&&this.writer.write(a)}this.writer.writeLine("")}this.writer.flush(),null!=h&&(h.clear(),h=null)}}i.StiCsvExportService=o}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.Base.Localization.StiLocalization;class n extends i.StiExportService{implements(){return[i.IStiDataExportService]}get defaultExtension(){if(this.exportSettings.stimulsoft.is(i.StiDataExportSettings)){let t=this.exportSettings.dataType;if(t==i.StiDataType.Dbf)return"dbf";if(t==i.StiDataType.Dif)return"dif";if(t==i.StiDataType.Sylk)return"slk";if(t==i.StiDataType.Xml)return"xml";if(t==i.StiDataType.Json)return"json"}return"csv"}get exportFormat(){if(this.exportSettings.stimulsoft.is(i.StiCsvExportSettings))return e.StiExportFormat.Csv;if(this.exportSettings.stimulsoft.is(i.StiDataExportSettings)){let t=this.exportSettings.dataType;if(t==i.StiDataType.Csv)return e.StiExportFormat.Csv;if(t==i.StiDataType.Dbf)return e.StiExportFormat.Dbf;if(t==i.StiDataType.Dif)return e.StiExportFormat.Dif;if(t==i.StiDataType.Sylk)return e.StiExportFormat.Sylk;if(t==i.StiDataType.Xml)return e.StiExportFormat.Xml;if(t==i.StiDataType.Json)return e.StiExportFormat.Json}return e.StiExportFormat.Data}get groupCategory(){return"Data"}get position(){return i.StiExportPosition.Data}get exportNameInMenu(){return r.get("Export","ExportTypeDataFile")}exportTo(t,e,i){this.exportData(t,e,i)}exportToAsync(t,e,i,r){let n=this;setTimeout((function(){n.exportTo(e,i,r),t()}))}get multipleFiles(){return!1}getFilter(){return r.get("FileFilters","CsvFiles")}exportData(t,e,r){this.exportSettings=r;let n=null!=r?r.dataType:i.StiDataType.Csv,s;(new i.StiCsvExportService).exportCsv(t,e,r)}}i.StiDataExportService=n}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.System.StiString,n=t.System.Drawing.ColorTranslator,s=t.System.Drawing.Color,o=t.Base.Localization.StiLocalization;class a extends i.StiExportService{constructor(){super(),this.renderAsDocument=!0,this.fileName="",this.htmlWriter=null,this.imageQuality=.75,this.imageResolution=96,this.compressToArchive=!1}implements(){return[i.IStiHtml5ExportService]}get defaultExtension(){if(this.compressToArchive)return"zip";return"html"}get exportFormat(){return e.StiExportFormat.Html5}get groupCategory(){return"Web"}get position(){return i.StiExportPosition.Html5}get exportNameInMenu(){return o.get("Export","ExportTypeHtml5File")}exportTo(t,e,i){this.exportHtml(t,e,i)}exportToAsync(t,e,i,r){let n=this;setTimeout((function(){n.exportTo(e,i,r),t()}))}get multipleFiles(){return!1}getFilter(){if(this.compressToArchive)return o.get("FileFilters","ZipArchives");return o.get("FileFilters","HtmlFiles")}renderPage(t,e,r){let n=i.StiSvgHelper.saveToString(t,e,!1,!1,r,this.imageFormat,this.imageQuality,this.imageResolution);this.htmlWriter.write(n),this.htmlWriter.flush()}renderStartDoc(t,e){this.htmlWriter.write("<!DOCTYPE html>"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.indent++,this.htmlWriter.writeFullBeginTag("title"),this.htmlWriter.write(this.report.reportAlias),this.htmlWriter.writeEndTag("title"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("meta"),this.htmlWriter.writeAttribute("charset",e.webName),this.htmlWriter.writeEndTag("meta"),this.htmlWriter.writeLine(),this.htmlWriter.indent--,this.htmlWriter.writeEndTag("head"),this.htmlWriter.writeLine(),this.htmlWriter.writeBeginTag("body"),this.htmlWriter.writeAttribute("bgcolor",n.toHtml(s.lightBlue)),this.htmlWriter.writeAttribute("style","text-align:center;"),this.htmlWriter.write(">"),this.htmlWriter.indent++,this.htmlWriter.writeLine()}renderEndDoc(){this.htmlWriter.indent--,this.htmlWriter.writeEndTag("body"),this.htmlWriter.indent--,this.htmlWriter.writeLine(),this.htmlWriter.writeEndTag("html")}exportHtml(i,n,s){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Html format"),null==s)throw new Error("The 'settings' argument cannot be equal in null.");let o=s.pageRange;this.imageFormat=s.imageFormat,this.imageResolution=s.imageResolution,this.imageQuality=s.imageQuality,this.compressToArchive=s.compressToArchive;let a=s.continuousPages;this.htmlWriter=n;let l=s.pageRange.getSelectedPages(i.renderedPages);try{if(this.report=i,1==this.renderAsDocument&&this.renderStartDoc(l,s.encoding),!(t.Base.jlFrR.QjjKg.ILZdh()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ())&&t.System.NodeJs.isStandaloneVersion)){let t=r.format("{3}{0}{2}{4}{1}",String.fromCharCode(114),String.fromCharCode(108),String.fromCharCode(105),String.fromCharCode(84),String.fromCharCode(97));n.write('<div style="FONT-SIZE: 10px; COLOR: red; FONT-FAMILY: Arial"'+">"+"Stimulsoft Reports - "+t+" Version</div>")}this.htmlWriter.indent=0;let e=1;for(let t of l.list){this.invokeExporting(t,l,0,1);let r={ref:e};this.renderPage(i,t,r),e=r.ref,a&&this.htmlWriter.write("<br/>"),this.htmlWriter.writeLine()}1==this.renderAsDocument&&this.renderEndDoc(),this.htmlWriter.flush()}finally{i=null}}}i.StiHtml5ExportService=a}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.System.StiArray,n=t.System.StiString,s=t.Report.Dashboard.StiDashboardExport,o=t.Report.Dashboard.IStiDashboard,a=t.System.Collections.Hashtable,l=t.System.Drawing.Color,m=t.System.Char,c=t.Report.Components.StiPagesCollection,g=t.System.Drawing.Size,h=t.Base.Drawing.StiTextHorAlignment,p=t.Base.Drawing.StiPenStyle,w=t.Base.Drawing.StiVertAlignment,S=t.Report.Components.StiText,d=t.Base.Drawing.StiBrush,u=t.System.Text.StringBuilder,f=t.Report.Components.IStiExportImageExtended,E=t.System.Text.Encoding,v=t.Base.Drawing.StiTextRenderer,b=t.Report.Components.StiRichText,y=t.System.IO.MemoryStream,x=t.System.Xml.XmlTextWriter,A=t.System.DateTime,T=t.Report.Components.StiCheckBox,P=t.Base.Zip.StiZipWriter20,L=t.System.Globalization.CultureInfo,C=t.Report.Components.StiPageOrientation,F=t.Base.Drawing.StiHtmlState,R=t.Base.Drawing.StiHtmlTagsState;class B extends i.StiExportService{constructor(){super(...arguments),this.matrix=null,this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.imageList=null,this.formatList=null,this.sstCount=0,this.sheetNameList=null,this.imageListOffset=0,this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null,this.useOnePageHeaderAndFooter=!1,this.exportDataOnly=!1,this.exportObjectFormatting=!0,this.exportEachPageToSheet=!1,this.exportHorizontalPageBreaks=!1,this.imageResolution=1,this.imageQuality=.75,this.imageCache=null,this.restrictEditing=i.StiExcel2007RestrictEditing.No,this.reportCulture=null,this.docCompanyString=null,this.docLastModifiedString=null,this.xmlIndentation=1,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}",this.refChars="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.HiToTwips=14.4/20*1.01,this.TwipsToColinfo=2.438*.976*.075}implements(){return[i.IStiExcel2007ExportService]}getDefaultExtension(){return"xlsx"}exportTo(t,e,i){this.exportExcel(t,e,i)}exportToAsync(e,i,r,n){t.Report.Export.StiExportImageHelper.convertAllImages(i,t.System.Drawing.Imaging.ImageFormat.Jpeg).try(()=>{if(!i.isDocument&&i.getCurrentPage().stimulsoft.is(o))return void s.exportAsync(i,r,n).try(()=>e());this.exportTo(i,r,n),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null),e()})}getLineStyle(t){let e=p.None,i=0,r=1.5,n=3;switch(null!=t&&(e=t.style,i=t.size),e){case p.Solid:if(i>n)return"thick";if(i>r)return"medium";return"thin";case p.Dot:if(i>r)return"dotted";return"hair";case p.Dash:if(i>r)return"mediumDashed";return"dashed";case p.DashDot:if(i>r)return"mediumDashDot";return"dashDot";case p.DashDotDot:if(i>r)return"mediumDashDotDot";return"dashDotDot";case p.Double:return"double";default:return null}}getRefString(t,e){let i=Math.trunc(t/26),r=Math.trunc(t%26),n=new u;return i>0&&n.append(this.refChars.charAt(i-1)),n.append(this.refChars.charAt(r)),n.append((e+1).toString()),n.toString()}getRefAbsoluteString(t,e){let i=Math.trunc(t/26),r=Math.trunc(t%26),n=new u;return n.append("$"),i>0&&n.append(this.refChars.charAt(i-1)),n.append(this.refChars.charAt(r)),n.append("$"),n.append((e+1).toString()),n.toString()}floatToString(t){let e;return t.toString().stimulsoft.replaceAll(",",".")}stringToUrl(t){let e=new u;for(let i=0;i<t.length;i++){let r=t.charAt(i);if("'"==r)continue;r.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(r)?e.append(n.format("%{0:x2}",r.charCodeAt(0))):e.append(r)}return e.toString()}getFontNumber(t){if(this.fontList.length>0)for(let e=0;e<this.fontList.length;e++)if(this.fontList[e].stimulsoft.equals(t))return e;let e;return this.fontList.push(t),this.fontList.length-1}getFillNumber(t){if(this.fillList.length>0)for(let e=0;e<this.fillList.length;e++)if(this.fillList[e].stimulsoft.equals(t))return e;let e;return this.fillList.push(t),this.fillList.length-1}getBorderNumber(t){if(this.borderList.length>0)for(let e=0;e<this.borderList.length;e++)if(this.borderList[e].stimulsoft.equals(t))return e;let e;return this.borderList.push(t),this.borderList.length-1}getXFNumber(t){if(this.xfList.length>0)for(let e=0;e<this.xfList.length;e++)if(this.xfList[e].equalDataXF(t))return e;let e;return this.xfList.push(t),this.xfList.length-1}getSSTNumber(t){if(this.sstCount++,this.sstList.length>0&&this.sstHash.containsKey(t))return this.sstHash.get(t);this.sstList.push(t);let e=this.sstList.length-1;return this.sstHash.add(t,e),e}getFormatNumber(t){if(this.formatList.length>0)for(let e=0;e<this.formatList.length;e++)if(this.formatList[e]==t)return e+164;let e;return this.formatList.push(t),this.formatList.length-1+164}convert(t){return t*this.HiToTwips}compareExcellSheetNames(t,e){let i=t;null!=i&&0!=i.length||(i="");let r=e;return null!=r&&0!=r.length||(r=""),i==r}prepareData(){this.fontList=new Array,this.fillList=new Array,this.borderList=new Array,this.xfList=new Array,this.sstList=[],this.sstHash=new a,this.sstHashIsTags=new a,this.imageList=[],this.formatList=[],this.sheetNameList=[],this.sstCount=0,this.printAreasList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.imageCache=new e.StiImageCache(t["StiOptions"].Export.Excel.AllowImageComparer,!0,e.ImageFormat.Jpeg,this.imageQuality,!1);let i=new I("Arial",!1,!1,!1,!1,10,l.black,1,0);this.getFontNumber(i);let r=new k("none",l.transparent,l.black);this.getFillNumber(r),r=new k("gray125",l.transparent,l.black),this.getFillNumber(r);let n=new D(null,null,null,null);this.getBorderNumber(n);let s=new N(0,0,0,0,0,h.Left,w.Bottom,0,!1,!1,!1);this.getXFNumber(s)}writeContentTypes(){let t=new y,e=new x(E.UTF8,t);e.writeStartDocument(),e.writeStartElement("Types"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),e.writeStartElement("Default"),e.writeAttributeString("Extension","rels"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","xml"),e.writeAttributeString("ContentType","application/xml"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","jpeg"),e.writeAttributeString("ContentType","image/jpeg"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","png"),e.writeAttributeString("ContentType","image/png"),e.writeEndElement(),e.writeStartElement("Default"),e.writeAttributeString("Extension","vml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.vmlDrawing"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/app.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/docProps/core.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),e.writeEndElement(),e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/workbook.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),e.writeEndElement();for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",n.format("/xl/worksheets/sheet{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/styles.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),e.writeEndElement();for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Override"),e.writeAttributeString("PartName",n.format("/xl/drawings/drawing{0}.xml",t+1)),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"),e.writeEndElement();return this.sstList.length>0&&(e.writeStartElement("Override"),e.writeAttributeString("PartName","/xl/sharedStrings.xml"),e.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeMainRels(){let t=new y,e=new x(E.UTF8,t);return e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","xl/workbook.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(){let t=new y,e=new x(E.UTF8,t);e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Excel"),e.writeElementString("DocSecurity","0"),e.writeElementString("ScaleCrop","false"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("LinksUpToDate","false"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeStartElement("HeadingPairs"),e.writeStartElement("vt:vector"),e.writeAttributeString("size","4"),e.writeAttributeString("baseType","variant"),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Worksheets"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",n.format("{0}",this.sheetNameList.length)),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:lpstr","Named Ranges"),e.writeEndElement(),e.writeStartElement("vt:variant"),e.writeElementString("vt:i4",n.format("{0}",this.sheetNameList.length)),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("TitlesOfParts"),e.writeStartElement("vt:vector"),e.writeAttributeString("size",n.format("{0}",2*this.sheetNameList.length)),e.writeAttributeString("baseType","lpstr");for(let t=0;t<this.sheetNameList.length;t++)e.writeElementString("vt:lpstr",this.sheetNameList[t]);for(let t=0;t<this.sheetNameList.length;t++)e.writeElementString("vt:lpstr",n.format("'{0}'!Print_Area",this.sheetNameList[t]));return e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(){let e=new y,i=new x(E.UTF8,e);i.writeStartDocument(),i.writeStartElement("cp:coreProperties"),i.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),i.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),i.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");let r=n.format("{0}{1}",A.now.toString("yyyy-MM-dd"),A.now.toString("THH:mm:ssZ"));return i.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),i.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),i.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),i.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),i.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),i.writeStartElement("dcterms:created"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),i.writeStartElement("dcterms:modified"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),i.writeElementString("cp:contentStatus",t.StiVersion.platform()),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeWorkbookRels(){let t=new y,e=new x(E.UTF8,t);e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),e.writeAttributeString("Target",n.format("worksheets/sheet{0}.xml",t+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",this.sheetNameList.length+2)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),e.writeAttributeString("Target","styles.xml"),e.writeEndElement(),this.sstCount>0&&(e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",this.sheetNameList.length+3)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings"),e.writeAttributeString("Target","sharedStrings.xml"),e.writeEndElement()),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeWorkbook(){let t=new y,e=new x(E.UTF8,t);e.writeStartDocument(),e.writeStartElement("workbook"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeStartElement("fileVersion"),e.writeAttributeString("appName","xl"),e.writeAttributeString("lastEdited","4"),e.writeAttributeString("lowestEdited","4"),e.writeAttributeString("rupBuild","4505"),e.writeEndElement(),e.writeStartElement("workbookPr"),e.writeAttributeString("defaultThemeVersion","124226"),e.writeEndElement(),e.writeStartElement("bookViews"),e.writeStartElement("workbookView"),e.writeAttributeString("xWindow","120"),e.writeAttributeString("yWindow","15"),e.writeAttributeString("windowWidth","18975"),e.writeAttributeString("windowHeight","11955"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("sheets");for(let t=0;t<this.sheetNameList.length;t++)e.writeStartElement("sheet"),e.writeAttributeString("name",this.sheetNameList[t]),e.writeAttributeString("sheetId",n.format("{0}",t+1)),e.writeAttributeString("r:id",n.format("rId{0}",t+1)),e.writeEndElement();e.writeEndElement(),e.writeStartElement("definedNames");for(let t=0;t<this.sheetNameList.length;t++){let i=this.printAreasList[t];i.height>1048575&&(i.height=1048575),i.width>16383&&(i.width=16383);let r=this.getRefAbsoluteString(i.width,i.height);e.writeStartElement("definedName"),e.writeAttributeString("name","_xlnm.Print_Area"),e.writeAttributeString("localSheetId",n.format("{0}",t)),e.writeString(n.format("'{0}'!$A$1:{1}",this.sheetNameList[t],r)),e.writeEndElement()}return e.writeEndElement(),e.writeStartElement("calcPr"),e.writeAttributeString("calcId","124519"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSheetRels(e){let i=new y,r=new x(E.UTF8,i);if(r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),this.imageList.length-this.imageListOffset>0&&(r.writeStartElement("Relationship"),r.writeAttributeString("Id",n.format("rId{0}",1)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),r.writeAttributeString("Target",n.format("../drawings/drawing{0}.xml",e+1)),r.writeEndElement()),this.hyperlinkList.length>0)for(let t=0;t<this.hyperlinkList.length;t++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",n.format("rId{0}",2+t)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",this.hyperlinkList[t]),r.writeAttributeString("TargetMode","External"),r.writeEndElement();return t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(r.writeStartElement("Relationship"),r.writeAttributeString("Id","dId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing"),r.writeAttributeString("Target","../drawings/vmlDrawingAdditional.vml"),r.writeEndElement()),r.writeFullEndElement(),r.writeEndDocument(),r.flush(),i}writeSheet(s,o){let a=new y,c=new x(E.UTF8,a);c.writeStartDocument(),c.writeStartElement("worksheet"),c.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),c.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),t["StiOptions"].Export.Excel.FitToOnePageWide&&(c.writeStartElement("sheetPr"),c.writeStartElement("pageSetUpPr"),c.writeAttributeString("fitToPage","1"),c.writeEndElement(),c.writeEndElement()),this.matrix=this.matrixList[s];let h=this.minRowList[s],p=this.maxRowList[s],w=new g(this.matrix.coordX.countItems-2,p-h-1);w.width<0&&(w.width=0),w.height<0&&(w.height=0),this.printAreasList.push(w);let d=[];c.writeStartElement("dimension"),c.writeAttributeString("ref",n.format("{0}:{1}",this.getRefString(0,0),this.getRefString(w.width,w.height))),c.writeEndElement();let v=0,A=0;if(t["StiOptions"].Export.Excel.AllowFreezePanes)for(let t=h;t<p;t++)for(let e=0;e<this.matrix.coordX.countItems-1;e++){let i=this.matrix.cells[t][e];if(null!=i&&null!=i.component&&(i.component.locked||null!=i.component.tagValue&&i.component.tagValue.toString().contains("excelfreezepanes"))){let t=i.component.componentPlacement;if(null!=t&&t.length>0&&(t.stimulsoft.startsWith("rt")||t.stimulsoft.startsWith("ph")||t.stimulsoft.startsWith("h"))){v=i.left,A=i.top+i.height+1;break}}}c.writeStartElement("sheetViews"),c.writeStartElement("sheetView"),t["StiOptions"].Export.Excel.ColumnsRightToLeft&&c.writeAttributeString("rightToLeft","1"),t["StiOptions"].Export.Excel.ShowGridLines||c.writeAttributeString("showGridLines","0"),c.writeAttributeString("tabSelected","1"),c.writeAttributeString("workbookViewId","0"),0==v&&0==A?(c.writeStartElement("selection"),c.writeAttributeString("activeCell","A1"),c.writeAttributeString("sqref","A1"),c.writeEndElement()):0==v?(c.writeStartElement("pane"),c.writeAttributeString("ySplit",A.toString()),c.writeAttributeString("topLeftCell",this.getRefString(v,A)),c.writeAttributeString("activePane","bottomLeft"),c.writeAttributeString("state","frozen"),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","bottomLeft"),c.writeAttributeString("activeCell",this.getRefString(0,A)),c.writeAttributeString("sqref",this.getRefString(0,A)),c.writeEndElement()):(c.writeStartElement("pane"),c.writeAttributeString("xSplit",v.toString()),c.writeAttributeString("ySplit",A.toString()),c.writeAttributeString("topLeftCell",this.getRefString(v,A)),c.writeAttributeString("activePane","bottomRight"),c.writeAttributeString("state","frozen"),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","topRight"),c.writeAttributeString("activeCell",this.getRefString(v,0)),c.writeAttributeString("sqref",this.getRefString(v,0)),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","bottomLeft"),c.writeAttributeString("activeCell",this.getRefString(0,A)),c.writeAttributeString("sqref",this.getRefString(0,A)),c.writeEndElement(),c.writeStartElement("selection"),c.writeAttributeString("pane","bottomRight"),c.writeAttributeString("activeCell",this.getRefString(v,A)),c.writeAttributeString("sqref",this.getRefString(v,A)),c.writeEndElement()),c.writeEndElement(),c.writeEndElement(),c.writeStartElement("sheetFormatPr"),c.writeAttributeString("defaultRowHeight",n.format("{0}",15)),c.writeEndElement();let P=this.matrix.coordX.getKeys(),L=this.matrix.coordY.getKeys();if(this.exportObjectFormatting){c.writeStartElement("cols");for(let t=0;t<this.matrix.coordX.countItems-1;t++){let e=this.matrix.coordX.getByIndex(t+1,P),i=this.matrix.coordX.getByIndex(t,P),r=this.convert(e-i)*this.TwipsToColinfo;c.writeStartElement("col"),c.writeAttributeString("min",n.format("{0}",t+1)),c.writeAttributeString("max",n.format("{0}",t+1)),c.writeAttributeString("width",n.format("{0}",r)),c.writeAttributeString("customWidth","1"),c.writeEndElement()}c.writeEndElement()}let F=null,R=r.create2(Boolean,p+1,this.matrix.coordX.countItems),B=r.create2(Number,p+1,this.matrix.coordX.countItems),U=[],X=[];c.writeStartElement("sheetData");for(let r=h;r<p;r++){let s=this.matrix.coordY.getByIndex(r+1,L)-this.matrix.coordY.getByIndex(r,L);c.writeStartElement("row"),c.writeAttributeString("r",n.format("{0}",r+1-h)),c.writeAttributeString("spans",n.format("{0}:{1}",1,this.matrix.coordX.countItems-1)),this.exportObjectFormatting&&(c.writeAttributeString("ht",n.format("{0}",this.convert(s))),c.writeAttributeString("customHeight","1"));for(let s=0;s<this.matrix.coordX.countItems-1;s++){let o=this.matrix.cells[r][s];if(R[r]&&0==R[r][s]&&null!=o){R[r][s]=!0;let a=o.component.stimulsoft.as(b),g=o.component.stimulsoft.as(S),p=o.text,w=o.component.stimulsoft.as(T),E=!1;null!=w&&null!=w.excelDataValue&&w.excelDataValue.length>0&&(E=!0,p=w.excelDataValue);let v=null;if(null!=o.component.hyperlinkValue&&(v=o.component.hyperlinkValue.toString().trim(),v.length>0&&!v.stimulsoft.startsWith("javascript:"))){let t=p;null!=t&&0!=t.length||(t=v);let e=new O(r-h,r-h+o.height,s,s+o.width),i=new M(e,t,v);X.push(i)}let y=!1,x=o.component.stimulsoft.as(f);if(null!=x){let t=this.imageResolution,i=null;if(o.component.isExportAsImage(e.StiExportFormat.Excel2007)){let t={ref:this.imageResolution};i=x.getImage(t,e.StiExportFormat.Excel)}if(null!=i){let t=this.matrix.getRealImageData(o,i);null!=t&&(i=t);let e=this.imageCache.addImageIntRaw(i,i.imageFormat),n=new H(r-h,0,s,0,r-h+1+o.height,0,s+1+o.width,0,e,v);this.imageList.push(n),y=!0}}let A=!1;if(null!=o.component&&null!=o.component.tagValue){let t;-1!=o.component.tagValue.toString().toLowerCase().indexOf("exceltext")&&(A=!0,d.push(this.getRefString(s,r)))}let P="";null!=g&&(P=g.format);let L=!1,C=!1,F=!1,W=!1,z=!1,j=!1,Y=!1,G="",V=2,_=0,q=this.reportCulture.numberFormat.currencySymbol,K=0==this.reportCulture.numberFormat.currencyPositivePattern||2==this.reportCulture.numberFormat.currencyPositivePattern,Q=!1,J=null!=g&&g.hideZeros,Z=null,$=null,tt=P.indexOf("|");if(-1!=tt&&(Z=i.StiExportUtils.getPositivePattern(P.charCodeAt(tt+1)-65),$=i.StiExportUtils.getNegativePattern(P.charCodeAt(tt+2)-65),P=P.substr(0,tt)),null!=P&&P.length>0)if("C"==P[0]?L=!0:"N"==P[0]?C=!0:"P"==P[0]?F=!0:"D"==P[0]?W=!0:"T"==P[0]?z=!0:"U"==P[0]&&(j=!0),1==P.length)Y=!0;else if(L||C||F){let t=1;if(m.isDigit(P[t])){let e=new u;while(t<P.length&&m.isDigit(P[t]))e.append(P[t]),t++;V=parseInt(e.toString())}t<P.length&&"G"==P[t]&&(t++,_=3),t<P.length&&"("==P[t]&&(t++,Q=!0),t<P.length&&("."==P[t]||","==P[t])&&t++,t<P.length&&("+"==P[t]||"-"==P[t])&&("+"==P[t]&&(K=!0),t++,q=t<P.length?P.substring(t):"")}if(L||C||F||(Y=!0),L&&Y&&(Y=!1),J&&!n.isNullOrEmpty(P)&&(Y=!1),A&&(Y=!0),!Y)if(-1!=tt){let t=new u;_>1&&(t.append("#,"),t.appendCount("#",_-1)),t.append("0"),V>0&&(t.append("."),t.appendCount("0",V));let e=t.toString(),i,r;G=Z.stimulsoft.replaceAll("n",e).stimulsoft.replaceAll("$",'"'+q+'"')+";"+$.stimulsoft.replaceAll("n",e).stimulsoft.replaceAll("$",'"'+q+'"')+(J?";":"")}else{let t=new u;L&&1==K&&(t.append('"'),t.append(q),t.append('"')),_>1&&(t.append("#,"),t.appendCount("#",_-1)),t.append("0"),V>0&&(t.append("."),t.appendCount("0",V)),L&&0==K&&(t.append('"'),t.append(q),t.append('"')),F&&t.append("%"),G=t.toString();let e=(Q?"(":"-")+G+(Q?")":"");J?G=G+";"+e+";":Q&&(G=G+";"+e)}let et=0;Y?(C&&(et=4),F&&(et=10),W&&(et=14),z&&(et=21),A&&(et=49)):et=this.getFormatNumber(G);let it=0;if(this.exportObjectFormatting){let e=o.cellStyle,r=new I(e.font.name,e.font.bold,e.font.italic,e.font.underline,e.font.strikeout,Math.round(e.font.sizeInPoints),e.textColor,1,0);E&&(r=new I(t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.strikeout,Math.round(t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints),e.textColor,1,0));let s=new k("solid",e.color,e.color);y&&(s=new k("solid",l.transparent,l.transparent));let a=!0,m=!0;for(let t=0;t<o.height+1;t++)null==this.matrix.bordersY[o.top+t][o.left]&&(a=!1),null==this.matrix.bordersY[o.top+t][o.left+o.width+1]&&(m=!1);let c=!0,h=!0;for(let t=0;t<o.width+1;t++)null==this.matrix.bordersX[o.top][o.left+t]&&(c=!1),null==this.matrix.bordersX[o.top+o.height+1][o.left+t]&&(h=!1);let w=new D(a?this.matrix.bordersY[o.top][o.left]:null,m?this.matrix.bordersY[o.top][o.left+o.width+1]:null,c?this.matrix.bordersX[o.top][o.left]:null,h?this.matrix.bordersX[o.top+o.height+1][o.left]:null),d=!1;null!=e.textOptions&&(d=e.textOptions.rightToLeft);let u=!1;null!=e.textOptions&&(u=e.textOptions.wordWrap),n.isNullOrEmpty(p)||(-1==p.indexOf("\r")&&-1==p.indexOf("\n")||(u=!0),null==g||!g.checkAllowHtmlTags()||-1==p.indexOf("<br")&&-1==p.indexOf("<ul")&&-1==p.indexOf("<ol")&&-1==p.indexOf("<p")||(u=!0));let f=0;if(null!=e.textOptions){let t=Math.ceil(e.textOptions.angle);t>=0&&t<=90&&(f=t),t>=270&&t<360&&(f=360-t+90)}let v=this.restrictEditing==i.StiExcel2007RestrictEditing.ExceptEditableFields&&null!=o.component&&o.component.stimulsoft.is(S)&&o.component.stimulsoft.as(S).Editable,b=new N(et,this.getFontNumber(r),this.getFillNumber(s),this.getBorderNumber(w),0,E?t["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment:e.horAlignment,E?t["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment:e.vertAlignment,f,u,d,v);it=this.getXFNumber(b)}if(c.writeStartElement("c"),c.writeAttributeString("r",this.getRefString(s,r-h)),c.writeAttributeString("s",it.toString()),this.exportObjectFormatting){for(let t=0;t<=o.width;t++)for(let e=0;e<=o.height;e++)R[r+e][s+t]=!0,B[r+e][s+t]=it;if(o.width>0||o.height>0){let t=new O(r-h,r-h+o.height,s,s+o.width);U.push(t)}}else R[r][s]=!0,B[r][s]=it;if(!o.component.isExportAsImage(e.StiExportFormat.Excel2007)&&(null!=p&&p.length>0||null!=g&&null!=g.excelDataValue)){let e=!1,r=!1,n=0;if(null!=g&&null!=g.excelDataValue&&"-"!=g.excelDataValue){let i=g.excelDataValue,s=i.trim().stimulsoft.replaceAll(",",".");if(null!=s&&s.length>0&&this.checkForNumber(s)){r=!0;try{W||z?r=!1:(n=parseFloat(s),isNaN(n)&&(r=!1,n=0))}catch(e){t.System.StiError.showError(e,!1),r=!1}}j&&(r=!1),i!=p&&i.stimulsoft.startsWith("=")&&(e=!0),r||null!=p||(p=i)}if(e){let e=g.excelDataValue.stimulsoft.replaceAll("\r","").stimulsoft.replaceAll("\t"," ").substring(1);t["StiOptions"].Export.Excel.TrimTrailingSpaces&&(e=i.StiExportUtils.trimEndWhiteSpace(e)),c.writeElementString("f",e)}else if(1==r)c.writeElementString("v",n.toString().stimulsoft.replaceAll(",","."));else{let e=p.stimulsoft.replaceAll("\r","").stimulsoft.replaceAll("\t"," ");t["StiOptions"].Export.Excel.TrimTrailingSpaces&&(e=i.StiExportUtils.trimEndWhiteSpace(e));let r=0;null!=g&&g.checkAllowHtmlTags()?(e=this.convertAllowHtmlTagsToExcelString(g,e),r=this.getSSTNumber(e),this.sstHashIsTags.add(r,null)):r=this.getSSTNumber(e),c.writeAttributeString("t","s"),c.writeElementString("v",r.toString())}}c.writeEndElement()}else{let e=0;R[r][s]&&(e=B[r][s]);let i=null!=this.matrix.bordersY[r+0][s+0],n=null!=this.matrix.bordersY[r+0][s+1],o=null!=this.matrix.bordersX[r+0][s+0],a;try{a=null!=this.matrix.bordersX[r+1][s+0]}catch(e){t.System.StiError.showError(e,!1)}if(i||n||o||a||0!=e){let t=new D(i?this.matrix.bordersY[r+0][s+0]:null,n?this.matrix.bordersY[r+0][s+1]:null,o?this.matrix.bordersX[r+0][s+0]:null,a?this.matrix.bordersX[r+1][s+0]:null),l=this.xfList[e],m=new N(l.FormatIndex,l.FontIndex,l.FillIndex,this.getBorderNumber(t),l.XFId,l.HorAlign,l.VertAlign,l.TextRotationAngle,l.TextWrapped,l.RightToLeft,l.Editable),g=this.getXFNumber(m);this.exportObjectFormatting||(g=0),c.writeStartElement("c"),c.writeAttributeString("r",this.getRefString(s,r-h)),c.writeAttributeString("s",g.toString()),c.writeEndElement()}}}c.writeEndElement()}if(c.writeEndElement(),this.restrictEditing!=i.StiExcel2007RestrictEditing.No&&(c.writeStartElement("sheetProtection"),c.writeAttributeString("password","F05F"),c.writeAttributeString("sheet","1"),c.writeAttributeString("objects","1"),c.writeAttributeString("scenarios","1"),c.writeEndElement()),U.length>0&&(!this.exportDataOnly||this.exportObjectFormatting)){c.writeStartElement("mergeCells"),c.writeAttributeString("count",n.format("{0}",U.length));for(let t=0;t<U.length;t++){let e=U[t];c.writeStartElement("mergeCell"),c.writeAttributeString("ref",n.format("{0}:{1}",this.getRefString(e.FirstColumn,e.FirstRow),this.getRefString(e.LastColumn,e.LastRow))),c.writeEndElement()}c.writeEndElement()}if(X.length>0){let t=!1;for(let e=0;e<X.length;e++){let i,r=X[e].Bookmark;if(r.stimulsoft.startsWith("#")){r=r.substring(1);let e=!1;for(let e=0;e<this.matrixList.length;e++){let i=this.matrixList[e].bookmarksTable;if(null!=i){let n=i.get(r);if(null!=n){let i=this.minRowList[e],r=this.maxRowList[e],s=n.stimulsoft.as(g);if(s.height>=i&&s.height<r){t=!0;break}}}}}else t=!0;if(t)break}if(t){c.writeStartElement("hyperlinks");for(let t=0;t<X.length;t++){let e=X[t],i=e.Bookmark;if(i.stimulsoft.startsWith("#")){i=i.substring(1);let t=!1;for(let e=0;e<this.matrixList.length;e++){let r=this.matrixList[e].bookmarksTable;if(null!=r){let s=r.get(i);if(null!=s){let r=this.minRowList[e],o=this.maxRowList[e],a=s.stimulsoft.as(g);if(a.height>=r&&a.height<o){i=n.format("'{0}'!{1}",this.sheetNameList[e],this.getRefString(a.width,a.height-r)),t=!0;break}}}}t&&(c.writeStartElement("hyperlink"),c.writeAttributeString("ref",this.getRefString(e.Range.FirstColumn,e.Range.FirstRow)),c.writeAttributeString("location",i),c.writeAttributeString("display",e.Description),c.writeEndElement())}else{let t=i;i.stimulsoft.startsWith("file:\\\\\\")&&(t=i.substring(8),i="file:///"+t),i.stimulsoft.startsWith("http:")&&(i=i.stimulsoft.replaceAll(" ","")),c.writeStartElement("hyperlink"),c.writeAttributeString("ref",this.getRefString(e.Range.FirstColumn,e.Range.FirstRow)),c.writeAttributeString("r:id",n.format("rId{0}",2+this.hyperlinkList.length)),c.writeAttributeString("display",t),c.writeEndElement(),this.hyperlinkList.push(this.stringToUrl(i))}}c.writeEndElement()}}c.writeStartElement("pageMargins"),c.writeAttributeString("left",this.floatToString(o.convertToHInches(o.unit,o.margins.left)/100)),c.writeAttributeString("right",this.floatToString(o.convertToHInches(o.unit,o.margins.right)/100)),c.writeAttributeString("top",this.floatToString(o.convertToHInches(o.unit,o.margins.top)/100)),c.writeAttributeString("bottom",this.floatToString(o.convertToHInches(o.unit,o.margins.bottom)/100)),c.writeAttributeString("header",this.floatToString(0)),c.writeAttributeString("footer",this.floatToString(0)),c.writeEndElement(),c.writeStartElement("pageSetup"),c.writeAttributeString("paperSize",n.format("{0}",o.paperSize)),c.writeAttributeString("orientation",o.orientation==C.Portrait?"portrait":"landscape"),t["StiOptions"].Export.Excel.FitToOnePageWide&&c.writeAttributeString("fitToHeight","0"),c.writeEndElement(),t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(c.writeStartElement("headerFooter"),c.writeStartElement("oddHeader"),c.writeRaw("&amp;C\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n&amp;G"),c.writeEndElement(),c.writeEndElement());let W=this.matrix.horizontalPageBreaks.length;if(this.exportHorizontalPageBreaks&&W>0){c.writeStartElement("rowBreaks"),c.writeAttributeString("count",W.toString()),c.writeAttributeString("manualBreakCount",W.toString());for(let t=0;t<W;t++)c.writeStartElement("brk"),c.writeAttributeString("id",n.format("{0}",this.matrix.horizontalPageBreaks[t])),c.writeAttributeString("max",0==t?"16383":"8"),c.writeAttributeString("man","1"),c.writeEndElement();c.writeEndElement()}if(this.imageList.length>this.imageListOffset&&(c.writeStartElement("drawing"),c.writeAttributeString("r:id",n.format("rId{0}",1)),c.writeEndElement()),d.length>0){c.writeStartElement("ignoredErrors");for(let t in d)c.writeStartElement("ignoredError"),c.writeAttributeString("sqref",d[t]),c.writeAttributeString("numberStoredAsText","1"),c.writeEndElement();c.writeEndElement()}return t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(c.writeStartElement("legacyDrawingHF"),c.writeAttributeString("r:id","dId1"),c.writeEndElement()),c.writeFullEndElement(),c.writeEndDocument(),c.flush(),a}checkForNumber(t){let e=t.match(B.regexCheckInteger1);if(null!=e)return!0;if(e=t.match(B.regexCheckFloat1),null!=e)return!0;return!1}prepareMatrix(e){let r=i.StiDataExportMode.AllBands;if(this.exportDataOnly&&(r=i.StiDataExportMode.Data|i.StiDataExportMode.Headers,t["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode&&(r|=i.StiDataExportMode.Footers)),this.matrix=new i.StiMatrix(e,t["StiOptions"].Export.Excel.DivideBigCells,this,null,r),this.useOnePageHeaderAndFooter){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);let t=0;while(this.matrix.linePlacement[t]!=i.StiTableLineInfo.PageHeader&&t<this.matrix.coordY.countItems-1)t++;if(this.matrix.linePlacement[t]==i.StiTableLineInfo.PageHeader){while(this.matrix.linePlacement[t]==i.StiTableLineInfo.PageHeader&&t<this.matrix.coordY.countItems-1)t++;while(t<this.matrix.coordY.countItems-1)this.matrix.linePlacement[t]==i.StiTableLineInfo.PageHeader&&(this.matrix.linePlacement[t]=i.StiTableLineInfo.Trash),t++}t=this.matrix.coordY.countItems-1;while(this.matrix.linePlacement[t]!=i.StiTableLineInfo.PageFooter&&t>0)t--;if(this.matrix.linePlacement[t]==i.StiTableLineInfo.PageFooter){while(this.matrix.linePlacement[t]==i.StiTableLineInfo.PageFooter&&t>0)t--;while(t>0)this.matrix.linePlacement[t]==i.StiTableLineInfo.PageFooter&&(this.matrix.linePlacement[t]=i.StiTableLineInfo.Trash),t--}let e=0;for(let t=0;t<this.matrix.coordY.countItems-1;t++)if(this.matrix.linePlacement[t]!=i.StiTableLineInfo.Trash){for(let i=0;i<this.matrix.coordX.countItems-1;i++){this.matrix.cells[e][i]=this.matrix.cells[t][i];let r=this.matrix.cells[e][i];if(null!=r&&(r.top=e,null!=r.exportImage)){let t=r.component}this.matrix.bordersX[e][i]=this.matrix.bordersX[t][i],this.matrix.bordersY[e][i]=this.matrix.bordersY[t][i],this.matrix.bookmarks[e][i]=this.matrix.bookmarks[t][i]}this.matrix.bordersY[e][this.matrix.coordX.countItems-1]=this.matrix.bordersY[t][this.matrix.coordX.countItems-1];let i=this.matrix.coordY.getKeys(),r=this.matrix.coordY.getByIndex(t+1,i)-this.matrix.coordY.getByIndex(t,i);this.matrix.coordY.setByIndex(e+1,this.matrix.coordY.getByIndex(e,i)+r),e++}for(let t=0;t<this.matrix.coordX.countItems-1;t++)this.matrix.bordersX[e][t]=this.matrix.bordersX[this.matrix.coordY.countItems-1][t];let r=this.matrix.coordY.countItems-1-e;if(r>0)for(let t=0;t<r;t++)this.matrix.coordY.removeByIndex(e+1)}if(this.exportDataOnly){this.matrix.scanComponentsPlacement(!0,this.exportObjectFormatting);let e=0,r=new a,n=null,s=t["StiOptions"].Export.Excel.AllowExportFootersInDataOnlyMode;for(let t=0;t<this.matrix.coordY.countItems-1;t++){let o=!1;if(this.matrix.linePlacement[t]==i.StiTableLineInfo.HeaderD||this.matrix.linePlacement[t]==i.StiTableLineInfo.HeaderAP){let e=this.matrix.parentBandName[t],i=e.indexOf("");if(-1!=i){let t=e.substring(0,i);t!=n&&(n=t,r.clear())}r.containsKey(e)||(o=!0,r.add(e,e))}if(this.matrix.linePlacement[t]==i.StiTableLineInfo.Data||s&&this.matrix.linePlacement[t]==i.StiTableLineInfo.FooterD||o){for(let i=0;i<this.matrix.coordX.countItems-1;i++){this.matrix.cells[e][i]=this.matrix.cells[t][i];let r=this.matrix.cells[e][i];if(null!=r&&(r.top=e,null!=r.exportImage)){let t=r.component}0!=e&&null==this.matrix.bordersX[t][i]||(this.matrix.bordersX[e][i]=this.matrix.bordersX[t][i]),this.matrix.bordersX[e+1][i]=this.matrix.bordersX[t+1][i],this.matrix.bordersY[e][i]=this.matrix.bordersY[t][i],this.matrix.bookmarks[e][i]=this.matrix.bookmarks[t][i]}this.matrix.bordersY[e][this.matrix.coordX.countItems-1]=this.matrix.bordersY[t][this.matrix.coordX.countItems-1];let i=this.matrix.coordY.getKeys(),r=this.matrix.coordY.getByIndex(t+1,i)-this.matrix.coordY.getByIndex(t,i);this.matrix.coordY.setByIndex(e+1,this.matrix.coordY.getByIndex(e,i)+r),e++}}let o=this.matrix.coordY.countItems-1-e;if(o>0)for(let t=0;t<o;t++)this.matrix.coordY.removeByIndex(e+1)}}convertAllowHtmlTagsToExcelString(t,e){let i=new x(E.UTF8),r=new R(t.font.bold,t.font.italic,t.font.underline,t.font.strikeout,t.font.sizeInPoints,t.font.name,d.toColor(t.textBrush),d.toColor(t.brush),!1,!1,0,0,1,t.horAlignment),s=new F(r,0),o=v.parseHtmlToStates(t.text,s);for(let t=0;t<o.length;t++){let e=o[t];i.writeStartElement("r"),i.writeStartElement("rPr"),e.ts.bold&&i.writeElementString("b",null),e.ts.italic&&i.writeElementString("i",null),e.ts.underline&&i.writeElementString("u",null),e.ts.strikeout&&i.writeElementString("strike",null),e.ts.superscript&&(i.writeStartElement("vertAlign"),i.writeAttributeString("val","superscript"),i.writeEndElement()),e.ts.subsript&&(i.writeStartElement("vertAlign"),i.writeAttributeString("val","subscript"),i.writeEndElement()),i.writeStartElement("sz"),i.writeAttributeString("val",e.ts.fontSize.toString()),i.writeEndElement(),i.writeStartElement("color"),i.writeAttributeString("rgb",n.format("{0:X8}",e.ts.fontColor.toArgb())),i.writeEndElement(),i.writeStartElement("rFont"),i.writeAttributeString("val",e.ts.fontName),i.writeEndElement(),i.writeEndElement(),this.convertTextToExcelString(i,v.prepareStateText(e.text).toString()),i.writeEndElement()}return i.flush(),i.close(),i.textWriter.getStringBuilder().toString()}convertTextToExcelString(t,e){t.writeStartElement("t"),e.length>0&&(m.isWhitespace(e,e.length-1)||-1!=e.indexOf("\n"))&&t.writeAttributeString("xml:space","preserve"),t.writeString(e),t.writeFullEndElement()}writeDrawingRels(t){let e=new y,i=new x(E.UTF8,e);i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=this.imageListOffset;t<this.imageList.length;t++){let e=this.imageList[t];i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",t-this.imageListOffset+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",n.format("../media/image{0:D5}.jpeg",e.ImageIndex+1)),i.writeEndElement(),n.isNullOrWhiteSpace(e.Hyperlink)||(i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("hId{0}",t-this.imageListOffset+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",e.Hyperlink),i.writeAttributeString("TargetMode","External"),i.writeEndElement())}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeDrawing(t){let e=new y,i=new x(E.UTF8,e);i.writeStartDocument(),i.writeStartElement("xdr:wsDr"),i.writeAttributeString("xmlns:xdr","http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main");for(let t=this.imageListOffset;t<this.imageList.length;t++){let e=this.imageList[t];i.writeStartElement("xdr:twoCellAnchor"),i.writeAttributeString("editAs","oneCell"),i.writeStartElement("xdr:from"),i.writeElementString("xdr:col",n.format("{0}",e.FirstColumnIndex)),i.writeElementString("xdr:colOff",n.format("{0}",e.FirstColumnOffset)),i.writeElementString("xdr:row",n.format("{0}",e.FirstRowIndex)),i.writeElementString("xdr:rowOff",n.format("{0}",e.FirstRowOffset)),i.writeEndElement(),i.writeStartElement("xdr:to"),i.writeElementString("xdr:col",n.format("{0}",e.LastColumnIndex)),i.writeElementString("xdr:colOff",n.format("{0}",e.LastColumnOffset)),i.writeElementString("xdr:row",n.format("{0}",e.LastRowIndex)),i.writeElementString("xdr:rowOff",n.format("{0}",e.LastRowOffset)),i.writeEndElement(),i.writeStartElement("xdr:pic"),i.writeStartElement("xdr:nvPicPr"),i.writeStartElement("xdr:cNvPr"),i.writeAttributeString("id",n.format("{0}",t-this.imageListOffset+2)),i.writeAttributeString("name",n.format("Picture {0}",t-this.imageListOffset+1)),i.writeAttributeString("descr",n.format("image{0:D5}",t+1)),n.isNullOrWhiteSpace(e.Hyperlink)||(i.writeStartElement("a:hlinkClick"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("r:id",n.format("hId{0}",t-this.imageListOffset+1)),i.writeEndElement()),i.writeEndElement(),i.writeStartElement("xdr:cNvPicPr"),i.writeStartElement("a:picLocks"),i.writeAttributeString("noChangeAspect","1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("xdr:blipFill"),i.writeStartElement("a:blip"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("r:embed",n.format("rId{0}",t-this.imageListOffset+1)),i.writeEndElement(),i.writeStartElement("a:stretch"),i.writeStartElement("a:fillRect"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("xdr:spPr"),i.writeStartElement("a:xfrm"),i.writeStartElement("a:off"),i.writeAttributeString("x","1"),i.writeAttributeString("y","1"),i.writeEndElement(),i.writeStartElement("a:ext"),i.writeAttributeString("cx","2"),i.writeAttributeString("cy","2"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("a:prstGeom"),i.writeAttributeString("prst","rect"),i.writeStartElement("a:avLst"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("xdr:clientData"),i.writeEndElement(),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeStyles(){let t=new y,e=new x(E.UTF8,t);if(e.writeStartDocument(),e.writeStartElement("styleSheet"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),this.formatList.length>0){e.writeStartElement("numFmts"),e.writeAttributeString("count",n.format("{0}",this.formatList.length));for(let t=0;t<this.formatList.length;t++)e.writeStartElement("numFmt"),e.writeAttributeString("numFmtId",n.format("{0}",164+t)),e.writeAttributeString("formatCode",this.formatList[t]),e.writeEndElement();e.writeEndElement()}e.writeStartElement("fonts"),e.writeAttributeString("count",n.format("{0}",this.fontList.length));for(let t=0;t<this.fontList.length;t++){let i=this.fontList[t];e.writeStartElement("font"),i.Bold&&e.writeElementString("b",""),i.Italic&&e.writeElementString("i",""),i.Underlined&&e.writeElementString("u",""),i.Strikeout&&e.writeElementString("strike",""),e.writeStartElement("sz"),e.writeAttributeString("val",n.format("{0}",i.Height)),e.writeEndElement(),e.writeStartElement("color"),e.writeAttributeString("rgb",n.format("{0:X8}",i.Color.toArgb())),e.writeEndElement(),e.writeStartElement("name"),e.writeAttributeString("val",i.Name),e.writeEndElement(),e.writeStartElement("charset"),e.writeAttributeString("val",n.format("{0}",i.Charset)),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("fills"),e.writeAttributeString("count",n.format("{0}",this.fillList.length));for(let t=0;t<this.fillList.length;t++){let i=this.fillList[t];e.writeStartElement("fill"),e.writeStartElement("patternFill"),e.writeAttributeString("patternType",i.Type),"solid"==i.Type&&(e.writeStartElement("fgColor"),e.writeAttributeString("rgb",n.format("{0:X8}",i.FgColor.toArgb())),e.writeEndElement(),e.writeStartElement("bgColor"),e.writeAttributeString("indexed",n.format("{0}",64)),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("borders"),e.writeAttributeString("count",n.format("{0}",this.borderList.length));for(let t=0;t<this.borderList.length;t++){let i=this.borderList[t];e.writeStartElement("border"),this.writeBorderData(e,"left",i.BorderLeft),this.writeBorderData(e,"right",i.BorderRight),this.writeBorderData(e,"top",i.BorderTop),this.writeBorderData(e,"bottom",i.BorderBottom),this.writeBorderData(e,"diagonal",null),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("cellStyleXfs"),e.writeAttributeString("count",n.format("{0}",1)),e.writeStartElement("xf"),e.writeAttributeString("numFmtId",n.format("{0}",0)),e.writeAttributeString("fontId",n.format("{0}",0)),e.writeAttributeString("fillId",n.format("{0}",0)),e.writeAttributeString("borderId",n.format("{0}",0)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cellXfs"),e.writeAttributeString("count",n.format("{0}",this.xfList.length));for(let t=0;t<this.xfList.length;t++){let i=this.xfList[t],r=this.fillList[i.FillIndex],s=i.FillIndex;0==r.FgColor.a&&(s=0),e.writeStartElement("xf"),e.writeAttributeString("numFmtId",n.format("{0}",i.FormatIndex)),e.writeAttributeString("fontId",n.format("{0}",i.FontIndex)),e.writeAttributeString("fillId",n.format("{0}",s)),e.writeAttributeString("borderId",n.format("{0}",i.BorderIndex)),e.writeAttributeString("xfId",n.format("{0}",i.XFId)),0!=i.FormatIndex&&e.writeAttributeString("applyNumberFormat","1"),0!=i.FontIndex&&e.writeAttributeString("applyFont","1"),0!=i.FillIndex&&e.writeAttributeString("applyFill","1"),0!=i.BorderIndex&&e.writeAttributeString("applyBorder","1"),e.writeAttributeString("applyAlignment","1"),i.Editable&&e.writeAttributeString("applyProtection","1"),e.writeStartElement("alignment");let o="left";switch(i.HorAlign){case h.Right:o="right";break;case h.Center:o="center";break;case h.Width:o="justify";break}if(e.writeAttributeString("horizontal",o),i.VertAlign!=w.Bottom){let t="";switch(i.VertAlign){case w.Top:t="top";break;case w.Center:t="center";break}e.writeAttributeString("vertical",t)}0!=i.TextRotationAngle&&e.writeAttributeString("textRotation",i.TextRotationAngle.toString()),i.TextWrapped&&e.writeAttributeString("wrapText","1"),i.RightToLeft&&e.writeAttributeString("readingOrder","2"),e.writeEndElement(),i.Editable&&(e.writeStartElement("protection"),e.writeAttributeString("locked","0"),e.writeEndElement()),e.writeEndElement()}return e.writeEndElement(),e.writeStartElement("cellStyles"),e.writeAttributeString("count",n.format("{0}",1)),e.writeStartElement("cellStyle"),e.writeAttributeString("name","Normal"),e.writeAttributeString("xfId",n.format("{0}",0)),e.writeAttributeString("builtinId",n.format("{0}",0)),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("dxfs"),e.writeAttributeString("count",n.format("{0}",0)),e.writeEndElement(),e.writeStartElement("tableStyles"),e.writeAttributeString("count",n.format("{0}",0)),e.writeAttributeString("defaultTableStyle","TableStyleMedium9"),e.writeAttributeString("defaultPivotStyle","PivotStyleLight16"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeBorderData(t,e,i){if(t.writeStartElement(e),null!=i){let e=this.getLineStyle(i),r=i.color;""!=e&&(t.writeAttributeString("style",e),t.writeStartElement("color"),t.writeAttributeString("rgb",n.format("{0:X8}",r.toArgb())),t.writeEndElement())}t.writeEndElement()}writeSST(){let t=new y,e=new x(E.UTF8,t);e.writeStartDocument(),e.writeStartElement("sst"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main"),e.writeAttributeString("count",n.format("{0}",this.sstCount)),e.writeAttributeString("uniqueCount",n.format("{0}",this.sstList.length));for(let t=0;t<this.sstList.length;t++){e.writeStartElement("si");let i=this.sstList[t],r=new u;for(let t=0;t<i.length;t++)(i.charCodeAt(t)>=32||"\n"==i.charAt(t))&&r.append(i.charAt(t));i=r.toString(),this.sstHashIsTags.containsKey(t)?e.writeRaw(i):this.convertTextToExcelString(e,i),e.writeEndElement()}return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeAdditionalData(e,i){let r=new y,n=null;return n=i?t.System.Convert.fromBase64String(e):E.ASCII.getBytes(e),r.write(n,0,n.length),r}writeImage(t){let e=new y,i=this.imageList[t],r=this.imageCache.imagePackedStore[t];return null!=r&&e.write(r,0,r.length),e}exportExcel(r,s,o){e.StiLogService.write(this.stimulsoft.getType(),"Export report to Excel 2007 format");let l=o.pageRange;this.useOnePageHeaderAndFooter=o.useOnePageHeaderAndFooter,this.exportDataOnly=o.exportDataOnly,this.exportObjectFormatting=o.exportObjectFormatting,this.exportEachPageToSheet=o.exportEachPageToSheet,this.exportHorizontalPageBreaks=o.exportPageBreaks,this.imageResolution=o.imageResolution,this.imageQuality=o.imageQuality,this.docCompanyString=o.companyString,this.docLastModifiedString=o.lastModifiedString,this.restrictEditing=o.restrictEditing,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.exportDataOnly?this.useOnePageHeaderAndFooter=!1:this.exportObjectFormatting=!0,t["StiOptions"].Export.Excel.RestrictEditing>this.restrictEditing&&(this.restrictEditing=t["StiOptions"].Export.Excel.RestrictEditing),this.report=r;try{this.reportCulture=L.currentCulture;let e=l.getSelectedPages(r.renderedPages);this.currentPassNumber=0,this.maximumPassNumber=3,this.prepareData();let o=0;while(o<e.length){let i=new c(r,r.renderedPages);i.cacheMode=r.renderedPages.cacheMode,i.addV2Internal(e.getPageWithoutCache(o));let s=o;if(!this.exportEachPageToSheet){let t=e.getPageWithoutCache(o).excelSheetValue;while(o<e.length-1&&this.compareExcellSheetNames(e.getPageWithoutCache(o+1).excelSheetValue,t))o++,i.addV2Internal(e.getPageWithoutCache(o))}let a=i.getByIndex(0).excelSheetValue;null!=a&&""!=a||(a=n.format("Page {0}",this.sheetNameList.length+1));let l="",m=1;this.prepareMatrix(i);let g=0;do{this.firstPageIndexList.push(s),this.matrixList.push(this.matrix);let e=this.matrix.coordY.countItems-1;e-g>t["StiOptions"].Export.Excel.MaximumSheetHeight?e=g+t["StiOptions"].Export.Excel.MaximumSheetHeight:this.matrix=null,this.minRowList.push(g),this.maxRowList.push(e),g=e,null!=this.matrix||l.length>0?(l=n.format(" part{0}",m++),a.length>24&&(a=a.substr(0,24))):a.length>30&&(a=a.substr(0,30)),this.sheetNameList.push(a+l)}while(null!=this.matrix);o++}let m=new a;for(let t=0;t<this.sheetNameList.length;t++){let e=this.sheetNameList[t];if(e=e.stimulsoft.replaceAll("*","_").stimulsoft.replaceAll("\\","_").stimulsoft.replaceAll("/","_").stimulsoft.replaceAll("[","_").stimulsoft.replaceAll("]","_").stimulsoft.replaceAll(":","_").stimulsoft.replaceAll("?","_"),m.contains(e)){let t=1;while(m.contains(e+"-"+t.toString()))t++;e=e+"-"+t.toString()}m.add(e,e),this.sheetNameList[t]=e}let g=new P;g.begin(s,!0),this.currentPassNumber=2,this.imageListOffset=0;for(let t=0;t<this.matrixList.length;t++)this.hyperlinkList=[],g.addFile(n.format("xl/worksheets/sheet{0}.xml",t+1),this.writeSheet(t,e.getByIndex(this.firstPageIndexList[t]))),g.addFile(n.format("xl/worksheets/_rels/sheet{0}.xml.rels",t+1),this.writeSheetRels(t)),this.imageList.length-this.imageListOffset>0&&(g.addFile(n.format("xl/drawings/_rels/drawing{0}.xml.rels",t+1),this.writeDrawingRels(t)),g.addFile(n.format("xl/drawings/drawing{0}.xml",t+1),this.writeDrawing(t))),this.imageListOffset=this.imageList.length;if(g.addFile("[Content_Types].xml",this.writeContentTypes()),g.addFile("_rels/.rels",this.writeMainRels()),g.addFile("docProps/app.xml",this.writeDocPropsApp()),g.addFile("docProps/core.xml",this.writeDocPropsCore()),g.addFile("xl/_rels/workbook.xml.rels",this.writeWorkbookRels()),g.addFile("xl/workbook.xml",this.writeWorkbook()),g.addFile("xl/styles.xml",this.writeStyles()),this.sstList.length>0&&g.addFile("xl/sharedStrings.xml",this.writeSST()),this.imageCache.imagePackedStore.length>0)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)g.addFile(n.format("xl/media/image{0:D5}.jpeg",t+1),this.writeImage(t));t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(g.addFile("xl/media/imageAdditional.png",this.writeAdditionalData(i.StiExportUtils.additionalData,!0)),g.addFile("xl/drawings/_rels/vmlDrawingAdditional.vml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="dId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="../media/imageAdditional.png"/></Relationships>',!1)),g.addFile("xl/drawings/vmlDrawingAdditional.vml",this.writeAdditionalData('<xml xmlns:v="urn:schemas-microsoft-com:vml"\r\n xmlns:o="urn:schemas-microsoft-com:office:office"\r\n xmlns:x="urn:schemas-microsoft-com:office:excel">\r\n <o:shapelayout v:ext="edit">\r\n  <o:idmap v:ext="edit" data="1"/>\r\n'+' </o:shapelayout><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75"\r\n  o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">\r\n  <v:stroke joinstyle="miter"/>\r\n  <v:formulas>'+'\r\n   <v:f eqn="if lineDrawn pixelLineWidth 0"/>\r\n   <v:f eqn="sum @0 1 0"/>\r\n   <v:f eqn="sum 0 0 @1"/>\r\n   <v:f eqn="prod @2 1 2"/>\r\n   <v:f eqn="prod @3 21600 pixelWidth"/>\r\n   <v:f eqn="prod @3 21600 pixelHeight"/>\r\n   <v:f eqn="sum @0 0 1"/>'+'\r\n   <v:f eqn="prod @6 1 2"/>\r\n   <v:f eqn="prod @7 21600 pixelWidth"/>\r\n   <v:f eqn="sum @8 21600 0"/>\r\n   <v:f eqn="prod @7 21600 pixelHeight"/>\r\n   <v:f eqn="sum @10 21600 0"/>\r\n  </v:formulas>\r\n  <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'\r\n  <o:lock v:ext="edit" aspectratio="t"/>\r\n </v:shapetype><v:shape id="CH" o:spid="_x0000_s1027" type="#_x0000_t75"\r\n  style=\'position:absolute;margin-left:0;margin-top:0;width:365pt;height:298pt;\r\n  z-index:1\'>'+'\r\n  <v:imagedata o:relid="dId1" o:title="additional"/>\r\n  <o:lock v:ext="edit" rotation="t"/>\r\n </v:shape></xml>',!1))),g.end()}catch(e){t.System.StiError.showError(e,!1)}finally{null!=this.matrix&&(this.matrix.clear(),this.matrix=null),this.fontList=null,this.fillList=null,this.borderList=null,this.xfList=null,this.sstList=null,this.sstHash=null,this.sstHashIsTags=null,this.formatList=null,this.sheetNameList=null,this.imageList.stimulsoft.clear(),this.imageList=null,this.imageCache.clear(),this.printAreasList=null,this.matrixList=null,this.firstPageIndexList=null,this.hyperlinkList=null,this.minRowList=null,this.maxRowList=null}}}B.regexCheckInteger1=new RegExp("^[+-]?d+$"),B.regexCheckFloat1=new RegExp("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$"),i.StiExcel2007ExportService=B;class I{constructor(t,e,i,r,n,s,o,a,l){this.Name=t,this.Bold=e,this.Italic=i,this.Underlined=r,this.Strikeout=n,this.Height=s,this.Color=o,this.Charset=a,this.Family=l}equals(t){return this.Name==t.Name&&this.Bold==t.Bold&&this.Italic==t.Italic&&this.Underlined==t.Underlined&&this.Strikeout==t.Strikeout&&this.Height==t.Height&&this.Color.stimulsoft.equals(t.Color)&&this.Charset==t.Charset&&this.Family==t.Family}}i.DataFont=I;class k{constructor(t,e,i){this.Type=t,this.FgColor=e,this.BgColor=i}equals(t){return this.Type==t.Type&&this.FgColor.stimulsoft.equals(t.FgColor)&&this.BgColor.stimulsoft.equals(t.BgColor)}}i.DataFill=k;class D{constructor(t,e,i,r){this.BorderLeft=t,this.BorderRight=e,this.BorderTop=i,this.BorderBottom=r}equals(t){return this.eq(this.BorderLeft,t.BorderLeft)&&this.eq(this.BorderRight,t.BorderRight)&&this.eq(this.BorderTop,t.BorderTop)&&this.eq(this.BorderBottom,t.BorderBottom)}eq(t,e){return null==t&&null==e||null!=t&&null!=e&&t.stimulsoft.equals(e)}}i.DataBorder=D;class N{constructor(t,e,i,r,n,s,o,a,l,m,c){this.FormatIndex=t,this.FontIndex=e,this.FillIndex=i,this.BorderIndex=r,this.XFId=n,this.HorAlign=s,this.VertAlign=o,this.TextRotationAngle=a,this.TextWrapped=l,this.RightToLeft=m,this.Editable=c}equalDataXF(t){if(this.FormatIndex!=t.FormatIndex||this.FontIndex!=t.FontIndex||this.FillIndex!=t.FillIndex||this.BorderIndex!=t.BorderIndex||this.XFId!=t.XFId||this.HorAlign!=t.HorAlign||this.VertAlign!=t.VertAlign||this.TextRotationAngle!=t.TextRotationAngle||this.TextWrapped!=t.TextWrapped||this.RightToLeft!=t.RightToLeft||this.Editable!=t.Editable)return!1;return!0}}i.DataXF=N;class H{constructor(t,e,i,r,n,s,o,a,l,m){this.FirstRowIndex=t,this.FirstRowOffset=e,this.FirstColumnIndex=i,this.FirstColumnOffset=r,this.LastRowIndex=n,this.LastRowOffset=s,this.LastColumnIndex=o,this.LastColumnOffset=a,this.ImageIndex=l,this.Hyperlink=m}}i.ExcelImageData=H;class O{constructor(t,e,i,r){this.FirstRow=t,this.LastRow=e,this.FirstColumn=i,this.LastColumn=r}}i.CellRangeAddress=O;class M{constructor(t,e,i){this.Range=t,this.Description=e,this.Bookmark=i}}i.HlinkData=M}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(t){var e;!function(t){class e extends t.StiExportService{implements(){return[t.IStiExcelXmlExportService]}}t.StiExcelXmlExportService=e}(e=t.Export||(t.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.Base.Drawing.StiPenStyle,n=t.Base.Zip.StiZipWriter20,s=t.Report.Components.StiImage,o=t.Base.Drawing.StiHorAlignment,a=t.Base.Drawing.StiCapStyle,l=t.Report.Components.StiVerticalLinePrimitive,m=t.Report.Components.StiHorizontalLinePrimitive,c=t.Base.Drawing.StiAdvancedBorder,g=t.Base.Drawing.StiBorderSides,h=t.Report.Components.IStiBorder,p=t.Report.Components.StiShape,w=t.Report.Components.IStiBrush,S=t.Report.Components.IStiTextOptions,d=t.Report.Components.StiLinePrimitive,u=t.Report.Components.IStiExportImageExtended,f=t.Base.Drawing.StiTextRenderer,E=t.Report.Components.StiTextQuality,v=t.Base.Drawing.StiBrush,b=t.Report.Components.StiContainer,y=t.Report.Components.StiText,x=t.System.DateTime,A=t.System.StiString,T=t.System.Text.StringBuilder,P=t.System.Globalization.CultureInfo,L=t.System.Xml.Formatting,C=t.System.Text.Encoding,F=t.System.Xml.XmlTextWriter,R=t.Report.Dashboard.StiDashboardExport,B=t.Report.Dashboard.IStiDashboard,I=t.System.IO.MemoryStream;class k extends i.StiExportService{constructor(){super(...arguments),this.imageListOffset=0,this.imageResolution=1,this.imageQuality=.75,this.imageCache=null,this.idCounter=2,this.hyperlinkList=null,this.xmlIndentation=1,this.currentCulture=null,this.newCulture=null,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}",this.HiToTwips=14.4*.995}implements(){return[i.IStiPpt2007ExportService]}getDefaultExtension(){return"pptx"}exportTo(t,e,i){this.exportPowerPoint(t,e,i)}exportToAsync(e,i,r,n){t.Report.Export.StiExportImageHelper.convertAllImages(i,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?t.System.Drawing.Imaging.ImageFormat.Png:t.System.Drawing.Imaging.ImageFormat.Jpeg).try(()=>{if(!i.isDocument&&i.getCurrentPage().stimulsoft.is(B))return void R.exportAsync(i,r,n).try(()=>e());this.exportTo(i,r,n),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null),e()})}getLineStyle(t){switch(t){case r.Solid:return"solid";case r.Dot:return"sysDot";case r.Dash:return"sysDash";case r.DashDot:return"sysDashDot";case r.DashDotDot:return"sysDashDotDot";case r.Double:return"solid";default:return"solid"}}stringToUrl(t){let e=C.UTF8.getBytes(t),i=new T;for(let t of e){let e=String.fromCharCode(t);t<32||t>127||-1!=this.wrongUrlSymbols.indexOf(e)?i.append(A.format("%{0:x2}",t)):i.append(e)}return i.toString()}convert(t){return 0|Math.round(t*this.HiToTwips)}convertTwipsToEmu(t){return 0|Math.round(t/this.HiToTwips/100*914400)}convertToEmu(t){return 0|Math.round(t/100*914400)}writeColor(t,e){if(t.writeStartElement("a:srgbClr"),t.writeAttributeString("val",A.format("{0:X6}",16777215&e.toArgb())),255!=e.a){let i=e.a/256*1e5|0;t.writeStartElement("a:alpha"),t.writeAttributeString("val",A.format("{0}",i)),t.writeEndElement()}t.writeEndElement()}writeContentTypes(t){let e=new I,i=new F(C.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?L.None:L.Indented,i.writeStartDocument(),i.writeStartElement("Types"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types");for(let t=0;t<11;t++)i.writeStartElement("Override"),i.writeAttributeString("PartName",A.format("/ppt/slideLayouts/slideLayout{0}.xml",t+1)),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml"),i.writeEndElement();i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/slideMasters/slideMaster1.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/presProps.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presProps+xml"),i.writeEndElement();for(let e=0;e<t;e++)i.writeStartElement("Override"),i.writeAttributeString("PartName",A.format("/ppt/slides/slide{0}.xml",e+1)),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.slide+xml"),i.writeEndElement();return i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/theme/theme1.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.theme+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","jpeg"),i.writeAttributeString("ContentType","image/jpeg"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","png"),i.writeAttributeString("ContentType","image/png"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","rels"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","xml"),i.writeAttributeString("ContentType","application/xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/presentation.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/app.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/tableStyles.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/ppt/viewProps.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/core.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeMainRels(){let t=new I,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","ppt/presentation.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(t){let e=new I,i=new F(C.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?L.None:L.Indented,i.writeStartDocument(),i.writeStartElement("Properties"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),i.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),i.writeElementString("Application","Microsoft Office PowerPoint"),i.writeElementString("Slides",A.format("{0}",t)),i.writeElementString("PresentationFormat","On-screen Show (4:3)"),i.writeElementString("TotalTime","0"),i.writeElementString("Words","0"),i.writeElementString("Paragraphs","0"),i.writeElementString("Notes","0"),i.writeElementString("HiddenSlides","0"),i.writeElementString("MMClips","0"),i.writeElementString("ScaleCrop","false"),i.writeStartElement("HeadingPairs"),i.writeStartElement("vt:vector"),i.writeAttributeString("size","4"),i.writeAttributeString("baseType","variant"),i.writeStartElement("vt:variant"),i.writeElementString("vt:lpstr","Theme"),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:i4",A.format("{0}",t)),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:lpstr","Slide Titles"),i.writeEndElement(),i.writeStartElement("vt:variant"),i.writeElementString("vt:i4",A.format("{0}",t)),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("TitlesOfParts"),i.writeStartElement("vt:vector"),i.writeAttributeString("size",A.format("{0}",1+t)),i.writeAttributeString("baseType","lpstr"),i.writeElementString("vt:lpstr","Office Theme");for(let e=0;e<t;e++)i.writeElementString("vt:lpstr",A.format("Slide {0}",e+1));return i.writeEndElement(),i.writeEndElement(),i.writeElementString("Company","Stimulsoft"),i.writeElementString("LinksUpToDate","false"),i.writeElementString("SharedDoc","false"),i.writeElementString("HyperlinksChanged","false"),i.writeElementString("AppVersion","12.0000"),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeDocPropsCore(){let t=new I,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("cp:coreProperties"),e.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),e.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),e.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");let i=A.format("{0}",x.now.toString("yyyy-MM-ddTHH:mm:ssZ"));return e.writeElementString("dc:title",""),e.writeElementString("dc:subject",""),e.writeElementString("dc:creator","Stimulsoft Reports"),e.writeElementString("cp:keywords",""),e.writeElementString("dc:description",""),e.writeElementString("cp:lastModifiedBy","Stimulsoft Reports"),e.writeElementString("cp:revision","1"),e.writeStartElement("dcterms:created"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeStartElement("dcterms:modified"),e.writeAttributeString("xsi:type","dcterms:W3CDTF"),e.writeString(i),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeTableStyles(){let t=new I,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("a:tblStyleLst"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("def","{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}"),e.writeEndElement(),e.writeEndDocument(),e.flush(),t}writePresProps(){let t=new I,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("p:presentationPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeViewProps(){let t=new I,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("p:viewPr"),e.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),e.writeStartElement("p:normalViewPr"),e.writeAttributeString("showOutlineIcons","0"),e.writeStartElement("p:restoredLeft"),e.writeAttributeString("sz","15591"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeStartElement("p:restoredTop"),e.writeAttributeString("sz","94675"),e.writeAttributeString("autoAdjust","0"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:slideViewPr"),e.writeStartElement("p:cSldViewPr"),e.writeStartElement("p:cViewPr"),e.writeAttributeString("varScale","1"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","107"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","-1098"),e.writeAttributeString("y","-84"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:guideLst"),e.writeStartElement("p:guide"),e.writeAttributeString("orient","horz"),e.writeAttributeString("pos","2160"),e.writeEndElement(),e.writeStartElement("p:guide"),e.writeAttributeString("pos","2880"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:notesTextViewPr"),e.writeStartElement("p:cViewPr"),e.writeStartElement("p:scale"),e.writeStartElement("a:sx"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeStartElement("a:sy"),e.writeAttributeString("n","100"),e.writeAttributeString("d","100"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:origin"),e.writeAttributeString("x","0"),e.writeAttributeString("y","0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("p:gridSpacing"),e.writeAttributeString("cx","73736200"),e.writeAttributeString("cy","73736200"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeTheme(){let t=new I,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument();let i='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="1F497D" /></a:dk2><a:lt2><a:srgbClr val="EEECE1" /></a:lt2><a:accent1><a:srgbClr val="4F81BD" /></a:accent1><a:accent2><a:srgbClr val="C0504D" /></a:accent2><a:accent3><a:srgbClr val="9BBB59" /></a:accent3><a:accent4>'+'<a:srgbClr val="8064A2" /></a:accent4><a:accent5><a:srgbClr val="4BACC6" /></a:accent5><a:accent6><a:srgbClr val="F79646" /></a:accent6><a:hlink><a:srgbClr val="0000FF" /></a:hlink><a:folHlink><a:srgbClr val="800080" /></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" />'+'<a:font script="Arab" typeface="Times New Roman" /><a:font script="Hebr" typeface="Times New Roman" /><a:font script="Thai" typeface="Angsana New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" /><a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="MoolBoran" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" />'+'<a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" /><a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Times New Roman" />'+'<a:font script="Uigh" typeface="Microsoft Uighur" /></a:majorFont><a:minorFont><a:latin typeface="Calibri" /><a:ea typeface="" /><a:cs typeface="" /><a:font script="Jpan" typeface="ＭＳ Ｐゴシック" /><a:font script="Hang" typeface="맑은 고딕" /><a:font script="Hans" typeface="宋体" /><a:font script="Hant" typeface="新細明體" /><a:font script="Arab" typeface="Arial" /><a:font script="Hebr" typeface="Arial" /><a:font script="Thai" typeface="Cordia New" /><a:font script="Ethi" typeface="Nyala" /><a:font script="Beng" typeface="Vrinda" />'+'<a:font script="Gujr" typeface="Shruti" /><a:font script="Khmr" typeface="DaunPenh" /><a:font script="Knda" typeface="Tunga" /><a:font script="Guru" typeface="Raavi" /><a:font script="Cans" typeface="Euphemia" /><a:font script="Cher" typeface="Plantagenet Cherokee" /><a:font script="Yiii" typeface="Microsoft Yi Baiti" /><a:font script="Tibt" typeface="Microsoft Himalaya" /><a:font script="Thaa" typeface="MV Boli" /><a:font script="Deva" typeface="Mangal" /><a:font script="Telu" typeface="Gautami" /><a:font script="Taml" typeface="Latha" />'+'<a:font script="Syrc" typeface="Estrangelo Edessa" /><a:font script="Orya" typeface="Kalinga" /><a:font script="Mlym" typeface="Kartika" /><a:font script="Laoo" typeface="DokChampa" /><a:font script="Sinh" typeface="Iskoola Pota" /><a:font script="Mong" typeface="Mongolian Baiti" /><a:font script="Viet" typeface="Arial" /><a:font script="Uigh" typeface="Microsoft Uighur" /></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0">'+'<a:schemeClr val="phClr"><a:tint val="50000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000" /><a:satMod val="300000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000" /><a:satMod val="350000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr">'+'<a:shade val="93000" /><a:satMod val="130000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000" /><a:satMod val="135000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000" /><a:satMod val="105000" /></a:schemeClr></a:solidFill><a:prstDash val="solid" /></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill>'+'<a:prstDash val="solid" /></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst>'+'</a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000" /></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0" /></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000" /></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400" /></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1">'+'<a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000" /><a:shade val="99000" /><a:satMod val="350000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000" /><a:satMod val="255000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000" /></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000" /><a:satMod val="300000" /></a:schemeClr>'+'</a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000" /><a:satMod val="200000" /></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000" /></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults /><a:extraClrSchemeLst /></a:theme>';return e.writeRaw(i),e.writeEndDocument(),e.flush(),t}writeSlideMasterRels(){let t=new I,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<11;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",A.format("rId{0}",t+1)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),e.writeAttributeString("Target",A.format("../slideLayouts/slideLayout{0}.xml",t+1)),e.writeEndElement();return e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId12"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),e.writeAttributeString("Target","../theme/theme1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSlideMaster(){let t=new I,e=new F(C.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument();let i='<p:sldMaster xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:p="http://schemas.openxmlformats.org/presentationml/2006/main"><p:cSld><p:bg><p:bgRef idx="1001"><a:schemeClr val="bg1" /></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" />'+'<a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title Placeholder 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="8229600" cy="1143000" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr">'+'<a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="8229600" cy="4525963" /></a:xfrm><a:prstGeom prst="rect">'+'<a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0"><a:normAutofit /></a:bodyPr><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm>'+'<a:off x="457200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p>'+'<a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3124200" y="6356350" /><a:ext cx="2895600" cy="365125" /></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="ctr"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6553200" y="6356350" /><a:ext cx="2133600" cy="365125" /></a:xfrm><a:prstGeom prst="rect"><a:avLst /></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert="horz" lIns="91440" tIns="45720" rIns="91440" bIns="45720" rtlCol="0" anchor="ctr" /><a:lstStyle><a:lvl1pPr algn="r"><a:defRPr sz="1200"><a:solidFill><a:schemeClr val="tx1">'+'<a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1="lt1" tx1="dk1" bg2="lt2" tx2="dk2" accent1="accent1" accent2="accent2" accent3="accent3" accent4="accent4" accent5="accent5" accent6="accent6" hlink="hlink" folHlink="folHlink" />'+'<p:sldLayoutIdLst><p:sldLayoutId id="2147483649" r:id="rId1" /><p:sldLayoutId id="2147483650" r:id="rId2" /><p:sldLayoutId id="2147483651" r:id="rId3" /><p:sldLayoutId id="2147483652" r:id="rId4" /><p:sldLayoutId id="2147483653" r:id="rId5" /><p:sldLayoutId id="2147483654" r:id="rId6" /><p:sldLayoutId id="2147483655" r:id="rId7" /><p:sldLayoutId id="2147483656" r:id="rId8" /><p:sldLayoutId id="2147483657" r:id="rId9" /><p:sldLayoutId id="2147483658" r:id="rId10" />'+'<p:sldLayoutId id="2147483659" r:id="rId11" /></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn="ctr" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="0" /></a:spcBef><a:buNone /><a:defRPr sz="4400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mj-lt" /><a:ea typeface="+mj-ea" /><a:cs typeface="+mj-cs" /></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle>'+'<a:lvl1pPr marL="342900" indent="-342900" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="3200" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr>'+'<a:lvl2pPr marL="742950" indent="-285750" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr>'+'<a:lvl3pPr marL="1143000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2400" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1600200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="–" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr>'+'<a:lvl5pPr marL="2057400" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="»" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2514600" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2971800" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr>'+'<a:lvl8pPr marL="3429000" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr>'+'<a:lvl9pPr marL="3886200" indent="-228600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:spcBef><a:spcPct val="20000" /></a:spcBef><a:buFont typeface="Arial" pitchFamily="34" charset="0" /><a:buChar char="•" /><a:defRPr sz="2000" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr>'+'</p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang="ru-RU" /></a:defPPr><a:lvl1pPr marL="0" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1">'+'<a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill>'+'<a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" algn="l" defTabSz="914400" rtl="0" eaLnBrk="1" latinLnBrk="0" hangingPunct="1"><a:defRPr sz="1800" kern="1200"><a:solidFill><a:schemeClr val="tx1" /></a:solidFill><a:latin typeface="+mn-lt" /><a:ea typeface="+mn-ea" /><a:cs typeface="+mn-cs" /></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>';return e.writeRaw(i),e.writeEndDocument(),e.flush(),t}writeSlideLayoutRels(){let t=new I,e=new F(C.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?L.None:L.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),e.writeAttributeString("Target","../slideMasters/slideMaster1.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeSlideLayout(e,i){let r=new I,n=new F(C.UTF8,r);if(n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?L.None:L.Indented,n.writeStartDocument(),n.writeStartElement("p:sldLayout"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),1==e){n.writeAttributeString("type","title"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Title Slide"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ctrTitle" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="685800" y="2130425" /><a:ext cx="7772400" cy="1470025" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Subtitle 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="subTitle" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1371600" y="3886200" /><a:ext cx="6400800" cy="1752600" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" />'+'</a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0" algn="ctr"><a:buNone /><a:defRPr><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(2==e){n.writeAttributeString("type","obj"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Title and Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r>'+'<a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr>'+'<p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(3==e){n.writeAttributeString("type","secHead"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Section Header"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="4406900" /><a:ext cx="7772400" cy="1362075" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="t" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="4000" b="1" cap="all" /></a:lvl1pPr></a:lstStyle><a:p><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="722313" y="2906713" /><a:ext cx="7772400" cy="1500187" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2000"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone />'+'<a:defRPr sz="1800"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1600"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1400"><a:solidFill><a:schemeClr val="tx1"><a:tint val="75000" /></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>'+'<a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr>'+'<p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(4==e){n.writeAttributeString("type","twoObj"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Two Content"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph sz="half" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1600200" /><a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4648200" y="1600200" />'+'<a:ext cx="4038600" cy="4525963" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2800" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2400" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2000" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1800" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1800" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1800" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1800" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1800" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1800" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(5==e){n.writeAttributeString("type","twoTxTwoObj"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Comparison"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Text Placeholder 2" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1535113" /><a:ext cx="4040188" cy="639762" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr>'+'<a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Content Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="2174875" />'+'<a:ext cx="4040188" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Text Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="quarter" idx="3" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="1535113" /><a:ext cx="4041775" cy="639762" /></a:xfrm></p:spPr>'+'<p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="2400" b="1" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2000" b="1" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1800" b="1" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0">'+'<a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="1600" b="1" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Content Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph sz="quarter" idx="4" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="4645025" y="2174875" /><a:ext cx="4041775" cy="3951288" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="2400" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2000" /></a:lvl2pPr>'+'<a:lvl3pPr><a:defRPr sz="1800" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="1600" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="1600" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="1600" /></a:lvl6pPr><a:lvl7pPr><a:defRPr sz="1600" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="1600" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="1600" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r>'+'<a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Date Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="8" name="Footer Placeholder 7" />'+'<p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="9" name="Slide Number Placeholder 8" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(6==e){n.writeAttributeString("type","titleOnly"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Title Only"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Date Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Footer Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Slide Number Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(7==e){if(n.writeAttributeString("type","blank"),n.writeAttributeString("preserve","1"),n.writeStartElement("p:cSld"),n.writeAttributeString("name","Blank"),n.writeStartElement("p:spTree"),n.writeStartElement("p:nvGrpSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","1"),n.writeAttributeString("name",""),n.writeEndElement(),n.writeStartElement("p:cNvGrpSpPr"),n.writeEndElement(),n.writeStartElement("p:nvPr"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:grpSpPr"),n.writeStartElement("a:xfrm"),n.writeStartElement("a:off"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:ext"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeStartElement("a:chOff"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:chExt"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","2"),n.writeAttributeString("name","Date Placeholder 1"),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeStartElement("a:spLocks"),n.writeAttributeString("noGrp","1"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:nvPr"),n.writeStartElement("p:ph"),n.writeAttributeString("type","dt"),n.writeAttributeString("sz","half"),n.writeAttributeString("idx","10"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:spPr"),n.writeEndElement(),n.writeStartElement("p:txBody"),n.writeStartElement("a:bodyPr"),n.writeEndElement(),n.writeStartElement("a:lstStyle"),n.writeEndElement(),n.writeStartElement("a:p"),n.writeStartElement("a:fld"),n.writeAttributeString("id","{BBCD0B08-7874-4091-A11F-B0CCB138CA98}"),n.writeAttributeString("type","datetimeFigureOut"),n.writeStartElement("a:rPr"),n.writeAttributeString("lang","ru-RU"),n.writeAttributeString("smtClean","0"),n.writeEndElement(),n.writeStartElement("a:t"),n.writeString("15.04.2009"),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("a:endParaRPr"),n.writeAttributeString("lang","ru-RU"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","3"),n.writeAttributeString("name","Footer Placeholder 2"),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeStartElement("a:spLocks"),n.writeAttributeString("noGrp","1"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:nvPr"),n.writeStartElement("p:ph"),n.writeAttributeString("type","ftr"),n.writeAttributeString("sz","quarter"),n.writeAttributeString("idx","11"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:spPr"),n.writeEndElement(),n.writeStartElement("p:txBody"),n.writeStartElement("a:bodyPr"),n.writeEndElement(),n.writeStartElement("a:lstStyle"),n.writeEndElement(),n.writeStartElement("a:p"),n.writeStartElement("a:endParaRPr"),n.writeAttributeString("lang","ru-RU"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:sp"),n.writeStartElement("p:nvSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","4"),n.writeAttributeString("name","Slide Number Placeholder 3"),n.writeEndElement(),n.writeStartElement("p:cNvSpPr"),n.writeStartElement("a:spLocks"),n.writeAttributeString("noGrp","1"),n.writeEndElement(),n.writeFullEndElement(),n.writeStartElement("p:nvPr"),n.writeStartElement("p:ph"),n.writeAttributeString("type","sldNum"),n.writeAttributeString("sz","quarter"),n.writeAttributeString("idx","12"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("p:spPr"),n.writeEndElement(),n.writeStartElement("p:txBody"),n.writeStartElement("a:bodyPr"),n.writeEndElement(),n.writeStartElement("a:lstStyle"),n.writeEndElement(),n.writeStartElement("a:p"),n.writeStartElement("a:fld"),n.writeAttributeString("id","{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}"),n.writeAttributeString("type","slidenum"),n.writeStartElement("a:rPr"),n.writeAttributeString("lang","ru-RU"),n.writeAttributeString("smtClean","0"),n.writeEndElement(),n.writeStartElement("a:t"),n.writeString("‹#›"),n.writeFullEndElement(),n.writeFullEndElement(),n.writeStartElement("a:endParaRPr"),n.writeAttributeString("lang","ru-RU"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),!(t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion)){let t=i.unit.convertToHInches(i.pageWidth-i.margins.left-i.margins.right),e=i.unit.convertToHInches(i.pageHeight-i.margins.top-i.margins.bottom),r=i.unit.convertToHInches(i.margins.left),s=i.unit.convertToHInches(i.margins.top);n.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(r)+'" y="'+this.convertToEmu(s+.45*e)+'"/><a:ext cx="'+this.convertToEmu(t)+'" cy="'+this.convertToEmu(.1*e)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")}n.writeFullEndElement(),n.writeFullEndElement()}if(8==e){n.writeAttributeString("type","objTx"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Content with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="273050" /><a:ext cx="3008313" cy="1162050" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Content Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="3575050" y="273050" /><a:ext cx="5111750" cy="5853113" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr><a:defRPr sz="2400" /></a:lvl3pPr><a:lvl4pPr><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr>'+'<a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp>'+'<p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="1435100" /><a:ext cx="3008313" cy="4691063" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0">'+'<a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr />'+'<p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(9==e){n.writeAttributeString("type","picTx"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Picture with Caption"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="4800600" /><a:ext cx="5486400" cy="566738" /></a:xfrm></p:spPr><p:txBody><a:bodyPr anchor="b" /><a:lstStyle><a:lvl1pPr algn="l"><a:defRPr sz="2000" b="1" /></a:lvl1pPr></a:lstStyle><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Picture Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="pic" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="612775" /><a:ext cx="5486400" cy="4114800" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="3200" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="2800" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="2400" /></a:lvl3pPr>'+'<a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl6pPr><a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="2000" /></a:lvl9pPr></a:lstStyle><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Text Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr>'+'<p:nvPr><p:ph type="body" sz="half" idx="2" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="1792288" y="5367338" /><a:ext cx="5486400" cy="804862" /></a:xfrm></p:spPr><p:txBody><a:bodyPr /><a:lstStyle><a:lvl1pPr marL="0" indent="0"><a:buNone /><a:defRPr sz="1400" /></a:lvl1pPr><a:lvl2pPr marL="457200" indent="0"><a:buNone /><a:defRPr sz="1200" /></a:lvl2pPr><a:lvl3pPr marL="914400" indent="0"><a:buNone /><a:defRPr sz="1000" /></a:lvl3pPr><a:lvl4pPr marL="1371600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl4pPr><a:lvl5pPr marL="1828800" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl5pPr><a:lvl6pPr marL="2286000" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl6pPr>'+'<a:lvl7pPr marL="2743200" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl7pPr><a:lvl8pPr marL="3200400" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl8pPr><a:lvl9pPr marL="3657600" indent="0"><a:buNone /><a:defRPr sz="900" /></a:lvl9pPr></a:lstStyle><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Date Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut">'+'<a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Footer Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="7" name="Slide Number Placeholder 6" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(10==e){n.writeAttributeString("type","vertTx"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Title and Vertical Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'+'<p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" />'+'<a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" /><a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr>'+'<a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}if(11==e){n.writeAttributeString("type","vertTitleAndTx"),n.writeAttributeString("preserve","1");let t='<p:cSld name="Vertical Title and Text"><p:spTree><p:nvGrpSpPr><p:cNvPr id="1" name="" /><p:cNvGrpSpPr /><p:nvPr /></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x="0" y="0" /><a:ext cx="0" cy="0" /><a:chOff x="0" y="0" /><a:chExt cx="0" cy="0" /></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id="2" name="Vertical Title 1" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="title" orient="vert" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="6629400" y="274638" /><a:ext cx="2057400" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:r><a:rPr lang="en-US" smtClean="0" />'+'<a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="3" name="Vertical Text Placeholder 2" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="body" orient="vert" idx="1" /></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x="457200" y="274638" /><a:ext cx="6019800" cy="5851525" /></a:xfrm></p:spPr><p:txBody><a:bodyPr vert="eaVert" /><a:lstStyle /><a:p><a:pPr lvl="0" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl="1" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Second level</a:t></a:r></a:p><a:p>'+'<a:pPr lvl="2" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl="3" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl="4" /><a:r><a:rPr lang="en-US" smtClean="0" /><a:t>Fifth level</a:t></a:r><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="4" name="Date Placeholder 3" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="dt" sz="half" idx="10" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:fld id="{BBCD0B08-7874-4091-A11F-B0CCB138CA98}" type="datetimeFigureOut"><a:rPr lang="ru-RU" smtClean="0" />'+'<a:t>15.04.2009</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="5" name="Footer Placeholder 4" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="ftr" sz="quarter" idx="11" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle /><a:p><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id="6" name="Slide Number Placeholder 5" /><p:cNvSpPr><a:spLocks noGrp="1" /></p:cNvSpPr><p:nvPr><p:ph type="sldNum" sz="quarter" idx="12" /></p:nvPr></p:nvSpPr><p:spPr /><p:txBody><a:bodyPr /><a:lstStyle />'+'<a:p><a:fld id="{F548980B-80A5-4AC9-8F15-D7D0FD0AEED9}" type="slidenum"><a:rPr lang="ru-RU" smtClean="0" /><a:t>‹#›</a:t></a:fld><a:endParaRPr lang="ru-RU" /></a:p></p:txBody></p:sp></p:spTree></p:cSld>';n.writeRaw(t)}return n.writeStartElement("p:clrMapOvr"),n.writeStartElement("a:masterClrMapping"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),r}writePresentationRels(t){let e=new I,i=new F(C.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?L.None:L.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles"),i.writeAttributeString("Target","tableStyles.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId2"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps"),i.writeAttributeString("Target","viewProps.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId3"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps"),i.writeAttributeString("Target","presProps.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId4"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme"),i.writeAttributeString("Target","theme/theme1.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId5"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster"),i.writeAttributeString("Target","slideMasters/slideMaster1.xml"),i.writeEndElement();for(let e=0;e<t.count;e++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",A.format("rId{0}",6+e)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),i.writeAttributeString("Target",A.format("slides/slide{0}.xml",e+1)),i.writeEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writePresentation(t){let e=new I,i=new F(C.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?L.None:L.Indented,i.writeStartDocument(),i.writeStartElement("p:presentation"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),i.writeAttributeString("saveSubsetFonts","1"),i.writeStartElement("p:sldMasterIdLst"),i.writeStartElement("p:sldMasterId"),i.writeAttributeString("id","2147483648"),i.writeAttributeString("r:id","rId5"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("p:sldIdLst");for(let e=0;e<t.count;e++)i.writeStartElement("p:sldId"),i.writeAttributeString("id",A.format("{0}",256+e)),i.writeAttributeString("r:id",A.format("rId{0}",6+e)),i.writeEndElement();i.writeEndElement();let r=t.getByIndex(0);return i.writeStartElement("p:sldSz"),i.writeAttributeString("cx",this.convertToEmu(r.unit.convertToHInches(r.width+r.margins.left+r.margins.right)).toString()),i.writeAttributeString("cy",this.convertToEmu(r.unit.convertToHInches(r.height+r.margins.top+r.margins.bottom)).toString()),i.writeEndElement(),i.writeStartElement("p:notesSz"),i.writeAttributeString("cx","6858000"),i.writeAttributeString("cy","9144000"),i.writeEndElement(),i.writeStartElement("p:defaultTextStyle"),i.writeStartElement("a:defPPr"),i.writeStartElement("a:defRPr"),i.writeAttributeString("lang","ru-RU"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl1pPr"),i.writeAttributeString("marL","0"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl2pPr"),i.writeAttributeString("marL","457200"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl3pPr"),i.writeAttributeString("marL","914400"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl4pPr"),i.writeAttributeString("marL","1371600"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl5pPr"),i.writeAttributeString("marL","1828800"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl6pPr"),i.writeAttributeString("marL","2286000"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl7pPr"),i.writeAttributeString("marL","2743200"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl8pPr"),i.writeAttributeString("marL","3200400"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeStartElement("a:lvl9pPr"),i.writeAttributeString("marL","3657600"),i.writeAttributeString("algn","l"),i.writeAttributeString("defTabSz","914400"),i.writeAttributeString("rtl","0"),i.writeAttributeString("eaLnBrk","1"),i.writeAttributeString("latinLnBrk","0"),i.writeAttributeString("hangingPunct","1"),i.writeStartElement("a:defRPr"),i.writeAttributeString("sz","1800"),i.writeAttributeString("kern","1200"),i.writeStartElement("a:solidFill"),i.writeStartElement("a:schemeClr"),i.writeAttributeString("val","tx1"),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("a:latin"),i.writeAttributeString("typeface","+mn-lt"),i.writeEndElement(),i.writeStartElement("a:ea"),i.writeAttributeString("typeface","+mn-ea"),i.writeEndElement(),i.writeStartElement("a:cs"),i.writeAttributeString("typeface","+mn-cs"),i.writeEndElement(),i.writeFullEndElement(),i.writeFullEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeSlideRels(e){let i=new I,r=new F(C.UTF8,i);if(r.indentation=this.xmlIndentation<0?0:this.xmlIndentation,r.formatting=this.xmlIndentation<0?L.None:L.Indented,r.writeStartDocument(),r.writeStartElement("Relationships"),r.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),r.writeStartElement("Relationship"),r.writeAttributeString("Id","rId1"),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"),r.writeAttributeString("Target","../slideLayouts/slideLayout7.xml"),r.writeEndElement(),this.imageCache.imageIndex.stimulsoft.countItems>this.imageListOffset)for(let e=0;e<this.imageCache.imageIndex.stimulsoft.countItems-this.imageListOffset;e++)r.writeStartElement("Relationship"),r.writeAttributeString("Id",A.format("rId{0}",2+e)),r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),r.writeAttributeString("Target",A.format("../media/image{0:D5}.{1}",this.imageCache.imageIndex[this.imageListOffset+e]+1,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg")),r.writeEndElement();if(this.hyperlinkList.stimulsoft.countItems>0)for(let t=0;t<this.hyperlinkList.stimulsoft.countItems;t++){r.writeStartElement("Relationship"),r.writeAttributeString("Id",A.format("hId{0}",t+1));let e=this.hyperlinkList.stimulsoft.getByIndex(t);e.stimulsoft.is(String)&&(r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),r.writeAttributeString("Target",e),r.writeAttributeString("TargetMode","External")),e.stimulsoft.is(Number)&&(r.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide"),r.writeAttributeString("Target",A.format("slide{0}.xml",e))),r.writeEndElement()}return r.writeFullEndElement(),r.writeEndDocument(),r.flush(),i}writeSlide(e,i){let r=new I,n=new F(C.UTF8,r);n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?L.None:L.Indented,n.writeStartDocument(),n.writeStartElement("p:sld"),n.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:p","http://schemas.openxmlformats.org/presentationml/2006/main"),n.writeStartElement("p:cSld"),n.writeStartElement("p:spTree"),n.writeStartElement("p:nvGrpSpPr"),n.writeStartElement("p:cNvPr"),n.writeAttributeString("id","1"),n.writeAttributeString("name",""),n.writeEndElement(),n.writeStartElement("p:cNvGrpSpPr"),n.writeEndElement(),n.writeStartElement("p:nvPr"),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("p:grpSpPr"),n.writeStartElement("a:xfrm"),n.writeStartElement("a:off"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:ext"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeStartElement("a:chOff"),n.writeAttributeString("x","0"),n.writeAttributeString("y","0"),n.writeEndElement(),n.writeStartElement("a:chExt"),n.writeAttributeString("cx","0"),n.writeAttributeString("cy","0"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),this.idCounter=2;let s=i.getByIndex(e);i.getPage(s),this.writeWatermark(n,s,!0);for(let t of s.components.list)if(t.enabled&&t.width>0&&t.height>0){let e=t.stimulsoft.as(y);if(null==e||e.checkAllowHtmlTags())if(t.stimulsoft.is(b)){let e=new y(t.clientRectangle);e.page=t.page,e.border=t.stimulsoft.as(b).border,e.brush=t.stimulsoft.as(b).brush,e.hyperlinkValue=t.hyperlinkValue,this.writeStiTextbox(n,e)}else this.writeStiImage(n,t);else{let i=e.angle%360;if(i<0&&(i=360+i),0==i||90==i||270==i)this.writeStiTextbox(n,t);else{let t=e.clone(!0);t.text=null,t.angle=0,this.writeStiTextbox(n,t),t=e.clone(!0),t.border=null,t.brush=null,t.horAlignment=StiTextHorAlignment.Center,t.vertAlignment=StiVertAlignment.Center,this.writeStiTextbox(n,t)}}this.idCounter++}if(this.writeWatermark(n,s,!1),!(t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion)){let t=s.unit.convertToHInches(s.pageWidth-s.margins.left-s.margins.right),e=s.unit.convertToHInches(s.pageHeight-s.margins.top-s.margins.bottom),i=s.unit.convertToHInches(s.margins.left),r=s.unit.convertToHInches(s.margins.top);n.writeRaw('<p:sp><p:nvSpPr><p:cNvPr id="67" name="TextBox Additional"/><p:cNvSpPr txBox="1"/><p:nvPr userDrawn="1"/></p:nvSpPr>'+'<p:spPr><a:xfrm rot="-2700000"><a:off x="'+this.convertToEmu(i)+'" y="'+this.convertToEmu(r+.45*e)+'"/><a:ext cx="'+this.convertToEmu(t)+'" cy="'+this.convertToEmu(.1*e)+'"/></a:xfrm>'+'<a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></p:spPr>'+'<p:txBody><a:bodyPr wrap="square" rtlCol="0" anchor="ctr" anchorCtr="0"><a:spAutoFit/></a:bodyPr><a:lstStyle/><a:p><a:pPr algn="ctr"/><a:r><a:rPr lang="en-US" sz="9600" b="1" dirty="0" smtClean="0">'+'<a:solidFill><a:schemeClr val="tx1"><a:alpha val="12000"/></a:schemeClr></a:solidFill>'+'<a:latin typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/><a:cs typeface="Arial" panose="020B0604020202020204" pitchFamily="34" charset="0"/>'+"</a:rPr><a:t>Trial</a:t></a:r></a:p></p:txBody></p:sp>")}return n.writeFullEndElement(),n.writeEndElement(),n.writeStartElement("p:clrMapOvr"),n.writeStartElement("a:masterClrMapping"),n.writeEndElement(),n.writeFullEndElement(),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),r}writeStiTextbox(t,e){let i=e;t.writeStartElement("p:sp"),t.writeStartElement("p:nvSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",A.format("{0}",this.idCounter)),t.writeAttributeString("name",A.format("TextBox {0}",this.idCounter)),this.writeHyperlinkInfo(t,e),t.writeEndElement(),t.writeStartElement("p:cNvSpPr"),t.writeAttributeString("txBox","1"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();let r=this.writeSpPr(t,e);t.writeStartElement("p:txBody"),t.writeStartElement("a:bodyPr");let n=!1,s="";if(null!=i.textOptions){n=i.textOptions.wordWrap;let t=i.textOptions.angle%360;t<0&&(t=360+t),90==t&&(s="vert270"),270==t&&(s="vert")}s.length>0&&t.writeAttributeString("vert",s),t.writeAttributeString("horzOverflow","clip"),t.writeAttributeString("vertOverflow","clip");let o=this.convertToEmu(i.margins.left),a=this.convertToEmu(i.margins.right),l=this.convertToEmu(i.margins.top),m=this.convertToEmu(i.margins.bottom);t.writeAttributeString("lIns",A.format("{0}",o)),t.writeAttributeString("tIns",A.format("{0}",l)),t.writeAttributeString("rIns",A.format("{0}",a)),t.writeAttributeString("bIns",A.format("{0}",m)),t.writeAttributeString("wrap",n?"square":"none"),t.writeAttributeString("rtlCol","0");let c="t";i.vertAlignment==StiVertAlignment.Center&&(c="ctr"),i.vertAlignment==StiVertAlignment.Bottom&&(c="b"),t.writeAttributeString("anchor",c),t.writeAttributeString("anchorCtr","0"),t.writeStartElement("a:noAutofit"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:lstStyle"),t.writeEndElement(),t.writeStartElement("a:p");let g=!1;null!=i.textOptions&&(g=i.textOptions.rightToLeft),t.writeStartElement("a:pPr");let h="";i.horAlignment==StiTextHorAlignment.Center&&(h="ctr"),(i.horAlignment==StiTextHorAlignment.Right&&!g||i.horAlignment==StiTextHorAlignment.Left&&g)&&(h="r"),i.horAlignment==StiTextHorAlignment.Width&&(h="just"),h.length>0&&t.writeAttributeString("algn",h),g&&t.writeAttributeString("rtl","1"),t.writeStartElement("a:lnSpc"),t.writeStartElement("a:spcPct"),t.writeAttributeString("val",Math.round(.94*i.lineSpacing*1e5).toString()),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:r"),t.writeStartElement("a:rPr"),t.writeAttributeString("lang","en-US"),t.writeAttributeString("sz",(100*i.font.sizeInPoints*.984|0).toString()),i.font.bold&&t.writeAttributeString("b","1"),i.font.italic&&t.writeAttributeString("i","1"),i.font.underline&&t.writeAttributeString("u","sng"),i.font.strikeout&&t.writeAttributeString("strike","sngStrike"),t.writeAttributeString("dirty","0"),t.writeAttributeString("smtClean","0"),t.writeStartElement("a:solidFill"),this.writeColor(t,v.toColor(i.textBrush)),t.writeFullEndElement();let p="";null!=i.text&&(p=i.text.toString()),i.textQuality!=E.Wysiwyg&&i.horAlignment!=StiTextHorAlignment.Width||A.isNullOrEmpty(p)||!p.stimulsoft.endsWith(f.StiForceWidthAlignTag)||(p=p.substr(0,p.length-f.StiForceWidthAlignTag.length)),t.writeStartElement("a:latin"),t.writeAttributeString("typeface",i.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeStartElement("a:cs"),t.writeAttributeString("typeface",i.font.name),t.writeAttributeString("pitchFamily","18"),t.writeAttributeString("charset","0"),t.writeEndElement(),t.writeEndElement(),t.writeElementString("a:t",p),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),r&&this.writeBorder(t,e)}writeStiImage(t,i){let r=!1,n=i.stimulsoft.as(u);if(null!=n){let s=null;if(i.isExportAsImage(e.StiExportFormat.Ppt2007))try{P.currentCulture=this.currentCulture;let t={ref:this.imageResolution};s=n.getImage(t,e.StiExportFormat.ImagePng)}finally{P.currentCulture=this.newCulture}if(null!=s){let e=this.imageCache.addImageInt(s);s.dispose(),t.writeStartElement("p:pic"),t.writeStartElement("p:nvPicPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",A.format("{0}",this.idCounter)),t.writeAttributeString("name",A.format("Picture {0}",this.idCounter+1)),t.writeAttributeString("descr",A.format("Picture {0} description",this.idCounter+1)),this.writeHyperlinkInfo(t,i),t.writeEndElement(),t.writeStartElement("p:cNvPicPr"),t.writeStartElement("a:picLocks"),t.writeAttributeString("noChangeAspect","1"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeFullEndElement(),t.writeStartElement("p:blipFill"),t.writeStartElement("a:blip"),t.writeAttributeString("r:embed",A.format("rId{0}",1+this.imageCache.imageIndex.stimulsoft.countItems-this.imageListOffset)),t.writeEndElement(),t.writeStartElement("a:stretch"),t.writeStartElement("a:fillRect"),t.writeEndElement(),t.writeFullEndElement(),t.writeFullEndElement(),r=this.writeSpPr(t,i),t.writeFullEndElement()}}(r||i.stimulsoft.is(d))&&this.writeBorder(t,i)}writeSpPr(t,e){let i=this.convertToEmu(e.report.unit.convertToHInches(e.left+e.page.margins.left)),n=this.convertToEmu(e.report.unit.convertToHInches(e.top+e.page.margins.top)),o=this.convertToEmu(e.report.unit.convertToHInches(e.right+e.page.margins.left)),a=this.convertToEmu(e.report.unit.convertToHInches(e.bottom+e.page.margins.top)),l=0,m=e.stimulsoft.as(S);null!=m&&null!=m.textOptions&&(l=m.textOptions.angle%360,90!=l&&270!=l&&-90!=l&&-270!=l||(l=0)),t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),0!=l&&t.writeAttributeString("rot",A.format("{0}",0|Math.round(6e4*-l))),t.writeStartElement("a:off"),t.writeAttributeString("x",A.format("{0}",i)),t.writeAttributeString("y",A.format("{0}",n)),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",A.format("{0}",o-i)),t.writeAttributeString("cy",A.format("{0}",a-n)),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","rect"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement();let d=e.stimulsoft.is(p)||e.stimulsoft.is(s),u=Color.transparent;e.stimulsoft.is(w)&&(u=v.toColor(e.stimulsoft.as(w).brush)),0==u.a||d?(t.writeStartElement("a:noFill"),t.writeEndElement()):(t.writeStartElement("a:solidFill"),this.writeColor(t,u),t.writeFullEndElement());let f=!1,E=null;return e.stimulsoft.is(h)&&(E=e.stimulsoft.as(h).border),null!=E&&E.side!=g.None&&E.style!=r.None&&(E.side!=g.All||E.stimulsoft.is(c)?f=!0:(t.writeStartElement("a:ln"),t.writeAttributeString("w",A.format("{0}",this.convertToEmu(E.size))),t.writeStartElement("a:solidFill"),this.writeColor(t,E.color),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(E.style)),t.writeEndElement(),t.writeStartElement("a:miter"),t.writeAttributeString("lim","800000"),t.writeEndElement(),t.writeFullEndElement())),t.writeEndElement(),f}writeBorder(t,e){let i=e.stimulsoft.as(h).border;if(i.stimulsoft.is(c)){let r=i.stimulsoft.as(c);r.isLeftBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,0,e.height),r.leftSide.size,r.leftSide.style,r.leftSide.color),r.isRightBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.right,e.top,0,e.height),r.rightSide.size,r.rightSide.style,r.rightSide.color),r.isTopBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,e.width,0),r.topSide.size,r.topSide.style,r.topSide.color),r.isBottomBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.bottom,e.width,0),r.bottomSide.size,r.bottomSide.style,r.bottomSide.color)}else i.isLeftBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,0,e.height),i.size,i.style,i.color),i.isRightBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.right,e.top,0,e.height),i.size,i.style,i.color),i.isTopBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.top,e.width,0),i.size,i.style,i.color),i.isBottomBorderSidePresent&&this.writeLine(t,e,new Rectangle(e.left,e.bottom,e.width,0),i.size,i.style,i.color)}writeLine(t,e,i,n,s,o){if(s==r.None||0==o.a)return;t.writeStartElement("p:cxnSp"),t.writeStartElement("p:nvCxnSpPr"),t.writeStartElement("p:cNvPr"),t.writeAttributeString("id",A.format("{0}",this.idCounter)),t.writeAttributeString("name",A.format("Line {0}",this.idCounter)),t.writeEndElement(),t.writeStartElement("p:cNvCxnSpPr"),t.writeEndElement(),t.writeStartElement("p:nvPr"),t.writeEndElement(),t.writeEndElement();let a=this.convertToEmu(e.report.unit.convertToHInches(i.left+e.page.margins.left)),c=this.convertToEmu(e.report.unit.convertToHInches(i.top+e.page.margins.top)),g=this.convertToEmu(e.report.unit.convertToHInches(i.right+e.page.margins.left)),h=this.convertToEmu(e.report.unit.convertToHInches(i.bottom+e.page.margins.top));t.writeStartElement("p:spPr"),t.writeStartElement("a:xfrm"),t.writeStartElement("a:off"),t.writeAttributeString("x",A.format("{0}",a)),t.writeAttributeString("y",A.format("{0}",c)),t.writeEndElement(),t.writeStartElement("a:ext"),t.writeAttributeString("cx",A.format("{0}",g-a)),t.writeAttributeString("cy",A.format("{0}",h-c)),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:prstGeom"),t.writeAttributeString("prst","line"),t.writeStartElement("a:avLst"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("a:ln"),t.writeAttributeString("w",A.format("{0}",this.convertToEmu(n))),t.writeStartElement("a:solidFill"),this.writeColor(t,o),t.writeFullEndElement(),t.writeStartElement("a:prstDash"),t.writeAttributeString("val",this.getLineStyle(s)),t.writeEndElement();let p=e.stimulsoft.as(d);if(null!=p){let e=null,i=null;if(p.stimulsoft.is(m)&&(e=p.stimulsoft.as(m).startCap,i=p.stimulsoft.as(m).endCap),p.stimulsoft.is(l)&&(e=p.stimulsoft.as(l).startCap,i=p.stimulsoft.as(l).endCap),null!=e){let i=this.capStyleToPptStyle(e.style);A.isNullOrEmpty(i)||(t.writeStartElement("a:headEnd"),t.writeAttributeString("type",i),t.writeEndElement())}if(null!=i){let e=this.capStyleToPptStyle(i.style);A.isNullOrEmpty(e)||(t.writeStartElement("a:tailEnd"),t.writeAttributeString("type",e),t.writeEndElement())}}t.writeFullEndElement(),t.writeEndElement(),t.writeEndElement()}capStyleToPptStyle(t){switch(t){case a.Arrow:return"triangle";case a.Diamond:return"diamond";case a.Square:return"diamond";case a.Open:return"arrow";case a.Oval:return"oval";case a.Stealth:return"stealth"}return null}writeWatermark(t,e,i){if(null!=e.watermark&&(null!=e.watermark.image||!A.isNullOrWhiteSpace(e.watermark.imageHyperlink))&&e.watermark.showImageBehind==i){let i=new s;i.page=e,i.image=e.watermark.image,i.left=-e.margins.left,i.top=-e.margins.top,i.width=e.pageWidth,i.height=e.pageHeight,e.watermark.imageStretch&&(i.stretch=!0),i.vertAlignment=StiVertAlignment.Center,i.horAlignment=o.Center,this.writeStiImage(t,i)}}writeHyperlinkInfo(t,e){if(null!=e.hyperlinkValue){let i=e.hyperlinkValue.toString().trim(),r;if(i.length>0&&!i.stimulsoft.startsWith("javascript:"))if(i.stimulsoft.startsWith("#"));else{let e=this.stringToUrl(i);r=this.hyperlinkList.indexOf(e),-1==r&&(this.hyperlinkList.push(e),r=this.hyperlinkList.stimulsoft.countItems),t.writeStartElement("a:hlinkClick"),t.writeAttributeString("r:id",A.format("hId{0}",r)),t.writeEndElement()}}}writeImage(t){let e=new I,i=this.imageCache.imagePackedStore.stimulsoft.getByIndex(t);return e.write(i,0,i.length),e}exportPowerPoint(i,r,s){e.StiLogService.write(this.stimulsoft.getType(),"Export report to PowerPoint 2007 format");let o=s.pageRange;this.imageResolution=s.imageResolution,this.imageQuality=s.imageQuality,this.xmlIndentation=-1,this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=P.currentCulture,this.newCulture=P.cultures["en-US"];try{P.currentCulture=this.newCulture;let s=o.getSelectedPages(i.renderedPages);if(this.isStopped)return;this.imageCache=new e.StiImageCache(t["StiOptions"].Export.PowerPoint.AllowImageComparer,!0,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?e.ImageFormat.Png:e.ImageFormat.Jpeg,this.imageQuality);let a=new n;a.begin(r,!0),a.addFile("[Content_Types].xml",this.writeContentTypes(s.count)),a.addFile("_rels/.rels",this.writeMainRels()),a.addFile("docProps/app.xml",this.writeDocPropsApp(s.count)),a.addFile("docProps/core.xml",this.writeDocPropsCore()),a.addFile("ppt/tableStyles.xml",this.writeTableStyles()),a.addFile("ppt/presProps.xml",this.writePresProps()),a.addFile("ppt/viewProps.xml",this.writeViewProps()),a.addFile("ppt/theme/theme1.xml",this.writeTheme()),a.addFile("ppt/slideMasters/slideMaster1.xml",this.writeSlideMaster()),a.addFile("ppt/slideMasters/_rels/slideMaster1.xml.rels",this.writeSlideMasterRels());for(let t=0;t<11;t++)a.addFile(A.format("ppt/slideLayouts/slideLayout{0}.xml",t+1),this.writeSlideLayout(t+1,s.getByIndex(0))),a.addFile(A.format("ppt/slideLayouts/_rels/slideLayout{0}.xml.rels",t+1),this.writeSlideLayoutRels());a.addFile("ppt/presentation.xml",this.writePresentation(s)),a.addFile("ppt/_rels/presentation.xml.rels",this.writePresentationRels(s)),this.imageListOffset=0,this.hyperlinkList=[];for(let t=0;t<s.count;t++){if(this.invokeExporting2(t,s.count,0,1),this.isStopped)return;let e=s.getByIndex(t);s.getPage(e),a.addFile(A.format("ppt/slides/slide{0}.xml",t+1),this.writeSlide(t,s)),a.addFile(A.format("ppt/slides/_rels/slide{0}.xml.rels",t+1),this.writeSlideRels(t)),this.imageListOffset=this.imageCache.imageIndex.stimulsoft.countItems,this.hyperlinkList.stimulsoft.clear()}if(this.imageCache.imagePackedStore.stimulsoft.countItems>0)for(let e=0;e<this.imageCache.imagePackedStore.stimulsoft.countItems;e++)a.addFile(A.format("ppt/media/image{0:D5}.{1}",e+1,t["StiOptions"].Export.PowerPoint.StoreImagesAsPng?"png":"jpeg"),this.writeImage(e));a.end()}finally{P.currentCulture=this.currentCulture,this.imageCache.clear(),this.hyperlinkList=null}}}i.StiPpt2007ExportService=k}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.System.StiArray,n=t.System.StiString,s=t.System.Xml.Formatting,o=t.System.Text.Encoding,a=t.System.DateTime,l=t.Base.Zip.StiZipWriter20,m=t.System.IO.MemoryStream,c=t.Report.Components.StiPageOrientation,g=t.Report.Components.StiPagesCollection,h=t.Base.Drawing.StiBorderSides,p=t.Base.Drawing.StiVertAlignment,w=t.Report.Components.StiRichText,S=t.Report.Components.StiText,d=t.System.Xml.XmlTextWriter,u=t.System.Char,f=t.System.Text.StringBuilder,E=t.Base.Drawing.StiBrush,v=t.Report.Components.IStiFont,b=t.Report.Components.IStiTextBrush,y=t.Report.Components.IStiTextHorAlignment,x=t.Report.Components.IStiTextOptions,A=t.Base.Drawing.StiPenStyle,T=t.System.Collections.Hashtable,P=t.Base.Drawing.StiTextHorAlignment,L=t.Base.Localization.StiLocalization,C=t.Report.Components.IStiHorAlignment,F=t.Base.Drawing.StiHtmlTagsState,R=t.Base.Drawing.StiHtmlState,B=t.Report.Components.IStiExportImageExtended;class I{}class k extends i.StiExportService{constructor(){super(...arguments),this._matrix=null,this._removeEmptySpaceAtBottom=t["StiOptions"].Export.Word.removeEmptySpaceAtBottom,this.fontList=null,this.styleList=null,this.imageCache=null,this.bookmarkList=null,this.hyperlinkList=null,this.embedsList=null,this.xmlIndentation=1,this.imageQuality=.75,this.imageResolution=96,this.lineSpace=null,this.lineSpace2=null,this.usePageHeadersAndFooters=!1,this.restrictEditing=i.StiWord2007RestrictEditing.No,this.headersData=null,this.headersRels=null,this.footersData=null,this.footersRels=null,this.docCompanyString=null,this.docLastModifiedString=null,this.wrongUrlSymbols=" \"#'*,;<>[^`{|}"}implements(){return[i.IStiWord2007ExportService]}get defaultExtension(){return"docx"}get exportFormat(){return e.StiExportFormat.Word2007}get groupCategory(){return"Word"}get position(){return i.StiExportPosition.Word2007}get exportNameInMenu(){return L.get("Export","ExportTypeWord2007File")}exportTo(t,e,i){this.exportWord(t,e,i)}exportToAsync(e,i,r,n){t.Report.Export.StiExportImageHelper.convertAllImages(i,t.System.Drawing.Imaging.ImageFormat.Jpeg).try(()=>{this.exportTo(i,r,n),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null),e()})}get multipleFiles(){return!1}getFilter(){return L.get("FileFilters","Word2007Files")}get matrix(){return this._matrix}get removeEmptySpaceAtBottom(){return this._removeEmptySpaceAtBottom}checkFontsToCorrectHeight(t){return"Arial Unicode MS"==t||"Microsoft YaHei"==t}getLineStyle(t){switch(t){case A.Solid:return"single";case A.Dot:return"dotted";case A.Dash:return"dashSmallGap";case A.DashDot:return"dotDash";case A.DashDotDot:return"dotDotDash";case A.Double:return"double";default:return""}}getColorString(t){if(0==t.a)return"auto";if(t.a<32)return"FFFFFF";return n.format("{0:X8}",t.toArgb()).substr(2)}getStyleNumber(t,e){if(t.length>0)for(let i=0;i<t.length;i++){let r=t[i];if(r.alignment==e.alignment&&r.name==e.name&&r.fontName==e.fontName&&r.fontSize==e.fontSize&&r.bold==e.bold&&r.italic==e.italic&&r.underline==e.underline&&r.textColor.equals(e.textColor)&&r.rightToLeft==e.rightToLeft)return i}let i;return t.push(e),t.length-1}getStyleFromComponent(t){if(null!=t&&!n.isNullOrEmpty(t.componentStyle)){let e=t.stimulsoft.as(v),i=t.stimulsoft.as(b),r=t.stimulsoft.as(y),n=t.stimulsoft.as(x),s=new I;return s.name=t.componentStyle,null!=e&&(s.fontName=e.font.name,s.fontSize=Math.round2(2*e.font.sizeInPoints,0),s.bold=e.font.bold,s.italic=e.font.italic,s.underline=e.font.underline),null!=i&&(s.textColor=E.toColor(i.textBrush)),null!=r&&(s.alignment=r.horAlignment),null!=n&&(s.rightToLeft=n.textOptions.rightToLeft),this.getStyleNumber(this.styleList,s)}return-1}stringToUrl(t){if(n.isNullOrEmpty(t))return"";let e=new f;if(t.stimulsoft.startsWith("file:"))for(let i of t.split(""))i.charCodeAt(0)<32||'"'==i?e.append(n.format("%{0:x2}",i)):e.append(i);else for(let i of t.split(""))i.charCodeAt(0)<32||-1!=this.wrongUrlSymbols.indexOf(i)?e.append("_"):e.append(i);return e.toString()}static get hiToTwips(){return 14.4*.995}convert(t){return Math.round2(t*k.hiToTwips)}convertHiToTwips(t){return Math.round2(14.4*t)}convertTwipsToEmu(t){return Math.round2(t/k.hiToTwips/100*914400)}convertStringToBookmark(t){let e=new f;for(let i of t.split(""))u.isLetterOrDigit(i)&&e.append(i);return e.length>0&&null!=e.toString()[0]&&u.isDigit(e.toString()[0])&&e.insert(0,"b"),e.toString()}writeFromMatrix(s,o,a,l){let m=this.matrix.coordX.countItems,c=this.matrix.coordY.countItems,g=r.create(Number,m),d=this.matrix.coordX.getKeys();for(let t=0;t<m;t++){let e=this.matrix.coordX.getByIndex(t,d);g[t]=this.convert(e)}let u=r.create(Number,c),f=this.matrix.coordY.getKeys();for(let t=0;t<c;t++){let e=this.matrix.coordY.getByIndex(t,f);u[t]=this.convert(e)}let E=!1,v=0,b=r.create2(Boolean,c,m),y=r.create2(Boolean,c,m),x="";this.currentPassNumber=2+(t["StiOptions"].Export.Word.divideSegmentPages?1:0);for(let r=1;r<c;r++){this.invokeExporting2(r,c,this.currentPassNumber,this.maximumPassNumber);let d=r-1>=o&&r-1<=a;0==l&&(this.matrix.linePlacement[r-1]!=i.StiTableLineInfo.PageHeader&&this.matrix.linePlacement[r-1]!=i.StiTableLineInfo.PageFooter&&this.matrix.linePlacement[r-1]!=i.StiTableLineInfo.Trash||(d=!1)),v>0&&(v--,d=!1);let f=100005,A=[],T=!1;if(d)for(let t=1;t<m;t++){let e=this.matrix.cells[r-1][t-1];if(0==b[r][t]&&null!=e&&null!=e.component){if(null!=e.component.tagValue){let t=e.component.tagValue.toString().toLowerCase();-1!=t.indexOf("rtfparagraph")&&(A.push(e),d=!1),-1!=t.indexOf("rtfnewpage")&&(T=!0)}let t=null;e.component.stimulsoft.is(S)&&(t=e.component.margins),e.component.stimulsoft.is(w)&&(t=e.component.margins),null!=t&&(t.top<f&&(f=t.top),e.height>0&&(f=0))}}f*=k.hiToTwips;let P=Math.round2(f);if(T&&(E&&(s.writeFullEndElement(),E=!1),s.writeStartElement("w:p"),s.writeStartElement("w:r"),s.writeStartElement("w:br"),s.writeAttributeString("w:type","page"),s.writeEndElement(),s.writeEndElement(),s.writeEndElement()),d){if(this.usePageHeadersAndFooters&&this.matrix.linePlacement[r-1]==i.StiTableLineInfo.HeaderAP){let t=this.matrix.parentBandName[r-1],e=t.indexOf("");-1!=e&&(t=t.substr(0,e)),t!=x&&(x=t,E&&s.writeFullEndElement(),s.writeStartElement("w:p"),s.writeEndElement(),s.writeStartElement("w:tbl"),this.writeTableInfo(s,g,m),E=!0)}E||(s.writeStartElement("w:tbl"),this.writeTableInfo(s,g,m),E=!0),s.writeStartElement("w:tr");let e=u[r]-u[r-1];s.writeStartElement("w:trPr"),this.usePageHeadersAndFooters&&!t["StiOptions"].Export.Word.forceLineHeight||(s.writeStartElement("w:trHeight"),(!this.usePageHeadersAndFooters&&t["StiOptions"].Export.Word.lineHeightExactly||this.usePageHeadersAndFooters&&t["StiOptions"].Export.Word.lineHeightExactlyForPHFMode)&&s.writeAttributeString("w:hRule","exact"),s.writeAttributeString("w:val",n.format("{0}",e)),s.writeEndElement()),this.usePageHeadersAndFooters&&this.matrix.linePlacement[r-1]==i.StiTableLineInfo.HeaderAP&&(s.writeStartElement("w:tblHeader"),s.writeEndElement()),s.writeEndElement()}let L=0;for(let o=1;o<m;o++){let a=this.matrix.cells[r-1][o-1];if(!b[r][o]||y[r][o]){L++;let l=!0;if(y[r][o]){let t=r;while(y[t][o])t--;a=this.matrix.cells[t-1][o-1],l=!1}if(null!=a&&l){for(let t=0;t<=a.height;t++)for(let e=0;e<=a.width;e++)b[r+t][o+e]=!0;if(a.height>0)for(let t=1;t<=a.height;t++)y[r+t][o]=!0}if(d){if(s.writeStartElement("w:tc"),null!=a){s.writeStartElement("w:tcPr");let m=0;for(let t=0;t<a.width+1;t++)m+=g[o+t]-g[o-1+t];if(s.writeStartElement("w:tcW"),s.writeAttributeString("w:w",n.format("{0}",m)),s.writeAttributeString("w:type","dxa"),s.writeEndElement(),a.width>0&&(s.writeStartElement("w:gridSpan"),s.writeAttributeString("w:val",n.format("{0}",a.width+1)),s.writeEndElement()),a.height>0&&(y[r][o]?(s.writeStartElement("w:vMerge"),s.writeEndElement()):(s.writeStartElement("w:vMerge"),s.writeAttributeString("w:val","restart"),s.writeEndElement())),null!=a.cellStyle.textOptions){let t=a.cellStyle.textOptions.angle,e="";t>45&&t<135&&(e="btLr"),t>225&&t<315&&(e="tbRl"),""!=e&&(s.writeStartElement("w:textDirection"),s.writeAttributeString("w:val",e),s.writeEndElement())}let c=a.component.stimulsoft.is(S)&&a.component.checkAllowHtmlTags()&&!t["StiOptions"].Export.Word.renderHtmlTagsAsImage;if(l&&a.component.stimulsoft.is(S)&&(!a.component.isExportAsImage(e.StiExportFormat.Word2007)||c)){let e=a.component,i=this.convert(e.margins.left),r=this.convert(e.margins.right-t["StiOptions"].Export.Word.rightMarginCorrection),o=this.convert(e.margins.top);o>P&&(o=P),(i>0||r>0||o>0)&&(s.writeStartElement("w:tcMar"),o>0&&(s.writeStartElement("w:top"),s.writeAttributeString("w:w",n.format("{0}",o)),s.writeAttributeString("w:type","dxa"),s.writeEndElement()),i>0&&(s.writeStartElement("w:left"),s.writeAttributeString("w:w",n.format("{0}",i)),s.writeAttributeString("w:type","dxa"),s.writeEndElement()),r>0&&(s.writeStartElement("w:right"),s.writeAttributeString("w:w",n.format("{0}",r)),s.writeAttributeString("w:type","dxa"),s.writeEndElement()),s.writeEndElement())}let h="";switch(a.cellStyle.vertAlignment){case p.Center:h="center";break;case p.Bottom:h="bottom";break}""!=h&&(s.writeStartElement("w:vAlign"),s.writeAttributeString("w:val",h),s.writeEndElement()),this.writeBorders(s,a.top,a.left,a.height+1,a.width+1),a.component.isExportAsImage(e.StiExportFormat.Word2007)||(s.writeStartElement("w:shd"),s.writeAttributeString("w:val","clear"),s.writeAttributeString("w:color","auto"),s.writeAttributeString("w:fill",this.getColorString(a.cellStyle.color)),s.writeEndElement()),s.writeEndElement();let w=this.restrictEditing==i.StiWord2007RestrictEditing.ExceptEditableFields&&null!=a.component&&a.component.stimulsoft.is(S)&&a.component.editable;w&&(s.writeStartElement("w:permStart"),s.writeAttributeString("w:id","0"),s.writeEndElement());let d=!0;if(l){let t={ref:d};this.writeCellContent(s,a,t,r,o,g,u),d=t.ref}d&&(s.writeStartElement("w:p"),s.writeFullEndElement()),w&&(s.writeStartElement("w:permEnd"),s.writeAttributeString("w:id","0"),s.writeEndElement())}else{let t=null,e={ref:t},i=this.renderBorder2TableGetValues(r,o,e),a=0;if(0==(i&h.Right)){while(o+a+1<m&&null==this.matrix.cells[r-1][o+a+1-1]&&0==b[r][o+a+1]&&0==y[r][o+a+1]){let e=null,n={ref:e},s=this.renderBorder2TableGetValues(r,o+a+1,n);if((s&h.Left)>0)break;if((s&(h.Top|h.Bottom))!=(i&(h.Top|h.Bottom)))break;if(t!=e)break;if(a++,(s&h.Right)>0)break}if(a>0)for(let t=1;t<=a;t++)b[r][o+t]=!0}s.writeStartElement("w:tcPr");let l=g[o+a]-g[o-1];s.writeStartElement("w:tcW"),s.writeAttributeString("w:w",n.format("{0}",l)),s.writeAttributeString("w:type","dxa"),s.writeEndElement(),a>0&&(s.writeStartElement("w:gridSpan"),s.writeAttributeString("w:val",n.format("{0}",a+1)),s.writeEndElement()),this.writeBorders(s,r-1,o-1,1,a+1),s.writeEndElement(),s.writeStartElement("w:p"),s.writeFullEndElement()}s.writeFullEndElement()}}if(L>=64)break}d&&s.writeFullEndElement();for(let t of A){E&&s.writeEndElement(),E=!1,v=t.height;let e=!1,i={ref:e};this.writeCellContent(s,t,i,t.top+1,t.left+1,g,u),e=i.ref}}E&&s.writeEndElement()}writeCellContent(i,r,s,o,a,l,m){let c=s.ref,g=null,h=-1,p=this.matrix.bookmarks[o-1][a-1];null==p||this.bookmarkList.containsKey(p)||(h=this.bookmarkList.count,g=this.convertStringToBookmark(p),this.bookmarkList.set(p,h));let d=null,E=-1;if(null!=r.component&&null!=r.component.hyperlinkValue){let t=r.component.hyperlinkValue.toString().trim();t.length>0&&!t.stimulsoft.startsWith("javascript:")&&(t.stimulsoft.startsWith("#")?d=this.convertStringToBookmark(t.substr(1)):(d=this.stringToUrl(t),this.hyperlinkList.containsKey(d)?E=Math.trunc(this.hyperlinkList.get(d)):(E=this.hyperlinkList.count,this.hyperlinkList.add(d,E))))}if(!r.component.stimulsoft.is(S)||r.component.isExportAsImage(e.StiExportFormat.Word2007)||r.component.checkAllowHtmlTags())if(r.component.stimulsoft.is(w)&&!t["StiOptions"].Export.Word.renderRichTextAsImage){let t=r.component}else if(r.component.stimulsoft.is(S)&&r.component.checkAllowHtmlTags()&&!t["StiOptions"].Export.Word.renderHtmlTagsAsImage)n.isNullOrWhiteSpace(r.text)||this.writeHtmlTags(i,r);else if(r.component.isExportAsImage(e.StiExportFormat.Word2007)){let t=r.component.stimulsoft.as(B);if(null!=t){let e=this.imageResolution,s={ref:e},p=t.getImage(s);if(e=s.ref,null!=p){let t=this.matrix.getRealImageData(r,p);c=!1;let e=0;e=null!=t?this.imageCache.addImageIntRaw(t,t.imageFormat):this.imageCache.addImageIntRaw(p,p.imageFormat);let s=-1,w=-1;i.writeStartElement("w:p"),i.writeStartElement("w:pPr");let S=r.cellStyle.horAlignment,u=!1;if(null!=r.cellStyle.textOptions&&(u=r.cellStyle.textOptions.rightToLeft),null==r.component.stimulsoft.as(y)){let t=r.component.stimulsoft.as(C)}let f="";(S==P.Left&&1==u||S==P.Right&&0==u)&&(f="right"),S==P.Center&&(f="center"),S==P.Width&&(f="both"),""!=f&&(i.writeStartElement("w:jc"),i.writeAttributeString("w:val",f),i.writeEndElement()),i.writeEndElement(),-1!=h&&(i.writeStartElement("w:bookmarkStart"),i.writeAttributeString("w:id",h.toString()),i.writeAttributeString("w:name",g),i.writeEndElement()),i.writeStartElement("w:r"),i.writeStartElement("w:rPr"),i.writeElementString("w:noProof",""),i.writeEndElement(),i.writeStartElement("w:drawing"),i.writeStartElement("wp:inline"),i.writeAttributeString("distT","0"),i.writeAttributeString("distB","0"),i.writeAttributeString("distL","0"),i.writeAttributeString("distR","0");let v=m[o-1+r.height+1]-m[o-1],b=l[a-1+r.width+1]-l[a-1];-1!=s&&(b=s,v=w),i.writeStartElement("wp:extent"),i.writeAttributeString("cx",n.format("{0}",this.convertTwipsToEmu(b))),i.writeAttributeString("cy",n.format("{0}",this.convertTwipsToEmu(v))),i.writeEndElement(),i.writeStartElement("wp:effectExtent"),i.writeAttributeString("l","0"),i.writeAttributeString("t","0"),i.writeAttributeString("r","0"),i.writeAttributeString("b","0"),i.writeEndElement(),i.writeStartElement("wp:docPr"),i.writeAttributeString("id",n.format("{0}",e+2)),i.writeAttributeString("name",n.format("Picture {0}",e+1)),i.writeAttributeString("descr",n.format("Image{0:D5}.jpg",e+1)),null!=d&&(-1==E&&(d="#"+d,this.hyperlinkList.containsKey(d)?E=this.hyperlinkList.get(d):(E=this.hyperlinkList.count,this.hyperlinkList.add(d,E))),i.writeStartElement("a:hlinkClick"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeAttributeString("r:id",n.format("hId{0}",E)),i.writeEndElement()),i.writeEndElement(),i.writeStartElement("wp:cNvGraphicFramePr"),i.writeStartElement("a:graphicFrameLocks"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeAttributeString("noChangeAspect","1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("a:graphic"),i.writeAttributeString("xmlns:a","http://schemas.openxmlformats.org/drawingml/2006/main"),i.writeStartElement("a:graphicData"),i.writeAttributeString("uri","http://schemas.openxmlformats.org/drawingml/2006/picture"),i.writeStartElement("pic:pic"),i.writeAttributeString("xmlns:pic","http://schemas.openxmlformats.org/drawingml/2006/picture"),i.writeStartElement("pic:nvPicPr"),i.writeStartElement("pic:cNvPr"),i.writeAttributeString("id","0"),i.writeAttributeString("name",n.format("Image{0:D5}.jpg",e+1)),i.writeEndElement(),i.writeStartElement("pic:cNvPicPr"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("pic:blipFill"),i.writeStartElement("a:blip"),i.writeAttributeString("r:embed",n.format("rId{0}",5+e)),i.writeAttributeString("cstate","print"),i.writeEndElement(),i.writeStartElement("a:stretch"),i.writeStartElement("a:fillRect"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("pic:spPr"),i.writeStartElement("a:xfrm"),i.writeStartElement("a:off"),i.writeAttributeString("x","0"),i.writeAttributeString("y","0"),i.writeEndElement(),i.writeStartElement("a:ext"),i.writeAttributeString("cx",n.format("{0}",this.convertTwipsToEmu(b))),i.writeAttributeString("cy",n.format("{0}",this.convertTwipsToEmu(v))),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("a:prstGeom"),i.writeAttributeString("prst","rect"),i.writeStartElement("a:avLst"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),-1!=h&&(i.writeStartElement("w:bookmarkEnd"),i.writeAttributeString("w:id",h.toString()),i.writeEndElement()),i.writeEndElement()}}}else-1!=h&&(i.writeStartElement("w:bookmarkStart"),i.writeAttributeString("w:id",h.toString()),i.writeAttributeString("w:name",g),i.writeEndElement(),i.writeStartElement("w:bookmarkEnd"),i.writeAttributeString("w:id",h.toString()),i.writeEndElement());else{let e=new f(r.text);if(this.usePageHeadersAndFooters){let t=r.component.tagValue;n.isNullOrEmpty(t)||-1!=t.toLowerCase().indexOf("rtfnewpage")||-1==t.indexOf("#PageNumber#")&&-1==t.indexOf("#TotalPageCount#")&&-1==t.indexOf("#PageRef")||(e=new f(t))}let s=[],o="";for(let t of e.toString().split(""))u.isControl(t)&&"\t"!=t?"\n"==t&&(s.push(o),o=""):o+=t;""!=o&&s.push(o),0==s.length&&s.push(o),s.length>0&&(c=!1);let a=this.getStyleFromComponent(r.component);for(let e=0;e<s.length;e++){let o=s[e];i.writeStartElement("w:p"),i.writeStartElement("w:pPr");let l=r.component.stimulsoft.as(S).lineSpacing;if(null!=this.lineSpace||1!=l){let e=this.lineSpace;1!=l&&(e=Math.round2(240*t["StiOptions"].Export.Word.lineSpacing*l).toString());let n=r.component.stimulsoft.as(v);null!=n&&null!=n.font&&this.checkFontsToCorrectHeight(n.font.name)&&(e=this.lineSpace2,1!=l&&(e=Math.round2(240*t["StiOptions"].Export.Word.lineSpacing*.772*l).toString())),i.writeStartElement("w:spacing"),i.writeAttributeString("w:line",e),i.writeEndElement()}-1!=a&&(i.writeStartElement("w:pStyle"),i.writeAttributeString("w:val",n.format("Style{0}",a)),i.writeEndElement());let m=r.cellStyle.horAlignment,c=!1;null!=r.cellStyle.textOptions&&(c=r.cellStyle.textOptions.rightToLeft);let p="";if((m==P.Left&&1==c||m==P.Right&&0==c)&&(p="right"),m==P.Center&&(p="center"),m==P.Width&&(p="both"),""!=p&&(i.writeStartElement("w:jc"),i.writeAttributeString("w:val",p),i.writeEndElement()),-1==a&&this.writeRunProperties(i,r),i.writeEndElement(),null!=d&&(i.writeStartElement("w:hyperlink"),-1==E?i.writeAttributeString("w:anchor",d):i.writeAttributeString("r:id",n.format("hId{0}",E))),-1!=h&&(i.writeStartElement("w:bookmarkStart"),i.writeAttributeString("w:id",h.toString()),i.writeAttributeString("w:name",g),i.writeEndElement()),""!=o)if(this.usePageHeadersAndFooters){o=o.stimulsoft.replaceAll("#PageNumber#","").stimulsoft.replaceAll("#TotalPageCount#","");let t=[],e=new f;for(let i of o.split(""))""==i||""==i?(e.length>0&&t.push(e.toString()),t.push(i.toString()),e=new f):e.append(i);e.length>0&&t.push(e.toString()),0==t.length&&t.push(o);for(let e=0;e<t.length;e++){let n=t[e];if(n.length>0&&(""==n[0]||""==n[0])){switch(i.writeStartElement("w:r"),-1==a&&this.writeRunProperties(i,r),i.writeStartElement("w:fldChar"),i.writeAttributeString("w:fldCharType","begin"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:r"),this.writeRunProperties(i,r),i.writeStartElement("w:instrText"),n.charAt(0)){case"":i.writeString("PAGE");break;case"":i.writeString("NUMPAGES");break}i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:r"),this.writeRunProperties(i,r),i.writeStartElement("w:fldChar"),i.writeAttributeString("w:fldCharType","end"),i.writeEndElement(),i.writeEndElement()}else i.writeStartElement("w:r"),-1==a&&this.writeRunProperties(i,r),i.writeStartElement("w:t"),i.writeAttributeString("xml:space","preserve"),i.writeString(n),i.writeEndElement(),i.writeEndElement()}}else i.writeStartElement("w:r"),-1==a&&this.writeRunProperties(i,r),i.writeStartElement("w:t"),i.writeAttributeString("xml:space","preserve"),i.writeString(o),i.writeEndElement(),i.writeEndElement();-1!=h&&(i.writeStartElement("w:bookmarkEnd"),i.writeAttributeString("w:id",h.toString()),i.writeEndElement()),null!=d&&i.writeEndElement(),i.writeEndElement()}}s.ref=c}writeTableInfo(t,e,i){t.writeStartElement("w:tblPr"),t.writeStartElement("w:tblStyle"),t.writeAttributeString("w:val","a1"),t.writeEndElement(),t.writeStartElement("w:tblW"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:tblLayout"),t.writeAttributeString("w:type","fixed"),t.writeEndElement(),t.writeStartElement("w:tblCellMar"),t.writeStartElement("w:top"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:left"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:bottom"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeStartElement("w:right"),t.writeAttributeString("w:w","0"),t.writeAttributeString("w:type","dxa"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:tblLook"),t.writeAttributeString("w:val","04A0"),t.writeEndElement(),t.writeEndElement(),t.writeStartElement("w:tblGrid");for(let r=1;r<i;r++){let i=e[r]-e[r-1];t.writeStartElement("w:gridCol"),t.writeAttributeString("w:w",n.format("{0}",i)),t.writeEndElement()}t.writeFullEndElement()}writeHtmlTags(e,i){let r=i.component,n=i.text,s=new F(r.font.bold,r.font.italic,r.font.underline,r.font.strikeout,r.font.sizeInPoints,r.font.name,E.toColor(r.textBrush),E.toColor(r.brush),!1,!1,0,0,r.lineSpacing,r.horAlignment),o=new R(s,0),a=t.Base.Drawing.StiTextRenderer.parseHtmlToStates(n,o),l=this.getStyleFromComponent(i.component);this.writeParagraphBegin(e,i,l,a,0);for(let r=0;r<a.length;r++){let n=a[r],o=n.ts;if("\n"==n.text.toString()&&r<a.stimulsoft.countItems-1){e.writeEndElement(),this.writeParagraphBegin(e,i,l,a,r+1);continue}e.writeStartElement("w:r"),e.writeStartElement("w:rPr"),o.bold&&(e.writeStartElement("w:b"),e.writeEndElement()),o.italic&&(e.writeStartElement("w:i"),e.writeEndElement()),o.underline&&(e.writeStartElement("w:u"),e.writeAttributeString("w:val","single"),e.writeEndElement()),o.strikeout&&(e.writeStartElement("w:strike"),e.writeEndElement()),o.superscript&&(e.writeStartElement("w:vertAlign"),e.writeAttributeString("w:val","superscript"),e.writeEndElement()),o.subsript&&(e.writeStartElement("w:vertAlign"),e.writeAttributeString("w:val","subscript"),e.writeEndElement()),o.fontColor.toArgb()!=s.fontColor.toArgb()&&(e.writeStartElement("w:color"),e.writeAttributeString("w:val",this.getColorString(o.fontColor)),e.writeEndElement()),o.backColor.toArgb()!=s.backColor.toArgb()&&(e.writeStartElement("w:shd"),e.writeAttributeString("w:val","clear"),e.writeAttributeString("w:color","auto"),e.writeAttributeString("w:fill",this.getColorString(o.backColor)),e.writeEndElement()),e.writeStartElement("w:sz"),e.writeAttributeString("w:val",(2*o.fontSize).toString()),e.writeEndElement(),e.writeStartElement("w:szCs"),e.writeAttributeString("w:val",(2*o.fontSize).toString()),e.writeEndElement(),e.writeStartElement("w:rFonts");let m=o.fontName;this.fontList.set(m,m),e.writeAttributeString("w:ascii",m),e.writeAttributeString("w:hAnsi",m),e.writeAttributeString("w:eastAsia",m),e.writeAttributeString("w:cs",m),e.writeEndElement();let c=o.letterSpacing*o.fontSize*18.8+t["StiOptions"].Export.Word.spaceBetweenCharacters;0!=c&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:val",c.toString()),e.writeEndElement()),null!=i.cellStyle.textOptions&&i.cellStyle.textOptions.rightToLeft&&(e.writeStartElement("w:rtl"),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w:t"),e.writeAttributeString("xml:space","preserve"),e.writeString(t.Base.Drawing.StiTextRenderer.prepareStateText(n.text).toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()}writeParagraphBegin(e,i,r,s,o){e.writeStartElement("w:p"),e.writeStartElement("w:pPr"),-1!=r?(e.writeStartElement("w:pStyle"),e.writeAttributeString("w:val",n.format("Style{0}",r)),e.writeEndElement()):this.writeRunProperties(e,i);let a=s[o];if("\n"!=a.text.toString()){let t=o+1;while(t<s.length&&"\n"!=s[t].text.toString())a=s[t],t++}let l=t["StiOptions"].Export.Word.lineSpacing*a.ts.lineHeight;this.checkFontsToCorrectHeight(a.ts.fontName)&&(l*=.772),1!=l&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:line",Math.round2(240*l).toString()),e.writeEndElement());let m=null;a.ts.textAlign==P.Center&&(m="center"),a.ts.textAlign==P.Right&&(m="right"),a.ts.textAlign==P.Width&&(m="both"),null!=m&&(e.writeStartElement("w:jc"),e.writeAttributeString("w:val",m),e.writeEndElement()),e.writeEndElement()}writeRunProperties(e,i){e.writeStartElement("w:rPr"),e.writeStartElement("w:rFonts");let r=i.cellStyle.font.name;this.fontList.set(r,r),e.writeAttributeString("w:ascii",r),e.writeAttributeString("w:hAnsi",r),e.writeAttributeString("w:eastAsia",r),e.writeAttributeString("w:cs",r),e.writeEndElement(),i.cellStyle.font.bold&&(e.writeStartElement("w:b"),e.writeEndElement()),i.cellStyle.font.italic&&(e.writeStartElement("w:i"),e.writeEndElement()),i.cellStyle.font.underline&&(e.writeStartElement("w:u"),e.writeAttributeString("w:val","single"),e.writeEndElement()),e.writeStartElement("w:color"),e.writeAttributeString("w:val",this.getColorString(i.cellStyle.textColor)),e.writeEndElement(),e.writeStartElement("w:sz"),e.writeAttributeString("w:val",n.format("{0}",2*i.cellStyle.font.sizeInPoints)),e.writeEndElement(),0!=t["StiOptions"].Export.Word.spaceBetweenCharacters&&(e.writeStartElement("w:spacing"),e.writeAttributeString("w:val",n.format("{0}",t["StiOptions"].Export.Word.spaceBetweenCharacters)),e.writeEndElement()),null!=i.cellStyle.textOptions&&i.cellStyle.textOptions.rightToLeft&&(i.cellStyle.font.bold&&(e.writeStartElement("w:bCs"),e.writeEndElement()),i.cellStyle.font.italic&&(e.writeStartElement("w:iCs"),e.writeEndElement()),e.writeStartElement("w:szCs"),e.writeAttributeString("w:val",n.format("{0}",2*i.cellStyle.font.sizeInPoints)),e.writeEndElement(),e.writeStartElement("w:rtl"),e.writeEndElement()),e.writeEndElement()}renderBorder2TableGetValues(t,e,i){let r=i.ref,n=h.None,s=new f;return null!=this.matrix.bordersY[t-1][e-1]&&(n|=h.Left),null!=this.matrix.bordersY[t-1][e-1+1]&&(n|=h.Right),null!=this.matrix.bordersX[t-1][e-1]&&(s.append("\\t"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1][e-1])),n|=h.Top),null!=this.matrix.bordersX[t-1+1][e-1]&&(s.append("\\b"+this.getLineStyle2TableGetValues(this.matrix.bordersX[t-1+1][e-1])),n|=h.Bottom),r=s.toString(),i.ref=r,n}getLineStyle2TableGetValues(t){let e=new f;return e.append(this.getLineStyle(t.style)),e.append(Math.trunc(15*t.size)),e.append(n.format("c{0}",this.getColorString(t.color))),e.toString()}writeDocument(e,r,n){let a=new m,l=new d(o.UTF8,a);l.indentation=this.xmlIndentation<0?0:this.xmlIndentation,l.formatting=this.xmlIndentation<0?s.None:s.Indented,l.writeStartDocument(),l.writeStartElement("w:document"),l.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),l.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),l.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),l.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),l.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),l.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),l.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),l.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),l.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),l.writeStartElement("w:body");let c=e;e=null;let h=0,p=0;while(h<c.count){(e=new g(r,c)).cacheMode=r.renderedPages.cacheMode,e.addV2Internal(c.getPageWithoutCache(h));while(h<c.count-1&&this.comparePages(c.getPageWithoutCache(h+1),c.getPageWithoutCache(h)))h++,e.addV2Internal(c.getPageWithoutCache(h));let s=e.getByIndex(0);if(null!=s){if(e.getPage(s),this.usePageHeadersAndFooters){let n=new g(r,r.renderedPages);n.cacheMode=r.renderedPages.cacheMode,n.add(e.getByIndex(0)),this._matrix=new i.StiMatrix(n,t["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!1);let s=0,o=0,a=!1;o=this.matrix.coordY.countItems-1-1;while(o>0&&this.matrix.linePlacement[o]!=i.StiTableLineInfo.PageHeader)o--;if(o>=0&&this.matrix.linePlacement[o]==i.StiTableLineInfo.PageHeader){s=0;while(this.matrix.linePlacement[s]!=i.StiTableLineInfo.PageHeader)s++;a=!0}this.headersData.push(this.writeHeader(s,o,a)),this.imageCache.imagePackedStore.length>0?this.headersRels.push(this.writeHeaderFooterRels()):this.headersRels.push(null);let m=!1;s=0;while(this.matrix.linePlacement[s]!=i.StiTableLineInfo.PageFooter&&s<this.matrix.coordY.countItems-1-1)s++;if(this.matrix.linePlacement[s]==i.StiTableLineInfo.PageFooter){o=this.matrix.coordY.countItems-1-1;while(this.matrix.linePlacement[o]!=i.StiTableLineInfo.PageFooter)o--;m=!0}this.footersData.push(this.writeFooter(s,o,m)),this.imageCache.imagePackedStore.length>0?this.footersRels.push(this.writeHeaderFooterRels()):this.footersRels.push(null),this._matrix=new i.StiMatrix(e,t["StiOptions"].Export.Word.divideBigCells,this),this.matrix.scanComponentsPlacement(!0),o=this.matrix.coordY.countItems-1-1,this.writeFromMatrix(l,0,o,!1)}else this._matrix=new i.StiMatrix(e,t["StiOptions"].Export.Word.divideBigCells,this,null,i.StiDataExportMode.AllBands,n),this.writeFromMatrix(l,0,this.matrix.coordY.countItems-1-1,!0);h<c.count-1&&(l.writeStartElement("w:p"),l.writeStartElement("w:pPr"),this.writePageInfo(l,e.getByIndex(0),p),l.writeEndElement(),l.writeEndElement())}h++,p++}return e.count>0&&this.writePageInfo(l,e.getByIndex(0),p-1),l.writeFullEndElement(),l.writeFullEndElement(),l.writeEndDocument(),l.flush(),a}comparePages(t,e){let i=t.excelSheetValue;n.isNullOrEmpty(i)&&(i="");let r=e.excelSheetValue;if(n.isNullOrEmpty(r)&&(r=""),i!=r)return!1;if(t.orientation!=e.orientation)return!1;if(!t.margins.equals(e.margins))return!1;if(t.unlimitedHeight!=e.unlimitedHeight)return!1;return!0}writePageInfo(e,i,r){let s=this.convertHiToTwips(i.unit.convertToHInches(i.pageHeight*(this.usePageHeadersAndFooters?1:i.segmentPerHeight))),o=this.convertHiToTwips(i.unit.convertToHInches(i.pageWidth*(this.usePageHeadersAndFooters?1:i.segmentPerWidth))),a=this.convertHiToTwips(i.unit.convertToHInches(i.margins.left)),l=this.convertHiToTwips(i.unit.convertToHInches(i.margins.right)),m=this.convertHiToTwips(i.unit.convertToHInches(i.margins.top)),g=this.convertHiToTwips(i.unit.convertToHInches(i.margins.bottom))-t["StiOptions"].Export.Word.bottomMarginCorrection;g<0&&(g=0),o>31500&&(o=31500),s>31500&&(s=31500),e.writeStartElement("w:sectPr"),this.usePageHeadersAndFooters?(e.writeStartElement("w:headerReference"),e.writeAttributeString("w:type","default"),e.writeAttributeString("r:id",n.format("rIdh{0}",r+1)),e.writeEndElement(),e.writeStartElement("w:footerReference"),e.writeAttributeString("w:type","default"),e.writeAttributeString("r:id",n.format("rIdf{0}",r+1)),e.writeEndElement()):t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(e.writeStartElement("w:headerReference"),e.writeAttributeString("w:type","default"),e.writeAttributeString("r:id","rIdh1"),e.writeEndElement()),e.writeStartElement("w:pgSz"),e.writeAttributeString("w:w",n.format("{0}",o)),e.writeAttributeString("w:h",n.format("{0}",s)),i.orientation==c.Landscape&&e.writeAttributeString("w:orient","landscape"),e.writeEndElement(),e.writeStartElement("w:pgMar"),e.writeAttributeString("w:top",n.format("{0}",m)),e.writeAttributeString("w:right",n.format("{0}",l)),e.writeAttributeString("w:bottom",n.format("{0}",g)),e.writeAttributeString("w:left",n.format("{0}",a)),e.writeAttributeString("w:header",n.format("{0}",m)),e.writeAttributeString("w:footer",n.format("{0}",g)),e.writeAttributeString("w:gutter","0"),e.writeEndElement(),e.writeEndElement()}writeBorders(t,e,i,r,n){let s=!0,o=!0;for(let t=0;t<r;t++)null==this.matrix.bordersY[e+t][i]&&(s=!1),null==this.matrix.bordersY[e+t][i+n]&&(o=!1);let a=!0,l=!0;for(let t=0;t<n;t++)null==this.matrix.bordersX[e][i+t]&&(a=!1),null==this.matrix.bordersX[e+r][i+t]&&(l=!1);(a||s||l||o)&&(t.writeStartElement("w:tcBorders"),a&&this.writeBorderData(t,"w:top",this.matrix.bordersX[e][i]),s&&this.writeBorderData(t,"w:left",this.matrix.bordersY[e][i]),l&&this.writeBorderData(t,"w:bottom",this.matrix.bordersX[e+r][i]),o&&this.writeBorderData(t,"w:right",this.matrix.bordersY[e][i+n]),t.writeEndElement())}writeBorderData(t,e,i){if(null!=i){let r=this.getLineStyle(i.style);""!=r&&(t.writeStartElement(e),t.writeAttributeString("w:val",r),t.writeAttributeString("w:sz",n.format("{0}",Math.trunc(5*i.size))),t.writeAttributeString("w:space","0"),t.writeAttributeString("w:color",this.getColorString(i.color)),t.writeEndElement())}}writeFootNotes(){let t=new m,e=new d(o.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("w:footnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeEndNotes(){let t=new m,e=new d(o.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("w:endnotes"),e.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","separator"),e.writeAttributeString("w:id","0"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:separator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:type","continuationSeparator"),e.writeAttributeString("w:id","1"),e.writeStartElement("w:p"),e.writeStartElement("w:r"),e.writeStartElement("w:continuationSeparator"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeHeader(t,e,i){let r=new m,n=new d(o.UTF8,r);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?s.None:s.Indented,n.writeStartDocument(),n.writeStartElement("w:hdr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),i?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),r}writeFooter(t,e,i){let r=new m,n=new d(o.UTF8,r);return n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?s.None:s.Indented,n.writeStartDocument(),n.writeStartElement("w:ftr"),n.writeAttributeString("xmlns:ve","http://schemas.openxmlformats.org/markup-compatibility/2006"),n.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),n.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),n.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),n.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),n.writeAttributeString("xmlns:wp","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"),n.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),n.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),n.writeAttributeString("xmlns:wne","http://schemas.microsoft.com/office/word/2006/wordml"),i?this.writeFromMatrix(n,t,e,!0):(n.writeStartElement("w:p"),n.writeStartElement("w:r"),n.writeStartElement("w:cr"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),r}writeContentTypes(){let e=new m,i=new d(o.UTF8,e);if(i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?s.None:s.Indented,i.writeStartDocument(),i.writeStartElement("Types"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/content-types"),i.writeStartElement("Default"),i.writeAttributeString("Extension","rels"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.relationships+xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","xml"),i.writeAttributeString("ContentType","application/xml"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","jpeg"),i.writeAttributeString("ContentType","image/jpeg"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","emf"),i.writeAttributeString("ContentType","image/x-emf"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","rtf"),i.writeAttributeString("ContentType","application/rtf"),i.writeEndElement(),i.writeStartElement("Default"),i.writeAttributeString("Extension","png"),i.writeAttributeString("ContentType","image/png"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/app.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.extended-properties+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/docProps/core.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-package.core-properties+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/document.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/styles.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/settings.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/webSettings.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/fontTable.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"),i.writeEndElement(),this.usePageHeadersAndFooters){i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/footnotes.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/endnotes.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),i.writeEndElement();for(let t=0;t<this.headersData.length;t++)i.writeStartElement("Override"),i.writeAttributeString("PartName",n.format("/word/footer{0}.xml",t+1)),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName",n.format("/word/header{0}.xml",t+1)),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),i.writeEndElement()}else t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/footnotes.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/endnotes.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml"),i.writeEndElement(),i.writeStartElement("Override"),i.writeAttributeString("PartName","/word/headerAdditional.xml"),i.writeAttributeString("ContentType","application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"),i.writeEndElement());return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeMainRels(){let t=new m,e=new d(o.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId1"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"),e.writeAttributeString("Target","word/document.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId2"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties"),e.writeAttributeString("Target","docProps/core.xml"),e.writeEndElement(),e.writeStartElement("Relationship"),e.writeAttributeString("Id","rId3"),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties"),e.writeAttributeString("Target","docProps/app.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsApp(){let t=new m,e=new d(o.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("Properties"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"),e.writeAttributeString("xmlns:vt","http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"),e.writeElementString("Application","Microsoft Office Word"),e.writeElementString("Company",null==this.docCompanyString?"":this.docCompanyString),e.writeElementString("Template","Normal.dotm"),e.writeElementString("TotalTime","0"),e.writeElementString("Pages","1"),e.writeElementString("Words","1"),e.writeElementString("Characters","1"),e.writeElementString("DocSecurity",this.restrictEditing==i.StiWord2007RestrictEditing.No?"0":"8"),e.writeElementString("Lines","1"),e.writeElementString("Paragraphs","1"),e.writeElementString("ScaleCrop","false"),e.writeElementString("LinksUpToDate","false"),e.writeElementString("CharactersWithSpaces","1"),e.writeElementString("SharedDoc","false"),e.writeElementString("HyperlinksChanged","false"),e.writeElementString("AppVersion","12.0000"),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocPropsCore(){let e=new m,i=new d(o.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?s.None:s.Indented,i.writeStartDocument(),i.writeStartElement("cp:coreProperties"),i.writeAttributeString("xmlns:cp","http://schemas.openxmlformats.org/package/2006/metadata/core-properties"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:dcterms","http://purl.org/dc/terms/"),i.writeAttributeString("xmlns:dcmitype","http://purl.org/dc/dcmitype/"),i.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance");let r=n.format("{0}{1}",a.now.toString("yyyy-MM-dd"),a.now.toString("THH:mm:ssZ"));return i.writeElementString("dc:title",null==this.report.reportName?"":this.report.reportName),i.writeElementString("dc:subject",null==this.report.reportAlias?"":this.report.reportAlias),i.writeElementString("dc:creator",null==this.report.reportAuthor?"":this.report.reportAuthor),i.writeElementString("cp:keywords",""),i.writeElementString("dc:description",null==this.report.reportDescription?"":this.report.reportDescription),i.writeElementString("cp:lastModifiedBy",null==this.docLastModifiedString?"":this.docLastModifiedString),i.writeElementString("cp:revision","1"),i.writeStartElement("dcterms:created"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),i.writeStartElement("dcterms:modified"),i.writeAttributeString("xsi:type","dcterms:W3CDTF"),i.writeString(r),i.writeEndElement(),i.writeElementString("cp:contentStatus",t.StiVersion.platform()),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeSettings(){let t=new m,e=new d(o.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("w:settings"),e.writeAttributeString("xmlns:o","urn:schemas-microsoft-com:office:office"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:m","http://schemas.openxmlformats.org/officeDocument/2006/math"),e.writeAttributeString("xmlns:v","urn:schemas-microsoft-com:vml"),e.writeAttributeString("xmlns:w10","urn:schemas-microsoft-com:office:word"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeAttributeString("xmlns:sl","http://schemas.openxmlformats.org/schemaLibrary/2006/main"),this.restrictEditing!=i.StiWord2007RestrictEditing.No&&(e.writeStartElement("w:documentProtection"),e.writeAttributeString("w:edit","readOnly"),e.writeAttributeString("w:enforcement","1"),e.writeAttributeString("w:cryptProviderType","rsaFull"),e.writeAttributeString("w:cryptAlgorithmClass","hash"),e.writeAttributeString("w:cryptAlgorithmType","typeAny"),e.writeAttributeString("w:cryptAlgorithmSid","4"),e.writeAttributeString("w:cryptSpinCount","50000"),e.writeAttributeString("w:hash","aw5VYrxGrQVOl7/SJDI9GvbcwaE="),e.writeAttributeString("w:salt","974T1u8C/8p0OAB+3ev3nQ=="),e.writeEndElement()),e.writeStartElement("w:zoom"),e.writeAttributeString("w:percent","100"),e.writeEndElement(),e.writeStartElement("w:proofState"),e.writeAttributeString("w:spelling","clean"),e.writeAttributeString("w:grammar","clean"),e.writeEndElement(),e.writeStartElement("w:defaultTabStop"),e.writeAttributeString("w:val","708"),e.writeEndElement(),e.writeStartElement("w:characterSpacingControl"),e.writeAttributeString("w:val","doNotCompress"),e.writeEndElement(),this.usePageHeadersAndFooters&&(e.writeStartElement("w:footnotePr"),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:footnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:endnotePr"),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","0"),e.writeEndElement(),e.writeStartElement("w:endnote"),e.writeAttributeString("w:id","1"),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("w:compat"),e.writeEndElement(),e.writeStartElement("m:mathPr"),e.writeStartElement("m:mathFont"),e.writeAttributeString("m:val","Cambria Math"),e.writeEndElement(),e.writeStartElement("m:brkBin"),e.writeAttributeString("m:val","before"),e.writeEndElement(),e.writeStartElement("m:brkBinSub"),e.writeAttributeString("m:val","--"),e.writeEndElement(),e.writeStartElement("m:smallFrac"),e.writeAttributeString("m:val","off"),e.writeEndElement(),e.writeStartElement("m:dispDef"),e.writeEndElement(),e.writeStartElement("m:lMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:rMargin"),e.writeAttributeString("m:val","0"),e.writeEndElement(),e.writeStartElement("m:defJc"),e.writeAttributeString("m:val","centerGroup"),e.writeEndElement(),e.writeStartElement("m:wrapIndent"),e.writeAttributeString("m:val","1440"),e.writeEndElement(),e.writeStartElement("m:intLim"),e.writeAttributeString("m:val","subSup"),e.writeEndElement(),e.writeStartElement("m:naryLim"),e.writeAttributeString("m:val","undOvr"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:themeFontLang"),e.writeAttributeString("w:val","en-EN"),e.writeEndElement(),e.writeStartElement("w:clrSchemeMapping"),e.writeAttributeString("w:bg1","light1"),e.writeAttributeString("w:t1","dark1"),e.writeAttributeString("w:bg2","light2"),e.writeAttributeString("w:t2","dark2"),e.writeAttributeString("w:accent1","accent1"),e.writeAttributeString("w:accent2","accent2"),e.writeAttributeString("w:accent3","accent3"),e.writeAttributeString("w:accent4","accent4"),e.writeAttributeString("w:accent5","accent5"),e.writeAttributeString("w:accent6","accent6"),e.writeAttributeString("w:hyperlink","hyperlink"),e.writeAttributeString("w:followedHyperlink","followedHyperlink"),e.writeEndElement(),e.writeStartElement("w:shapeDefaults"),e.writeStartElement("o:shapedefaults"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("spidmax","2050"),e.writeEndElement(),e.writeStartElement("o:shapelayout"),e.writeAttributeString("v:ext","edit"),e.writeStartElement("o:idmap"),e.writeAttributeString("v:ext","edit"),e.writeAttributeString("data","1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w:decimalSymbol"),e.writeAttributeString("w:val",","),e.writeEndElement(),e.writeStartElement("w:listSeparator"),e.writeAttributeString("w:val",";"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeWebSettings(){let t=new m,e=new d(o.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("w:webSettings"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),e.writeStartElement("w:optimizeForBrowser"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeFontTable(){let t=new m,e=new d(o.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("w:fonts"),e.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),e.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),this.fontList.set("Calibri","Calibri"),this.fontList.set("Cambria","Cambria");for(let t of this.fontList.values)e.writeStartElement("w:font"),e.writeAttributeString("w:name",t),e.writeFullEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeDocumentRels(){let e=new m,i=new d(o.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?s.None:s.Indented,i.writeStartDocument(),i.writeStartElement("Relationships"),i.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships"),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles"),i.writeAttributeString("Target","styles.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId2"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings"),i.writeAttributeString("Target","settings.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId3"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings"),i.writeAttributeString("Target","webSettings.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rId4"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable"),i.writeAttributeString("Target","fontTable.xml"),i.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.length;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",5+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),i.writeAttributeString("Target",n.format("media/image{0:D5}.jpeg",t+1)),i.writeEndElement();if(this.usePageHeadersAndFooters){i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),i.writeAttributeString("Target","footnotes.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),i.writeAttributeString("Target","endnotes.xml"),i.writeEndElement();for(let t=0;t<this.headersData.length;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rIdh{0}",t+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),i.writeAttributeString("Target",n.format("header{0}.xml",t+1)),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rIdf{0}",t+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer"),i.writeAttributeString("Target",n.format("footer{0}.xml",t+1)),i.writeEndElement()}else t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+0)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes"),i.writeAttributeString("Target","footnotes.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("rId{0}",5+this.imageCache.imagePackedStore.length+1)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes"),i.writeAttributeString("Target","endnotes.xml"),i.writeEndElement(),i.writeStartElement("Relationship"),i.writeAttributeString("Id","rIdh1"),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/header"),i.writeAttributeString("Target","headerAdditional.xml"),i.writeEndElement());if(this.hyperlinkList.count>0)for(let t of this.hyperlinkList.keys)i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("hId{0}",Math.trunc(this.hyperlinkList.get(t)))),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"),i.writeAttributeString("Target",t),i.writeAttributeString("TargetMode","External"),i.writeEndElement();if(this.embedsList.length>0)for(let t=0;t<this.embedsList.length;t++)i.writeStartElement("Relationship"),i.writeAttributeString("Id",n.format("reId{0}",1+t)),i.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"),i.writeAttributeString("Target",n.format("embeddings/richtext{0:D5}.rtf",t+1)),i.writeAttributeString("TargetMode","Internal"),i.writeEndElement();return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeHeaderFooterRels(){let t=new m,e=new d(o.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?s.None:s.Indented,e.writeStartDocument(),e.writeStartElement("Relationships"),e.writeAttributeString("xmlns","http://schemas.openxmlformats.org/package/2006/relationships");for(let t=0;t<this.imageCache.imagePackedStore.length;t++)e.writeStartElement("Relationship"),e.writeAttributeString("Id",n.format("rId{0}",5+t)),e.writeAttributeString("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),e.writeAttributeString("Target",n.format("media/image{0:D5}.jpeg",t+1)),e.writeEndElement();return e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(){let e=new m,i=new d(o.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?s.None:s.Indented,i.writeStartDocument(),i.writeStartElement("w:styles"),i.writeAttributeString("xmlns:r","http://schemas.openxmlformats.org/officeDocument/2006/relationships"),i.writeAttributeString("xmlns:w","http://schemas.openxmlformats.org/wordprocessingml/2006/main"),i.writeStartElement("w:style"),i.writeAttributeString("w:type","paragraph"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Normal"),i.writeEndElement(),i.writeStartElement("w:qFormat"),i.writeEndElement(),i.writeStartElement("w:pPr"),i.writeStartElement("w:spacing"),i.writeAttributeString("w:after","0"),i.writeAttributeString("w:line","240"),i.writeAttributeString("w:lineRule","auto"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:rPr"),i.writeStartElement("w:sz"),i.writeAttributeString("w:val",n.format("{0}",Math.round2(2*t["StiOptions"].Export.Word.normalStyleDefaultFontSize))),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","character"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a0"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Default Paragraph Font"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","1"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","table"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a1"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","Normal Table"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","99"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeStartElement("w:qFormat"),i.writeEndElement(),i.writeStartElement("w:tblPr"),i.writeStartElement("w:tblInd"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:tblCellMar"),i.writeStartElement("w:top"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:left"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:bottom"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeStartElement("w:right"),i.writeAttributeString("w:w","0"),i.writeAttributeString("w:type","dxa"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("w:style"),i.writeAttributeString("w:type","numbering"),i.writeAttributeString("w:default","1"),i.writeAttributeString("w:styleId","a2"),i.writeStartElement("w:name"),i.writeAttributeString("w:val","No List"),i.writeEndElement(),i.writeStartElement("w:uiPriority"),i.writeAttributeString("w:val","99"),i.writeEndElement(),i.writeStartElement("w:semiHidden"),i.writeEndElement(),i.writeStartElement("w:unhideWhenUsed"),i.writeEndElement(),i.writeEndElement();for(let e=0;e<this.styleList.length;e++){let r=this.styleList[e];i.writeStartElement("w:style"),i.writeAttributeString("w:type","paragraph"),i.writeAttributeString("w:customStyle","1"),i.writeAttributeString("w:styleId",n.format("Style{0}",e)),i.writeStartElement("w:name"),i.writeAttributeString("w:val",r.name),i.writeEndElement(),i.writeStartElement("w:basedOn"),i.writeAttributeString("w:val","a"),i.writeEndElement(),i.writeStartElement("w:rPr"),i.writeStartElement("w:rFonts"),i.writeAttributeString("w:ascii",r.fontName),i.writeAttributeString("w:hAnsi",r.fontName),i.writeAttributeString("w:cs",r.fontName),i.writeEndElement(),r.bold&&(i.writeStartElement("w:b"),i.writeEndElement()),r.italic&&(i.writeStartElement("w:i"),i.writeEndElement()),r.underline&&(i.writeStartElement("w:u"),i.writeAttributeString("w:val","single"),i.writeEndElement()),i.writeStartElement("w:color"),i.writeAttributeString("w:val",this.getColorString(r.textColor)),i.writeEndElement(),i.writeStartElement("w:sz"),i.writeAttributeString("w:val",n.format("{0}",r.fontSize)),i.writeEndElement(),0!=t["StiOptions"].Export.Word.spaceBetweenCharacters&&(i.writeStartElement("w:spacing"),i.writeAttributeString("w:val",n.format("{0}",t["StiOptions"].Export.Word.spaceBetweenCharacters)),i.writeEndElement()),r.rightToLeft&&(r.bold&&(i.writeStartElement("w:bCs"),i.writeEndElement()),r.italic&&(i.writeStartElement("w:iCs"),i.writeEndElement()),i.writeStartElement("w:szCs"),i.writeAttributeString("w:val",n.format("{0}",r.fontSize)),i.writeEndElement(),i.writeStartElement("w:rtl"),i.writeEndElement()),i.writeEndElement(),i.writeEndElement()}return i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeImage(t){let e=new m,i=this.imageCache.imagePackedStore[t];return null!=i&&e.write(i,0,i.length),e}writeAdditionalData(e,i){let r=new m,n=null;return n=i?t.System.Convert.fromBase64String(e):o.ASCII.getBytes(e),r.write(n,0,n.length),r}exportWord(r,s,o){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Word 2007 format"),null==o)throw new Error("The 'settings' argument cannot be equal in null.");let a=o.pageRange;this.usePageHeadersAndFooters=o.usePageHeadersAndFooters,this._removeEmptySpaceAtBottom=o.removeEmptySpaceAtBottom,this.imageResolution=o.imageResolution,this.imageQuality=o.imageQuality,this.docCompanyString=o.companyString,this.docLastModifiedString=o.lastModifiedString,this.restrictEditing=o.restrictEditing,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,1!=t["StiOptions"].Export.Word.lineSpacing&&(this.lineSpace=Math.round2(240*t["StiOptions"].Export.Word.lineSpacing).toString(),this.lineSpace2=Math.round2(.772*t["StiOptions"].Export.Word.lineSpacing*240).toString()),t["StiOptions"].Export.Word.restrictEditing>this.restrictEditing&&(this.restrictEditing=t["StiOptions"].Export.Word.restrictEditing),this.report=r;try{this.styleList=[],this.fontList=new T,this.imageCache=new e.StiImageCache(t["StiOptions"].Export.Word.allowImageComparer,!0,e.ImageFormat.Jpeg,this.imageQuality,!1),this.bookmarkList=new T,this.hyperlinkList=new T,this.embedsList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(t["StiOptions"].Export.Word.divideSegmentPages?1:0);let o=!1,m=a.getSelectedPages(r.renderedPages);if(t["StiOptions"].Export.Word.divideSegmentPages){let t=!0;if(this.usePageHeadersAndFooters&&m.count>0&&m.getByIndex(0).unlimitedHeight&&1==m.getByIndex(0).segmentPerWidth&&(t=!1),t){let t=i.StiSegmentPagesDivider.divide(m,this);m!=t&&(o=!0),m=t,this.currentPassNumber++}}let c=new l;if(c.begin(s,!0),this.usePageHeadersAndFooters&&(this.headersData=[],this.headersRels=[],this.footersData=[],this.footersRels=[]),c.addFile("word/document.xml",this.writeDocument(m,r,o),!0),this.usePageHeadersAndFooters)for(let t=0;t<this.headersData.length;t++)c.addFile(n.format("word/header{0}.xml",t+1),this.headersData[t]),null!=this.headersRels[t]&&c.addFile(n.format("word/_rels/header{0}.xml.rels",t+1),this.headersRels[t]),c.addFile(n.format("word/footer{0}.xml",t+1),this.footersData[t]),null!=this.footersRels[t]&&c.addFile(n.format("word/_rels/footer{0}.xml.rels",t+1),this.footersRels[t]);if(this.usePageHeadersAndFooters&&(c.addFile("word/footnotes.xml",this.writeFootNotes()),c.addFile("word/endnotes.xml",this.writeEndNotes())),c.addFile("[Content_Types].xml",this.writeContentTypes()),c.addFile("_rels/.rels",this.writeMainRels()),c.addFile("docProps/app.xml",this.writeDocPropsApp()),c.addFile("docProps/core.xml",this.writeDocPropsCore()),c.addFile("word/settings.xml",this.writeSettings()),c.addFile("word/webSettings.xml",this.writeWebSettings()),c.addFile("word/fontTable.xml",this.writeFontTable()),c.addFile("word/_rels/document.xml.rels",this.writeDocumentRels()),c.addFile("word/styles.xml",this.writeStyles()),this.imageCache.imagePackedStore.length>0)for(let t=0;t<this.imageCache.imagePackedStore.length;t++)c.addFile(n.format("word/media/image{0:D5}.jpeg",t+1),this.writeImage(t));t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||this.usePageHeadersAndFooters||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion||(c.addFile("word/footnotes.xml",this.writeFootNotes()),c.addFile("word/endnotes.xml",this.writeEndNotes()),c.addFile("word/media/imageAdditional.png",this.writeAdditionalData(i.StiExportUtils.additionalData,!0)),c.addFile("word/headerAdditional.xml",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<w:hdr xmlns:ve="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" '+'xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math" xmlns:v="urn:schemas-microsoft-com:vml" '+'xmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main" '+'xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml"><w:p><w:pPr><w:pStyle w:val="a3"/></w:pPr><w:r><w:rPr><w:noProof/><w:lang w:eastAsia="ru-RU"/></w:rPr><w:pict>'+'<v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"> <v:stroke joinstyle="miter"/> <v:formulas>'+'<v:f eqn="if lineDrawn pixelLineWidth 0"/><v:f eqn="sum @0 1 0"/><v:f eqn="sum 0 0 @1"/><v:f eqn="prod @2 1 2"/><v:f eqn="prod @3 21600 pixelWidth"/><v:f eqn="prod @3 21600 pixelHeight"/><v:f eqn="sum @0 0 1"/>'+'<v:f eqn="prod @6 1 2"/><v:f eqn="prod @7 21600 pixelWidth"/><v:f eqn="sum @8 21600 0"/><v:f eqn="prod @7 21600 pixelHeight"/><v:f eqn="sum @10 21600 0"/></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>'+'<o:lock v:ext="edit" aspectratio="t"/></v:shapetype><v:shape id="WordPictureWatermark11777093" o:spid="_x0000_s2050" type="#_x0000_t75" '+'style="position:absolute;margin-left:0;margin-top:0;width:467.45pt;height:433.85pt;z-index:-251657216;mso-position-horizontal:center;mso-position-horizontal-relative:margin;mso-position-vertical:center;mso-position-vertical-relative:margin" '+'o:allowincell="f"><v:imagedata r:id="rId1" o:title="additional"/></v:shape></w:pict></w:r></w:p></w:hdr>',!1)),c.addFile("word/_rels/headerAdditional.xml.rels",this.writeAdditionalData('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" Target="media/imageAdditional.png" /></Relationships>',!1))),c.end()}finally{null!=this.matrix&&(this.matrix.clear(),this._matrix=null),this.fontList.clear(),this.fontList=null,this.imageCache.clear(),this.imageCache=null,this.styleList.stimulsoft.clear(),this.styleList=null,this.bookmarkList.clear(),this.bookmarkList=null,this.hyperlinkList.clear(),this.hyperlinkList=null,this.embedsList.stimulsoft.clear(),this.embedsList=null,this.usePageHeadersAndFooters&&(this.headersData.stimulsoft.clear(),this.headersData=null,this.headersRels.stimulsoft.clear(),this.headersRels=null,this.footersData.stimulsoft.clear(),this.footersData=null,this.footersRels.stimulsoft.clear(),this.footersRels=null),r.renderedPages.cacheMode&&i.StiMatrix.GCCollect()}}}i.StiWord2007ExportService=k}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.Base.Drawing.StiColorUtils,n=t.Report.Components.StiDataBarIndicator,s=t.Report.Components.StiIconSetHelper,o=t.Report.Components.StiIcon,a=t.Report.Components.StiIconSetIndicator,l=t.System.StiArray,m=t.Report.Components.StiBookmarksCollection,c=t.Report.Components.StiBookmark,g=t.System.Char,h=t.Base.Drawing.StiHtmlTag,p=t.Report.Components.StiImageRotation,w=t.System.StiString,S=t.Report.Dashboard.StiDashboardExport,d=t.Report.Dashboard.IStiDashboard,u=t.System.Drawing.Color,f=t.System.IO.MemoryStream,E=t.Report.Components.StiContainer,v=t.Base.Drawing.StiBrush,b=t.Base.Drawing.StiGradientBrush,y=t.Base.Drawing.StiGlareBrush,x=t.Base.Drawing.StiHatchBrush,A=t.Base.Drawing.StiGlassBrush,T=t.System.Collections.Hashtable,P=t.System.Text.StringBuilder,L=t.Report.Components.StiText,C=t.Report.Components.StiShape,F=t.Report.Components.StiRectanglePrimitive,R=t.Report.Components.IStiFont,B=t.Report.Components.IStiBrush,I=t.Report.Components.IStiTextBrush,k=t.Report.Components.IStiTextOptions,D=t.Report.Components.IStiBorder,N=t.System.Xml.XmlTextWriter,H=t.System.DateTime,O=t.Report.Chart.IStiChart,M=t.Report.Components.StiImage,U=t.System.Drawing.Rectangle,X=t.Base.Drawing.StiHorAlignment,W=t.Base.Drawing.StiVertAlignment,z=t.Report.Components.IStiExportImageExtended,j=t.Report.Components.StiCheckBox,Y=t.Report.BarCodes.StiBarCode,G=t.Report.Components.IStiTextHorAlignment;class V{constructor(t){this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Component=null,this.service=null,this.service=t}get Right(){return this.X+this.Width}get Top(){return this.Y+this.Height}}i.StiPdfData=V;class _{}i.StiImageData=_;class q{}i.StiShadingData=q;class K{}i.StiShadingFunctionData=K;class Q{}i.StiEditableObject=Q;class J{}class Z{}class $ extends i.StiExportService{constructor(){super(...arguments),this.imageQuality=.75,this.imageResolutionMain=1,this.imageResolutionMode=i.StiImageResolutionMode.Auto,this.sw=null,this.pageStream=null,this.imageList=null,this.imageCache=null,this.imageInterpolationTable=null,this.imageCacheIndexToList=null,this.imageInfoList=null,this.imageInfoCounter=0,this.colorTable=l.create(String,256),this.alphaTable=l.create(Boolean,256),this.pdfFont=null,this.bidi=null,this.standardPdfFonts=!0,this.embeddedFonts=!1,this.useUnicodeMode=!1,this.reduceFontSize=!0,this.compressed=!1,this.compressedFonts=!1,this.encrypted=!1,this.usePdfA=!1,this.pdfComplianceMode=i.StiPdfComplianceMode.None,this.exportRtfTextAsImage=!1,this.autoPrint=i.StiPdfAutoPrintMode.None,this.imageCompressionMethod=i.StiPdfImageCompressionMethod.Jpeg,this.imageFormat=i.StiImageFormat.Color,this.monochromeDitheringType=i.StiMonochromeDitheringType.FloydSteinberg,this.allowEditable=i.StiPdfAllowEditable.No,this.useTransparency=!0,this.fontGlyphsReduceNotNeed=null,this.bookmarksTree=null,this.bookmarksTreeTemp=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.shadingArray=null,this.hatchArray=null,this.shadingFunctionArray=null,this.haveBookmarks=!1,this.haveLinks=!1,this.haveAnnots=!1,this.haveTooltips=!1,this.CodePage1252part80AF=[8364,8226,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,8226,381,8226,8226,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,8226,382,376],this.CodePage1252=l.create(Number,256),this.hiToTwips=.72,this.precision_digits_font=3,this.pdfCKT=.55228,this.IDValue=null,this.IDValueString="",this.IDValueStringMeta="",this.currentDateTime="",this.currentDateTimeMeta="",this.producerName="Stimulsoft Reports",this.creatorName="",this.keywords="",this.keyLength=i.StiPdfEncryptionKeyLength.Bit40,this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=null,this.info=null,this.haveDigitalSignature=!1,this.pdfSecurity=null,this.printScaling=!0,this.colorHash1=new T,this.colorHash2=new T,this._gsTable=null}implements(){return[i.IStiPdfExportService]}get exportFormat(){return e.StiExportFormat.Pdf}exportTo(t,e,i){this.exportPdf1(t,e,i)}exportToAsync(e,r,n,s){let o=s.imageCompressionMethod==i.StiPdfImageCompressionMethod.Flate;t.Report.Export.StiExportImageHelper.convertAllImages(r,t.System.Drawing.Imaging.ImageFormat.Jpeg,o).try(()=>{if(!r.isDocument&&r.getCurrentPage().is(d))return void S.exportAsync(r,n,s).try(()=>e());this.exportTo(r,n,s),null!=r&&null!=r.preparedExportImages&&(r.preparedExportImages.clear(),r.preparedExportImages=null),e()})}get multipleFiles(){return!1}stringReplace(t,e,i){e=e.replace($.regexEscape,"\\$1");let r=new RegExp(e,"g");return t.replace(r,i)}getHatchNumber(t){if(this.hatchArray.length>0)for(let e=0;e<this.hatchArray.length;e++){let i=this.hatchArray[e];if(t.style==i.style&&t.backColor==i.backColor&&t.foreColor==i.foreColor)return e}return this.hatchArray.push(t),this.hatchArray.length-1}getShadingFunctionNumber(t,e,i){if(this.shadingFunctionArray.length>0)for(let r=0;r<this.shadingFunctionArray.length;r++){let n=this.shadingFunctionArray[r];if(n.Color1.equals(t)&&n.Color2.equals(e)&&n.IsGlare==i)return r}let r=new K;return r.Color1=t,r.Color2=e,r.IsGlare=i,this.shadingFunctionArray.push(r),this.shadingFunctionArray.length-1}addXref(t){let e=this.sw.position;this.xref[t]=e.toString().stimulsoft.padLeft(10,"0")+" 00000 n",this.currentObjectNumber=t,this.currentGenerationNumber=0}convertToString(e,i=2){let r;return Math.round2(e,i).toString().split(",").join(t.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)}static convertToEscapeSequence(t){let e=[40,41,92,13,10,8,12],i="()\\rnbf",r,n;if(null==t)return"";n=new P;for(let s=0;s<t.length;s++){r=!1;for(let o=0;o<e.length;o++)if(t.charCodeAt(s)==e[o]){n.append("\\"+i[o]),r=!0;break}r||n.append(t.charAt(s))}return n.toString()}static convertToEscapeSequencePlusTabs(t){let e=[40,41,92,13,10,9,8,12],i="()\\rntbf",r,n;if(null==t)return"";n="";for(let s=0;s<t.length;s++){r=!1;for(let o=0;o<e.length;o++)if(t.charCodeAt(s)==e[o]){n+="\\"+i[o],r=!0;break}r||(n+=t.charAt(s))}return n}setStrokeColor(e){let i=this.colorHash1.get(e);null==i&&(i=w.format("{0} {1} {2} RG",this.colorTable[e.r],this.colorTable[e.g],this.colorTable[e.b]),this.colorHash1.set(e,i)),this.pageStream.writeLine(i);let r=e.a;r!=this.lastColorStrokeA&&t["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[r][0]),this.lastColorStrokeA=r,this.alphaTable[r]=!0)}setNonStrokeColor(e){let i=this.colorHash2.get(e);null==i&&(i=w.format("{0} {1} {2} rg",this.colorTable[e.r],this.colorTable[e.g],this.colorTable[e.b]),this.colorHash2.set(e,i)),this.pageStream.writeLine(i);let r=e.a;r!=this.lastColorNonStrokeA&&t["StiOptions"].Export.Pdf.allowExtGState&&!this.usePdfA&&(this.pageStream.writeLine(this.gsTable[r][1]),this.lastColorNonStrokeA=r,this.alphaTable[r]=!0)}get gsTable(){if(null==this._gsTable){this._gsTable=l.create2(String,256,2);for(let t=0;t<256;t++)this._gsTable[t][0]=w.format("/GS{0:X2}S gs",t),this._gsTable[t][1]=w.format("/GS{0:X2}N gs",t)}return this._gsTable}pushColorToStack(){this.colorStack.push(this.lastColorStrokeA),this.colorStack.push(this.lastColorNonStrokeA)}popColorFromStack(){this.lastColorNonStrokeA=this.colorStack.pop(),this.lastColorStrokeA=this.colorStack.pop()}fillRectBrush(t,e){let i=v.toColor(t);if(this.setNonStrokeColor(i),this.storeShadingData2(e.x,e.y,e.width,e.height,t),(t.stimulsoft.is(b)||t.stimulsoft.is(y))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+this.shadingCurrent),t.stimulsoft.is(x)){let e=t.stimulsoft.as(x);this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.getHatchNumber(e)+1)}if(t.stimulsoft.is(A)){let r=t.stimulsoft.as(A);this.setNonStrokeColor(r.getTopColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y+e.height/2),this.convertToString(e.width),this.convertToString(e.height/2)),this.setNonStrokeColor(r.getBottomColor()),this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height/2)),i=u.transparent}0!=i.a&&this.pageStream.writeLine1("{0} {1} {2} {3} re f",this.convertToString(e.x),this.convertToString(e.y),this.convertToString(e.width),this.convertToString(e.height))}storeStringLine(t,e,i=!1){let r=t+this.convertToHexString(e,i);this.storeString(r),this.sw.writeLine()}storeString(t){this.sw.writeString(t,!1)}convertToHexString(t,e){let i="";if(w.isNullOrEmpty(t))if(this.encrypted){let t=this.pdfSecurity.encryptData([],this.currentObjectNumber,this.currentGenerationNumber),e="";for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);i+="("+$.convertToEscapeSequencePlusTabs(e)+")"}else i+="()";else{let r=!1;for(let e=0;e<t.length;e++)t.charCodeAt(e)>127&&(r=!0);if(this.encrypted){let e=null;if(1==r){e=[];for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);e[2+2*i+0]=r>>8&255,e[2+2*i+1]=255&r}e[0]=254,e[1]=255}else{e=[];for(let i=0;i<t.length;i++)e[i]=t.charCodeAt(i)}let n=this.pdfSecurity.encryptData(e,this.currentObjectNumber,this.currentGenerationNumber),s="";for(let t=0;t<n.length;t++)s+=String.fromCharCode(n[t]);i+="("+$.convertToEscapeSequencePlusTabs(s)+")"}else if(1==r){i+="<FEFF";for(let e=0;e<t.length;e++)i+=w.format("{0:X4}",t.charCodeAt(e));i+=">"}else i+=e?"("+$.convertToEscapeSequencePlusTabs(t)+")":"("+t+")"}return i}storeMemoryStream2(t,e){if(this.encrypted){let i=this.pdfSecurity.encryptData(t.toArray(),this.currentObjectNumber,this.currentGenerationNumber);this.sw.writeLine1(w.format(e,i.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),this.sw.write(i,0,i.length)}else this.sw.writeLine1(w.format(e,t.length)),this.sw.writeLine(">>"),this.sw.writeLine("stream"),t.writeTo(this.sw);t.close()}storeMemoryStream3(t,e){let i=new f;for(let e=0;e<t.length;e++)i.writeByte(t[e]);this.storeMemoryStream2(i,e),i.close()}storeMemoryStream4(t,e){let i=new f;for(let e=0;e<t.length;e++)i.writeByte(t[e]);this.storeMemoryStream2(i,e),i.close()}renderStartDoc(r,n){this.sw.writeLine(this.keyLength==i.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==i.StiPdfEncryptionKeyLength.Bit256_r6?"%PDF-1.7":"%PDF-1.4"),this.sw.write([37,226,227,207,211],0,5),this.sw.writeLine(),this.addXref(1),this.sw.writeLine("1 0 obj"),this.sw.writeLine("<<"),this.keyLength==i.StiPdfEncryptionKeyLength.Bit256_r5&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 3>>>>"),this.keyLength==i.StiPdfEncryptionKeyLength.Bit256_r6&&this.sw.writeLine("/Extensions<</ADBE<</BaseVersion/1.7/ExtensionLevel 8>>>>"),this.sw.writeLine("/Type /Catalog"),this.sw.writeLine1("/Pages {0} 0 R",this.info.pages.ref),this.sw.writeLine("/MarkInfo<</Marked true>>"),this.sw.writeLine1("/Metadata {0} 0 R",this.info.metadata.ref),this.sw.writeLine1("/OutputIntents {0} 0 R",this.info.outputIntents.ref),this.sw.writeLine1("/StructTreeRoot {0} 0 R",this.info.structTreeRoot.ref),this.haveBookmarks?(this.sw.writeLine1("/Outlines {0} 0 R",this.info.outlines.ref),this.sw.writeLine("/PageMode /UseOutlines")):this.sw.writeLine("/PageMode /UseNone"),this.printScaling||(this.sw.writeLine("/ViewerPreferences"),this.sw.writeLine("<<"),this.sw.writeLine("/PrintScaling /None"),this.sw.writeLine(">>")),(this.haveAnnots||this.haveDigitalSignature)&&this.sw.writeLine1("/AcroForm {0} 0 R",this.info.acroForm.ref),this.autoPrint!=i.StiPdfAutoPrintMode.None&&this.sw.writeLine1("/Names <</JavaScript {0} 0 R>>",this.info.embeddedJS.ref),this.usePdfA||this.sw.writeLine1("/OCProperties << /OCGs [{0} 0 R] /D << /ON [{0} 0 R] /AS [<</Event /Print /OCGs [{0} 0 R] /Category [/Print]>>] >> >>",this.info.optionalContentGroup.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(2),this.sw.writeLine("2 0 obj"),this.sw.writeLine("<<"),this.storeStringLine("/Producer ",this.producerName,!0),this.storeStringLine("/Creator ",this.creatorName,!0),w.isNullOrEmpty(r.reportAuthor)||this.storeStringLine("/Author ",r.reportAuthor,!0),w.isNullOrEmpty(r.reportAlias)||this.storeStringLine("/Subject ",r.reportAlias,!0),w.isNullOrEmpty(r.reportName)||this.storeStringLine("/Title ",r.reportName,!0),w.isNullOrEmpty(this.keywords)||this.storeStringLine("/Keywords ",this.keywords,!0),this.storeStringLine("/CreationDate ","D:"+this.currentDateTime),this.storeStringLine("/ModDate ","D:"+this.currentDateTime);for(let t of r.metaTags.list)t.name.stimulsoft.startsWith("pdf:")&&this.storeStringLine(w.format("/{0} ",e.StiNameValidator.correctName(t.name.substr(4),!1)),t.tag);this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(3),this.sw.writeLine("3 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Cs1 [/Pattern /DeviceRGB]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.pages.ref),this.sw.writeLine1("{0} 0 obj",this.info.pages.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pages"),this.sw.writeString("/Kids [ ");for(let t=0;t<n.count;t++)this.sw.writeString(w.format("{0} 0 R ",this.info.pageList[t].ref));if(this.sw.writeLine("]"),this.sw.writeLine1("/Count {0}",n.count),t["StiOptions"].Export.Pdf.allowInheritedPageResources){let e=[];e.push("/Resources"),e.push("<<"),e.push("/ProcSet [/PDF /Text /ImageC]"),e.push("/Font"),e.push("<<");for(let t=0;t<this.fontsCounter;t++)e.push(w.format("/F{0} {1} 0 R",t,this.info.fontList[t].ref));if(e.push(">>"),this.imageCache.imageStore.length>0){e.push("/XObject"),e.push("<<");for(let t=0;t<this.imageCache.imageStore.length;t++)e.push(w.format("/Image{0} {1} 0 R",t,this.info.xObjectList[t].ref));e.push(">>")}e.push("/Pattern"),e.push("<<"),e.push(w.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(let t=0;t<this.hatchArray.length;t++)e.push(w.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)e.push(w.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));e.push(">>"),e.push("/ColorSpace 3 0 R"),t["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&e.push(w.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||e.push(w.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),e.push(">>");for(let t=0;t<e.length;t++)this.sw.writeLine(e[t])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(5),this.sw.writeLine("5 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /StructTreeRoot"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(6),this.sw.writeLine("6 0 obj"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /OCG"),this.sw.writeLine("/Name (Printable off)"),this.sw.writeLine("/Usage <<"),this.sw.writeLine("/Print << /PrintState /OFF >>"),this.sw.writeLine("/View << /ViewState /ON >>"),this.sw.writeLine(">>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(let e=0;e<n.count;e++){this.addXref(this.info.pageList[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Page"),this.sw.writeLine("/Parent 4 0 R");let i=n.getByIndex(e),s=this.hiToTwips*r.unit.convertToHInches(i.pageHeight*i.segmentPerHeight),o=this.hiToTwips*r.unit.convertToHInches(i.pageWidth*i.segmentPerWidth);if(s>14400&&(s=14400),o>14400&&(o=14400),this.sw.writeLine1("/MediaBox [ 0 0 {0} {1} ]",this.convertToString(o),this.convertToString(s)),!t["StiOptions"].Export.Pdf.allowInheritedPageResources){let i=[];i.push("/Resources"),i.push("<<"),i.push("/ProcSet [/PDF /Text /ImageC]"),i.push("/Font"),i.push("<<");for(let t=0;t<this.fontsCounter;t++)i.push(w.format("/F{0} {1} 0 R",t,this.info.fontList[t].ref));if(i.push(">>"),this.imageCache.imageStore.length>0){i.push("/XObject"),i.push("<<");for(let t=0;t<this.imageCache.imageStore.length;t++)i.push(w.format("/Image{0} {1} 0 R",t,this.info.xObjectList[t].ref));i.push(">>")}let r=new P;r.append(w.format("/P1 {0} 0 R",this.info.patterns.first.ref));for(let t=0;t<this.hatchArray.length;t++)r.append(w.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++){let i;this.shadingArray[t].Page==e&&r.append(w.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref))}i.push("/Pattern << "+r.toString()+" >>"),i.push("/ColorSpace 3 0 R"),t["StiOptions"].Export.Pdf.allowExtGState&&this.useTransparency&&i.push(w.format("/ExtGState {0} 0 R",this.info.extGState.ref)),this.usePdfA||i.push(w.format("/Properties << /oc1 {0} 0 R >>",this.info.optionalContentGroup.ref)),i.push(">>");for(let t=0;t<i.length;t++)this.sw.writeLine(i[t])}if(this.sw.writeLine1("/Contents {0} 0 R",this.info.pageList[e].content.ref),this.usePdfA||(this.sw.writeLine("/Group"),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Group"),this.sw.writeLine("/S /Transparency"),this.sw.writeLine("/CS /DeviceRGB"),this.sw.writeLine(">>")),this.haveLinks||this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){if(this.sw.writeLine("/Annots ["),this.haveLinks)for(let t=0;t<this.linksCounter;t++){let i;this.linksArray[t].Page==e&&this.sw.writeLine1("{0} 0 R ",this.info.linkList[t].ref)}if(this.haveAnnots){for(let t=0;t<this.annotsCounter;t++){let i;this.annotsArray[t].Page==e&&this.sw.writeLine1("{0} 0 R ",this.info.acroForm.annots[t].ref)}for(let t=0;t<this.annots2Counter;t++){let i;if(this.annots2Array[t].Page==e)for(let e=0;e<this.info.acroForm.checkBoxes[t].items.length;e++)this.sw.writeLine1("{0} 0 R ",this.info.acroForm.checkBoxes[t].items[e].ref)}}this.sw.writeLine("]")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderEndDoc(){let e=this.sw.position;this.sw.writeLine("xref"),this.sw.writeLine1("0 {0}",this.xref.stimulsoft.countItems+1),this.sw.writeLine("0000000000 65535 f");for(let t=0;t<this.xref.stimulsoft.countItems;t++)this.sw.writeLine(this.xref[t+1]);this.sw.writeLine("trailer"),this.sw.writeLine("<<"),this.sw.writeLine1("/Size {0}",this.xref.stimulsoft.countItems+1),this.sw.writeLine("/Root 1 0 R"),this.sw.writeLine("/Info 2 0 R"),this.encrypted&&this.sw.writeLine1("/Encrypt {0} 0 R",this.info.encode.ref),this.sw.writeLine1("/ID[<{0}><{0}>]",this.IDValueString),this.sw.writeLine(">>"),this.sw.writeLine("%"+i.StiExportUtils.getReportVersion()),this.sw.writeLine("%"+t.StiVersion.platform()),this.sw.writeLine("startxref"),this.sw.writeLine1("{0}",e),this.sw.writeLine("%%EOF")}renderPageHeader(t){this.addXref(this.info.pageList[t].content.ref),this.sw.writeLine1("{0} 0 obj",this.info.pageList[t].content.ref),this.sw.writeLine("<<"),this.pageStream=new f,this.pageStream.writeLine("2 J")}renderPageFooter(e,r){if(!(t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion)){let t=r/596*1.4,i=e/840*1.4;t>i?t=i:i=t,this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine("1 J 1 j 20 w"),this.setStrokeColor(u.fromArgb(64,100,100,100)),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm 0.707 0.707 -0.707 0.707 0 0 cm 1 0 0 1 -155 -50 cm",this.convertToString(t),this.convertToString(i),this.convertToString(r/2),this.convertToString(e/2)),this.pageStream.writeLine("40 0 m 40 100 l 0 100 m 80 100 l S"),this.pageStream.writeLine("100 0 m 100 70 l 100 45 m 120 65 l 130 72 l 140 68 l S"),this.pageStream.writeLine("170 0 m 170 70 l 169 100 m 171 100 l S"),this.pageStream.writeLine("215 60 m 222 69 l 232 71 l 255 70 l 265 60 l 265 5 l 270 0 l 265 44 m 220 31 l 212 20 l 212 10 l 225 0 l 235 0 l 250 5 l 265 18 l S"),this.pageStream.writeLine("310 0 m 310 100 l S"),this.pageStream.writeLine("Q"),this.popColorFromStack()}if(this.pageStream.position<this.pageStream.length&&this.pageStream.setLength(this.pageStream.position),1==this.compressed){let t=this.pageStream.toArray(),e=i.StiExportUtils.makePdfDeflateStream(t);this.storeMemoryStream2(e,"/Filter [/FlateDecode] /Length {0}")}else this.storeMemoryStream2(this.pageStream,"/Filter [] /Length {0}");this.sw.writeLine(),this.pageStream.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderFontTable(){for(let e=0;e<this.fontsCounter;e++){let r=new P;this.pdfFont.currentFont=e;let n=this.pdfFont.fontList[e],s=n.Name;t["StiOptions"].Export.Pdf.useAlternativeFontNames&&t["StiOptions"].Export.Pdf.alternativeFontNames.containsKey(s)&&(s=t["StiOptions"].Export.Pdf.alternativeFontNames.get(s));let o=this.embeddedFonts||i.PdfFonts.isFontStimulsoft(n.Name);if(this.pdfFont.UseUnicode){r=new P(s.stimulsoft.replaceAll(" ","#20")),(n.Bold||n.Italic)&&(r.append(","),n.Bold&&r.append("Bold"),n.Italic&&r.append("Italic")),o&&r.insert(0,w.format("SR{0}{1}{2}{3}+",String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65),String.fromCharCode(24*Math.random()+65))),this.addXref(this.info.fontList[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /Type0"),this.sw.writeLine1("/BaseFont /{0}",r),this.sw.writeLine1("/DescendantFonts [{0} 0 R]",this.info.fontList[e].descendantFont.ref),this.sw.writeLine("/Encoding /Identity-H"),this.sw.writeLine1("/ToUnicode {0} 0 R",this.info.fontList[e].toUnicode.ref),this.sw.writeLine1("/Name /F{0}",e),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].descendantFont.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].descendantFont.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /CIDFontType2"),this.sw.writeLine1("/BaseFont /{0}",r),this.sw.writeLine("/CIDSystemInfo"),this.sw.writeLine("<<"),this.storeStringLine("/Registry","Adobe"),this.storeStringLine("/Ordering","Identity"),this.sw.writeLine("/Supplement 0"),this.sw.writeLine(">>"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[e].fontDescriptor.ref),this.usePdfA&&this.sw.writeLine("/CIDToGIDMap /Identity"),this.sw.writeLine("/W [0 [1000]");let t=this.pdfFont.GlyphList,a=t.length,m=l.create(Number,a),c=l.create(Number,a);for(let e=32;e<a;e++)m[e]=t[e],c[e]=e;for(let t=32;t<m.length-1;t++)for(let e=t+1;e<m.length;e++)if(m[t]>m[e]){let i=m[t];m[t]=m[e],m[e]=i;let r=c[t];c[t]=c[e],c[e]=r}let g=new P,h=32;while(h<this.pdfFont.MappedSymbolsCount){g.append(m[h].toString()+" ["),g.append(this.pdfFont.Widths[c[h]-32].toString()),h++;while(h<this.pdfFont.MappedSymbolsCount&&m[h]-1==m[h-1])g.append(" "+this.pdfFont.Widths[c[h]-32].toString()),h++;while(h<this.pdfFont.MappedSymbolsCount&&m[h]==m[h-1])h++;g.append("]"),this.sw.writeLine1("{0}",g),g=new P}null!=this.pdfFont.GlyphWidths&&this.pdfFont.GlyphWidths[65535],this.sw.writeLine("]"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].toUnicode.ref);let p="SR+F"+e.toString();this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].toUnicode.ref),this.sw.writeLine("<<");let S=new f;S.writeLine("/CIDInit /ProcSet findresource begin"),S.writeLine("12 dict begin"),S.writeLine("begincmap"),S.writeLine("/CIDSystemInfo"),S.writeLine("<<"),S.writeLine("/Registry (Adobe)"),S.writeLine1("/Ordering ({0})",p),S.writeLine("/Supplement 0"),S.writeLine(">> def"),S.writeLine1("/CMapName /{0} def",p),S.writeLine("/CMapType 2 def"),S.writeLine("1 begincodespacerange"),S.writeLine("<0000> <FFFF>"),S.writeLine("endcodespacerange");let d=this.pdfFont.MappedSymbolsCount-32,u=32;while(d>0){let t=d;t>100&&(t=100),S.writeLine1("{0} beginbfchar",t);for(let e=0;e<t;e++)S.writeLine1("<{0:X4}> <{1:X4}>",this.pdfFont.GlyphList[u],this.pdfFont.UnicodeMapBack[u]),u++;S.writeLine("endbfchar"),d-=t}S.writeLine("endcmap"),S.writeLine("CMapName currentdict /CMap defineresource pop"),S.writeLine("end"),S.writeLine("end"),S.flush();let E=S.toArray();if(S.close(),1==this.compressed){let t=i.StiExportUtils.makePdfDeflateStream(E);this.storeMemoryStream2(t,"/Length {0} /Filter [/FlateDecode] /Length1 "+E.length.toString())}else this.storeMemoryStream4(E,"/Length {0} /Filter [] /Length1 {0}");this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].cIDSet.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].cIDSet.ref),this.sw.writeLine("<<");let v=l.create(Boolean,65536+32),b=0;for(let t=0;t<this.pdfFont.GlyphList.length;t++){let e=this.pdfFont.GlyphList[t];65535!=e&&(v[e]=!0,e>b&&(b=e))}if(null!=this.pdfFont.GlyphWidths&&0!=this.pdfFont.GlyphWidths[65535])for(let t=0;t<65535;t++)this.pdfFont.GlyphWidths[t]>0&&0==this.pdfFont.GlyphBackList[t]&&(v[t]=!0,t>b&&(b=t));let y=Math.trunc(b/8)+1,x=l.create(Number,y+1),A=0;while(A<y){let t=8*A,e=0;v[t]&&(e|=128),v[t+1]&&(e|=64),v[t+2]&&(e|=32),v[t+3]&&(e|=16),v[t+4]&&(e|=8),v[t+5]&&(e|=4),v[t+6]&&(e|=2),v[t+7]&&(e|=1),x[A]=e,A++}if(1==this.compressed){let t=i.StiExportUtils.makePdfDeflateStream(x);this.storeMemoryStream2(t,"/Length {0} /Filter [/FlateDecode] /Length1 "+x.length.toString())}else this.storeMemoryStream4(x,"/Length {0} /Filter [] /Length1 "+x.length.toString());this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}else{this.addXref(this.info.fontList[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),1==this.standardPdfFonts?(this.sw.writeLine("/Subtype /Type1"),this.sw.writeLine1("/BaseFont /{0}",n.PdfName)):(this.sw.writeLine("/Subtype /TrueType"),r=new P(this.stringReplace(s," ","#20")),1!=n.Bold&&1!=n.Italic||(r.append(","),1==n.Bold&&r.append("Bold"),1==n.Italic&&r.append("Italic")),this.sw.writeLine1("/BaseFont /{0}",r),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.fontList[e].fontDescriptor.ref)),this.sw.writeLine1("/Encoding {0} 0 R",this.info.fontList[e].encoding.ref);let t=new P(" ");for(let e=32;e<this.pdfFont.MappedSymbolsCount;e++)t.append(this.pdfFont.Widths[e-32].toString()+" ");if(this.sw.writeLine1("/FirstChar {0}",32),this.sw.writeLine1("/LastChar {0}",this.pdfFont.MappedSymbolsCount-1),this.sw.writeLine1("/Widths [{0}]",t),this.sw.writeLine1("/Name /F{0}",e),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.fontList[e].encoding.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].encoding.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Encoding"),this.sw.writeLine("/BaseEncoding /WinAnsiEncoding"),this.pdfFont.MappedSymbolsCount>this.pdfFont.firstMappedSymbol){let t=new P(this.pdfFont.firstMappedSymbol.toString()+" ");for(let e=this.pdfFont.firstMappedSymbol;e<this.pdfFont.MappedSymbolsCount;e++)t.append("/"+this.pdfFont.CharPdfNames[e]);this.sw.writeLine1("/Differences [{0}]",t)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}let a=null;if(o&&(a=this.pdfFont.getFontDataBuf(n.Font,this.report)),0==this.standardPdfFonts){this.addXref(this.info.fontList[e].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",r),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",this.pdfFont.LLX,this.pdfFont.LLY,this.pdfFont.URX,this.pdfFont.URY),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),o&&null!=a&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[-1==n.ParentFontNumber?e:n.ParentFontNumber].fontFile2.ref);let t=this.pdfFont.UseUnicode;this.pdfComplianceMode!=i.StiPdfComplianceMode.A2&&this.pdfComplianceMode!=i.StiPdfComplianceMode.A3||(t=!1),t&&this.sw.writeLine1("/CIDSet {0} 0 R",this.info.fontList[e].cIDSet.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}if(o)if(null!=a&&a.length>0&&-1==n.ParentFontNumber){if(this.reduceFontSize){let t=this.pdfFont.reduceFontSize(a,n.Name,!this.fontGlyphsReduceNotNeed[e]);null!=t&&(a=t)}if(this.addXref(this.info.fontList[e].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].fontFile2.ref),this.sw.writeLine("<<"),1==this.compressedFonts){if(a.stimulsoft.is(Uint8Array)){let t=i.StiExportUtils.makePdfDeflateStream(a);this.storeMemoryStream2(t,"/Length {0} /Filter [/FlateDecode] /Length1 "+a.length.toString())}if(a.stimulsoft.is(f)){let t=a.toArray(),e=i.StiExportUtils.makePdfDeflateStream(t);this.storeMemoryStream2(e,"/Length {0} /Filter [/FlateDecode] /Length1 "+a.length.toString())}}else a.stimulsoft.is(Uint8Array)&&this.storeMemoryStream3(a,"/Length {0} /Filter [] /Length1 "+a.length.toString()),a.stimulsoft.is(f)&&this.storeMemoryStream2(a,"/Length {0} /Filter [] /Length1 "+a.length.toString());this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}else this.addXref(this.info.fontList[e].fontFile2.ref),this.sw.writeLine1("{0} 0 obj",this.info.fontList[e].fontFile2.ref),this.sw.writeLine("<< >>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderImageTable(){if(this.imageCache.imageStore.length>0)for(let t=0;t<this.imageCache.imageStore.length;t++){let e=this.imageCacheIndexToList.get(t),r=this.imageCache.imagePackedStore[t],n=this.imageCache.imageMaskStore[t],s=e.ImageFormat;this.addXref(this.info.xObjectList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine1("/ColorSpace /{0}",s==i.StiImageFormat.Monochrome?"DeviceGray":"DeviceRGB"),this.sw.writeLine1("/Width {0}",e.Width),this.sw.writeLine1("/Height {0}",e.Height),this.sw.writeLine1("/BitsPerComponent {0}",s==i.StiImageFormat.Monochrome?"1":"8"),this.imageInterpolationTable.containsKey(t)&&this.sw.writeLine("/Interpolate true"),null!=n&&this.sw.writeLine1("/SMask {0} 0 R",this.info.xObjectList[t].mask.ref),this.sw.writeLine1("/Name /{0}",e.Name);let o="DCTDecode";this.imageCompressionMethod==i.StiPdfImageCompressionMethod.Flate&&(o="FlateDecode"),null==r&&(r=[56,48,56,48,56,48],o="ASCIIHexDecode");let a="/Length {0} "+w.format("/Filter [/{0}]",o),l=new f;if(l.write(r,0,r.length),this.storeMemoryStream2(l,a),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),null!=n){this.addXref(this.info.xObjectList[t].mask.ref),this.sw.writeLine1("{0} 0 obj",this.info.xObjectList[t].mask.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Image"),this.sw.writeLine("/ColorSpace /DeviceGray"),this.sw.writeLine("/Matte [ 0 0 0 ]"),this.sw.writeLine1("/Width {0}",e.Width),this.sw.writeLine1("/Height {0}",e.Height),this.sw.writeLine("/BitsPerComponent 8"),this.imageInterpolationTable.containsKey(t)&&this.sw.writeLine("/Interpolate true");let i="/Length {0} /Filter /FlateDecode",r=new f;r.write(n,0,n.length),this.storeMemoryStream2(r,i),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderBookmarksTable(){if(this.haveBookmarks){this.addXref(this.info.outlines.ref),this.sw.writeLine1("{0} 0 obj",this.info.outlines.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Outlines"),this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[0].ref),this.sw.writeLine1("/Count {0}",1),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("");for(let t=0;t<this.bookmarksCounter;t++){this.addXref(this.info.outlines.items[t].ref);let e=this.bookmarksTree[t];this.sw.writeLine1("{0} 0 obj",this.info.outlines.items[t].ref),this.sw.writeLine("<<"),this.storeStringLine("/Title ",e.Title,!0),-1!=e.Parent&&this.sw.writeLine1("/Parent {0} 0 R",this.info.outlines.items[e.Parent].ref),-1!=e.Prev&&this.sw.writeLine1("/Prev {0} 0 R",this.info.outlines.items[e.Prev].ref),-1!=e.Next&&this.sw.writeLine1("/Next {0} 0 R",this.info.outlines.items[e.Next].ref),-1!=e.First&&this.sw.writeLine1("/First {0} 0 R",this.info.outlines.items[e.First].ref),-1!=e.Last&&this.sw.writeLine1("/Last {0} 0 R",this.info.outlines.items[e.Last].ref),e.Count>0&&(0==t?this.sw.writeLine1("/Count {0}",e.Count):this.sw.writeLine1("/Count {0}",-e.Count)),e.Y>-1&&this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.Page].ref,this.convertToString(e.Y)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}renderPatternTable(){if(this.addXref(this.info.patterns.resources.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.resources.ref),this.sw.writeLine("<< /ProcSet [/PDF] >>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.patterns.first.ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.first.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 2 2]"),this.sw.writeLine("/XStep 3"),this.sw.writeLine("/YStep 3"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.pageStream=new f,this.pageStream.writeLine("1 J 1 j 1 w"),this.pageStream.writeLine("1 0 0 RG"),this.pageStream.writeString("1 1 m 1.1 1.1 l S"),this.storeMemoryStream2(this.pageStream,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.hatchArray.length>0)for(let t=0;t<this.hatchArray.length;t++)this.writeHatchPattern(t);if(this.shadingArray.length>0)for(let t=0;t<this.shadingArray.length;t++)this.writeShadingPattern(t);if(this.shadingFunctionArray.length>0){for(let t=0;t<this.shadingFunctionArray.length;t++)this.writeShadingFunction(t);this.sw.writeLine("")}this.pageStream.close()}writeHatchPattern(t){let e=this.hatchArray[t],r=e.style;r>53&&(r=53),this.addXref(this.info.patterns.hatchItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.hatchItems[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Pattern"),this.sw.writeLine("/PatternType 1"),this.sw.writeLine("/PaintType 1"),this.sw.writeLine("/TilingType 1"),this.sw.writeLine("/BBox [0 0 1 1]"),this.sw.writeLine("/XStep 1"),this.sw.writeLine("/YStep 1"),this.sw.writeLine1("/Resources {0} 0 R",this.info.patterns.resources.ref),this.sw.writeLine("/Matrix [5.5 0 0 5.5 0 0]");let n=new f;0!=e.backColor.a&&(n.writeLine1("{0} {1} {2} rg",this.colorTable[e.backColor.r],this.colorTable[e.backColor.g],this.colorTable[e.backColor.b]),n.writeLine("0 0 1 1 re f")),n.writeLine1("{0} {1} {2} rg",this.colorTable[e.foreColor.r],this.colorTable[e.foreColor.g],this.colorTable[e.foreColor.b]),n.writeLine("BI"),n.writeLine("/W 8"),n.writeLine("/H 8"),n.writeLine("/BPC 1"),n.writeLine("/IM true"),n.writeLine("/D [1 0]"),n.writeLine("/F [/AHx]"),n.writeLine("ID"),n.writeLine(i.StiPdfResources.hatchData[r]+">"),n.writeLine("EI"),n.flush(),this.storeMemoryStream2(n,"/Length {0}"),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}writeShadingPattern(t){let e=this.shadingArray[t],i=1,r=1,n=e.Angle;n<0&&(n+=360),n>=270&&n<360&&(n=360-n,r=-1),n>=180&&n<270&&(n-=180,r=-1,i=-1),n>=90&&n<180&&(n=180-n,i=-1),n=n*Math.PI/180;let s=e.X+e.Width/2,o=e.Y+e.Height/2,a=Math.sqrt(e.Width*e.Width+e.Height*e.Height)/2,l=Math.atan2(e.Height,e.Width),m=Math.PI/2-n+l,c=a*Math.sin(m),g=c*Math.cos(n)*i,h=c*Math.sin(n)*r,p=s-g,S=s+g,d=o+h,u=o-h;this.addXref(this.info.patterns.shadingItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/PatternType 2"),this.sw.writeString("/Shading <<"),this.sw.writeString("/ColorSpace /DeviceRGB"),this.sw.writeString("/ShadingType 2"),this.sw.writeString(w.format("/Coords [{0} {1} {2} {3}]",this.convertToString(p),this.convertToString(d),this.convertToString(S),this.convertToString(u))),this.sw.writeString("/Extend [true true]"),this.sw.writeString(w.format("/Function {0} 0 R",this.info.patterns.shadingFunctionItems[e.FunctionIndex].ref)),this.sw.writeString(">> "),this.sw.writeLine(">>"),this.sw.writeLine("endobj")}writeShadingFunction(t){let e=this.shadingFunctionArray[t];this.addXref(this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.patterns.shadingFunctionItems[t].ref),this.sw.writeString("<<"),this.sw.writeString("/FunctionType 0"),this.sw.writeString("/Size [3]"),this.sw.writeString("/Decode [0 1 0 1 0 1]"),this.sw.writeString("/Range [0 1 0 1 0 1]"),this.sw.writeString("/BitsPerSample 8"),this.sw.writeString("/Domain [0 1]"),this.sw.writeString(w.format("/Encode [0 {0}]",e.IsGlare?2:1)),this.sw.writeString("/Order 1");let i=new f;i.writeByte(e.Color1.r),i.writeByte(e.Color1.g),i.writeByte(e.Color1.b),i.writeByte(e.Color2.r),i.writeByte(e.Color2.g),i.writeByte(e.Color2.b),i.writeByte(e.Color1.r),i.writeByte(e.Color1.g),i.writeByte(e.Color1.b),this.storeMemoryStream2(i,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj")}renderLinkTable(){if(this.haveLinks)for(let t=0;t<this.linksCounter;t++){let e=this.linksArray[t];if(e.Link.stimulsoft.startsWith("##")&&this.tagsArray.stimulsoft.countItems>0){let t=e.Link.substr(2);for(let i=0;i<this.tagsArray.stimulsoft.countItems;i++){let r=this.tagsArray[i];if(r.Link==t){e.DestPage=r.Page,e.DestY=r.Y;break}}}else if("#"==e.Link.charAt(0)&&this.haveBookmarks){let t=e.Link.substr(1);if("%"==t.charAt(0)&&t.length>2){let e=t.lastIndexOf(t.charAt(1));e<t.length-1&&(t=t.substr(e+1))}for(let i=0;i<this.bookmarksCounter;i++){let r=this.bookmarksTree[i];if(r.Title==t){e.DestPage=r.Page,e.DestY=r.Y;break}}}if(this.linksArray[t]=e,this.addXref(this.info.linkList[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.linkList[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Link"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.sw.writeLine("/Border [0 0 0]"),"#"==e.Link.charAt(0))e.DestY>-1?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[e.DestPage].ref,this.convertToString(e.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref);else{let t=this.stringReplace(e.Link,"\\","/"),r=t.length>6&&g.isLetter(t,0)&&":"==t.charAt(1)&&"/"==t.charAt(2)||"/"==t.charAt(0)&&g.isLetter(t,1)&&"/"==t.charAt(2);r&&":"==t.charAt(1)&&(t="/"+t.charAt(0)+t.substr(2)),this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),r?(this.sw.writeLine("/S /Launch"),this.sw.writeLine("/F <<"),this.sw.writeLine("/Type /Filespec"),this.storeStringLine("/F ",t),this.storeStringLine("/UF ",t),this.sw.writeLine(">>")):(this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",i.StiExportUtils.stringToUrl(t))),this.sw.writeLine(">>")}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderAnnotTable(){if(this.haveAnnots||this.haveDigitalSignature||this.haveTooltips){this.addXref(this.info.acroForm.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Fields [");for(let t=0;t<this.annotsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.annots[t].ref);for(let t=0;t<this.annots2Counter;t++)for(let e=0;e<this.info.acroForm.checkBoxes[t].items.length;e++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.checkBoxes[t].items[e].ref);for(let t=0;t<this.unsignedSignaturesCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.unsignedSignatures[t].ref);this.haveDigitalSignature&&this.sw.writeLine1("{0} 0 R",this.info.acroForm.signatures[0].ref);for(let t=0;t<this.tooltipsCounter;t++)this.sw.writeLine1("{0} 0 R",this.info.acroForm.tooltips[t].ref);if(this.sw.writeLine("]"),this.sw.writeLine("/DR <<"),this.annotsCounter>0||this.annots2Counter>0){this.sw.writeLine("/Font <<");for(let t=0;t<this.fontsCounter;t++)this.sw.writeLine1("/FA{0} {1} 0 R",t,this.info.acroForm.annotFontItems[t].ref);this.sw.writeLine(">>")}if(this.sw.writeLine(">>"),this.haveAnnots&&this.fontsCounter>0&&this.storeStringLine("/DA ","/FA0 0 Tf 0 g"),this.haveDigitalSignature&&this.sw.writeLine("/SigFlags 3"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.haveAnnots){let e=new T;for(let i=0;i<this.annotsCounter;i++){let r=this.annotsArray[i],n="";if(t["StiOptions"].Export.Pdf.useEditableFieldName&&(n=r.Component.name),t["StiOptions"].Export.Pdf.useEditableFieldAlias&&(n=r.Component.alias),t["StiOptions"].Export.Pdf.useEditableFieldTag&&(n=r.Component.tagValue),w.isNullOrEmpty(n)&&(n=w.format("Field{0}",i)),e.containsKey(n)){let t=2,i="";while(e.containsKey(n+i))i="_"+t.toString(),t++;n+=i}e.add(n,n),this.addXref(this.info.acroForm.annots[i].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[i].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width),this.convertToString(r.Y+r.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[r.Page].ref),this.sw.writeLine("/FT /Tx"),this.sw.writeLine("/BS << /W 0 >>"),this.storeStringLine("/T ",n),this.sw.writeLine("/MK << /TP 2 >>"),this.sw.writeLine("/H /P"),this.sw.writeLine1("/AP << /N {0} 0 R >>",this.info.acroForm.annots[i].aP.ref);let s=r.Multiline?4096:0;null!=r.Component.as(L)&&null!=r.Component.as(L).TextOptions&&r.Component.as(L).TextOptions.LineLimit&&(s|=8388608),this.sw.writeLine1("/Ff {0}",s),this.storeStringLine("/DA ",w.format("/FA{0} {1} Tf {2} {3} {4} rg",r.FontNumber,this.convertToString(r.FontSize,this.precision_digits_font),this.colorTable[r.FontColor.r],this.colorTable[r.FontColor.g],this.colorTable[r.FontColor.b])),this.storeStringLine("/V ",r.Text),this.storeStringLine("/DV ",r.Text),this.sw.writeLine1("/Q {0}",(r.Alignment==t.Base.Drawing.StiTextHorAlignment.Center?1:0)+(r.Alignment==t.Base.Drawing.StiTextHorAlignment.Right?2:0)),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annots[i].aP.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annots[i].aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(r.Width),this.convertToString(r.Height)),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF /Text ]"),this.sw.writeLine1("/Font << /F{0} {1} 0 R >> >>",r.FontNumber,this.info.fontList[r.FontNumber].ref);let o=new f;o.writeLine("/Tx BMC"),o.writeLine("q");let a=1;o.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(a),this.convertToString(a),this.convertToString(r.Width-a),this.convertToString(r.Height-a)),o.flush(),o.write(r.Content,0,r.Content.length),o.writeLine("Q"),o.writeLine("EMC"),o.flush(),this.storeMemoryStream2(o,"/Filter [] /Length {0}"),this.sw.writeLine(""),o.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(let e=0;e<this.fontsCounter;e++){this.pdfFont.currentFont=e;let i=this.pdfFont.fontList[e],r=i.Name;t["StiOptions"].Export.Pdf.useAlternativeFontNames&&t["StiOptions"].Export.Pdf.alternativeFontNames.containsKey(r)&&(r=t["StiOptions"].Export.Pdf.alternativeFontNames.get(r));let n=new P(this.stringReplace(r," ","#20"));if((i.Bold||i.Italic)&&(n.append(","),i.Bold&&n.append("Bold"),i.Italic&&n.append("Italic")),this.addXref(this.info.acroForm.annotFontItems[e].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[e].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Font"),this.sw.writeLine("/Subtype /TrueType"),this.sw.writeLine1("/Name /FA{0}",e),this.sw.writeLine1("/BaseFont /{0}",n),this.sw.writeLine("/Encoding /WinAnsiEncoding"),this.sw.writeLine1("/FontDescriptor {0} 0 R",this.info.acroForm.annotFontItems[e].fontDescriptor.ref),this.fontGlyphsReduceNotNeed[e]){let t=new P(" ");for(let e=32;e<256;e++)t.append(this.pdfFont.Widths[this.pdfFont.UnicodeMap[this.CodePage1252[e]]-32].toString()+" ");this.sw.writeLine("/FirstChar 32"),this.sw.writeLine("/LastChar 255"),this.sw.writeLine1("/Widths [{0}]",t)}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.acroForm.annotFontItems[e].fontDescriptor.ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.annotFontItems[e].fontDescriptor.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /FontDescriptor"),this.sw.writeLine1("/FontName /{0}",n),this.sw.writeLine("/Flags 32"),this.sw.writeLine1("/Ascent {0}",this.pdfFont.tmASC),this.sw.writeLine1("/CapHeight {0}",this.pdfFont.CH),this.sw.writeLine1("/Descent {0}",-this.pdfFont.tmDESC),this.sw.writeLine1("/FontBBox [{0} {1} {2} {3}]",-500,-200,1500,1e3),this.sw.writeLine1("/ItalicAngle {0}",this.pdfFont.ItalicAngle),this.sw.writeLine1("/StemV {0}",this.pdfFont.StemV),1==this.embeddedFonts&&this.sw.writeLine1("/FontFile2 {0} 0 R",this.info.fontList[e].fontFile2.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}for(let r=0;r<this.annots2Counter;r++){let n=this.annots2Array[r],s="";if(t["StiOptions"].Export.Pdf.useEditableFieldName&&(s=n.Component.name),t["StiOptions"].Export.Pdf.useEditableFieldAlias&&(s=n.Component.alias),t["StiOptions"].Export.Pdf.useEditableFieldTag&&(s=n.Component.tagValue),w.isNullOrEmpty(s)&&(s=w.format("Checkbox{0}",r+1)),e.containsKey(s)){let t=2,i="";while(e.containsKey(s+i))i="_"+t.toString(),t++;s+=i}e.add(s,s);const o=.01;let a=n.Component.as(j),l=i.StiPdfRenderPrimitives.getCheckBoxValue(a);if(null==l&&(l=!1),this.info.acroForm.checkBoxes[r].items.length>1){let t=this.info.acroForm.checkBoxes[r].items[0];this.addXref(t.ref),this.sw.writeLine1("{0} 0 obj",t.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(n.X),this.convertToString(n.Y),this.convertToString(n.X+n.Width-o),this.convertToString(n.Y+n.Height-o)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[r].items.length||0==l?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[n.Page].ref),this.storeStringLine("/T ",s+"Yes"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",t.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",t.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aP.ref),this.sw.writeLine1("{0} 0 obj",t.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(n.Width),this.convertToString(n.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(let t=0;t<this.hatchArray.length;t++)this.sw.writeLine1(w.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)this.sw.writeLine1(w.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>");let e=new f;e.writeLine("/Tx BMC"),e.writeLine("q");let i=1;e.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(i),this.convertToString(i),this.convertToString(n.Width-i),this.convertToString(n.Height-i)),e.flush(),e.write(n.Content,0,n.Content.length),e.writeLine("Q"),e.writeLine("EMC"),e.flush(),this.storeMemoryStream2(e,"/Filter [] /Length {0}"),this.sw.writeLine(""),e.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[0].ref),this.sw.writeLine1("{0} 0 obj",t.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",t.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",s+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[1].ref),this.sw.writeLine1("{0} 0 obj",t.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",s+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),t=this.info.acroForm.checkBoxes[r].items[1],this.addXref(t.ref),this.sw.writeLine1("{0} 0 obj",t.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(n.X),this.convertToString(n.Y),this.convertToString(n.X+n.Width-o),this.convertToString(n.Y+n.Height-o)),this.sw.writeLine1("/F {0}",4+(3==this.info.acroForm.checkBoxes[r].items.length||1==l?2:0)),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[n.Page].ref),this.storeStringLine("/T ",s+"No"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",t.aA[0].ref),this.sw.writeLine1("/AP << /N {0} 0 R >>",t.aP.ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aP.ref),this.sw.writeLine1("{0} 0 obj",t.aP.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /XObject"),this.sw.writeLine("/Subtype /Form"),this.sw.writeLine("/FormType 1"),this.sw.writeLine1("/BBox [{0} {1} {2} {3}]",this.convertToString(0),this.convertToString(0),this.convertToString(n.Width),this.convertToString(n.Height)),this.sw.writeLine("/Matrix [ 1 0 0 1 0 0 ]"),this.sw.writeLine("/Resources <<"),this.sw.writeLine("/ProcSet [ /PDF ]"),this.sw.writeLine("/Pattern"),this.sw.writeLine("<<");for(let t=0;t<this.hatchArray.length;t++)this.sw.writeLine1(w.format("/PH{0} {1} 0 R",1+t,this.info.patterns.hatchItems[t].ref));for(let t=0;t<this.shadingArray.length;t++)this.sw.writeLine1(w.format("/P{0} {1} 0 R",2+t,this.info.patterns.shadingItems[t].ref));this.sw.writeLine(">>"),this.sw.writeLine("/ColorSpace 3 0 R"),this.sw.writeLine(">>"),e=new f,e.writeLine("/Tx BMC"),e.writeLine("q"),i=1,e.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(i),this.convertToString(i),this.convertToString(n.Width-i),this.convertToString(n.Height-i)),e.flush(),e.write(n.Content2,0,n.Content2.length),e.writeLine("Q"),e.writeLine("EMC"),e.flush(),this.storeMemoryStream2(e,"/Filter [] /Length {0}"),this.sw.writeLine(""),e.close(),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[0].ref),this.sw.writeLine1("{0} 0 obj",t.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine1("/Next {0} 0 R",t.aA[1].ref),this.sw.writeLine("/S /Hide"),
this.sw.writeLine1("/T ({0})",s+"Yes"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(t.aA[1].ref),this.sw.writeLine1("{0} 0 obj",t.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",s+"No"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}if(3==this.info.acroForm.checkBoxes[r].items.length){let e=this.info.acroForm.checkBoxes[r].items[2];this.addXref(e.ref),this.sw.writeLine1("{0} 0 obj",e.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine("/FT /Btn"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(n.X),this.convertToString(n.Y),this.convertToString(n.X+n.Width-o),this.convertToString(n.Y+n.Height-o)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[n.Page].ref),this.storeStringLine("/T ",s+"None"),this.sw.writeLine("/MK << >>"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine1("/A {0} 0 R",e.aA[0].ref),this.sw.writeLine("/H /O"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(e.aA[0].ref),this.sw.writeLine1("{0} 0 obj",e.aA[0].ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Next {0} 0 R",e.aA[1].ref),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",s+"None"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(e.aA[1].ref),this.sw.writeLine1("{0} 0 obj",e.aA[1].ref),this.sw.writeLine("<<"),this.sw.writeLine("/H false"),this.sw.writeLine("/S /Hide"),this.sw.writeLine1("/T ({0})",s+(a.checkStyleForTrue==t.Report.Components.StiCheckStyle.None?"No":"Yes")),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}for(let i=0;i<this.unsignedSignaturesCounter;i++){let r=this.unsignedSignaturesArray[i],n="";if(t["StiOptions"].Export.Pdf.useEditableFieldName&&(n=r.Component.name),t["StiOptions"].Export.Pdf.useEditableFieldAlias&&(n=r.Component.alias),t["StiOptions"].Export.Pdf.useEditableFieldTag&&(n=r.Component.tagValue),w.isNullOrEmpty(n)&&(n=w.format("UnsignedSignature{0}",i)),e.containsKey(n)){let t=2,i="";while(e.containsKey(n+i))i="_"+t.toString(),t++;n+=i}e.add(n,n);let s=this.info.acroForm.unsignedSignatures[i].ref;this.addXref(s),this.sw.writeLine1("{0} 0 obj",s),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(r.X),this.convertToString(r.Y),this.convertToString(r.X+r.Width),this.convertToString(r.Y+r.Height)),this.sw.writeLine("/F 4"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[r.Page].ref),this.sw.writeLine("/FT /Sig"),this.storeStringLine("/T ",n),this.sw.writeLine("/MK << >>"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}}}renderTooltipTable(){if(this.haveTooltips)for(let t=0;t<this.tooltipsCounter;t++){let e=this.tooltipsArray[t],r=!1,n=new J;for(let t=0;t<this.linksCounter;t++)if(n=this.linksArray[t],n.X==e.X&&n.Y==e.Y&&n.Width==e.Width&&n.Height==e.Height&&n.Page-1==e.Page){r=!0;break}this.addXref(this.info.acroForm.tooltips[t].ref),this.sw.writeLine1("{0} 0 obj",this.info.acroForm.tooltips[t].ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Annot"),this.sw.writeLine("/Subtype /Widget"),this.sw.writeLine1("/Rect [{0} {1} {2} {3}]",this.convertToString(e.X),this.convertToString(e.Y),this.convertToString(e.X+e.Width),this.convertToString(e.Y+e.Height)),this.storeStringLine("/TU ",e.Link),this.sw.writeLine("/F 0"),this.sw.writeLine1("/P {0} 0 R",this.info.pageList[e.Page].ref),this.storeStringLine("/T ",w.format("Tooltip{0}",t)),this.sw.writeLine("/FT /Btn"),this.sw.writeLine("/Ff 65536"),this.sw.writeLine("/H /N"),this.sw.writeLine("/AP <<"),this.sw.writeLine(">>"),r&&("#"==n.Link.charAt(0)?n.DestY>-1?this.sw.writeLine1("/Dest [{0} 0 R /XYZ null {1} null]",this.info.pageList[n.DestPage].ref,this.convertToString(n.DestY)):this.sw.writeLine1("/Dest [{0} 0 R /XYZ null null null]",this.info.pageList[0].ref):(this.sw.writeLine("/A <<"),this.sw.writeLine("/Type /Action"),this.sw.writeLine("/S /URI"),this.storeStringLine("/URI ",i.StiExportUtils.stringToUrl(this.stringReplace(n.Link,"\\","/"))),this.sw.writeLine(">>"))),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}}renderEncodeRecord(){this.encrypted&&(this.addXref(this.info.encode.ref),this.sw.writeLine1("{0} 0 obj",this.info.encode.ref),this.sw.writeLine("<<"),this.pdfSecurity.renderEncodeRecord(this.sw),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}renderExtGStateRecord(){this.addXref(this.info.extGState.ref),this.sw.writeLine1("{0} 0 obj",this.info.extGState.ref),this.sw.writeLine("<<");for(let t=0;t<256;t++)if(this.alphaTable[t]){let e=w.format("{0:X2}",t).toUpperCase();this.sw.writeLine1("/GS{0}S <</Type /ExtGState /BM /Normal /CA {1}>>",e,this.colorTable[t]),this.sw.writeLine1("/GS{0}N <</Type /ExtGState /BM /Normal /ca {1}>>",e,this.colorTable[t])}this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine("")}storeImageData(e,i,r,n,s=!1){null!=e&&e.tryConvertSync(t.System.Drawing.Imaging.ImageFormat.Jpeg);let o=this.imageCache.addImageInt(e),a=new _;return null!=e&&null!=e.bytes?(a.Width=e.width,a.Height=e.height):(a.Width=1,a.Height=1),a.Name=w.format("Image{0}",o),a.ImageFormat=this.imageFormat,this.imageList.push(a),this.imageCacheIndexToList.set(o,a),n&&this.imageInterpolationTable.set(o,!0),i}storeImageDataForGeom(t){let e=t.imageToDraw.horizontalResolution/100;this.imageResolutionMode==i.StiImageResolutionMode.NoMoreThan&&(e=t.stretch?t.imageToDraw.width/this.report.unit.convertToHInches(t.width):1/t.multipleFactor),e=this.storeImageData(t.imageToDraw,e,!0,t.smoothing),this.imageInfoList.set(this.imageInfoCounter,e)}writeImageInfo(t,e){let r=this.imageList[this.imagesCurrent];this.imagesCurrent++;let n=t.Component.as(M);if(this.imageResolutionMode!=i.StiImageResolutionMode.Exactly&&null!=n&&!n.margins.isEmpty){let e=this.hiToTwips*n.margins.left,i=this.hiToTwips*n.margins.right,r=this.hiToTwips*n.margins.top,s=this.hiToTwips*n.margins.bottom;0!=e&&(t.X+=e,t.Width-=e),0!=s&&(t.Y+=s,t.Height-=s),0!=i&&(t.Width-=i),0!=r&&(t.Height-=r)}let s=p.None;null!=n&&(s=n.imageRotation);let o=r.Width,a=r.Height;s!=p.Rotate90CCW&&s!=p.Rotate90CW||(o=r.Height,a=r.Width);let l=t.X,m=t.Y,c=this.hiToTwips*(o-1)/e,g=this.hiToTwips*(a-1)/e,h=!1;if(this.imageResolutionMode!=i.StiImageResolutionMode.Exactly&&null!=n&&null!=n.imageToDraw){let e=n.imageToDraw,i=n.getPaintRectangle(!0,!1);i=n.convertImageMargins(i,!1);let r=new U(0,0,i.width,i.height);if(n.stretch){let s=o,h=a;if(null==e&&(s=1,h=1),n.aspectRatio){let t=r.width/s,e=r.height/h;switch(t>e?r.width=s*e:r.height=h*t,n.vertAlignment){case W.Center:r.y=(i.height-r.height)/2;break;case W.Top:r.y=i.height-r.height;break}switch(n.horAlignment){case X.Center:r.x=(i.width-r.width)/2;break;case X.Right:r.x=i.width-r.width;break}l+=r.x*this.hiToTwips,m+=r.y*this.hiToTwips,c=r.width*this.hiToTwips,g=r.height*this.hiToTwips}else c=t.Width,g=t.Height}else{let t=o*n.multipleFactor,s=a*n.multipleFactor;switch(null!=e&&null!=e.bytes||(t=1,s=1),r.width=t,r.height=s,n.horAlignment){case X.Center:r.x=(i.width-t)/2;break;case X.Right:r.x=i.width-t;break}switch(n.vertAlignment){case W.Center:r.y=(i.height-s)/2;break;case W.Top:r.y=i.height-s;break}l+=r.x*this.hiToTwips,m+=r.y*this.hiToTwips,c=r.width*this.hiToTwips,g=r.height*this.hiToTwips,h=!0}}this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(u.black),h&&this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(t.X),this.convertToString(t.Y),this.convertToString(t.Width),this.convertToString(t.Height)),s==p.None?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(c),this.convertToString(g),this.convertToString(l),this.convertToString(m)):(this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(l+c/2),this.convertToString(m+g/2)),s==p.Rotate90CCW&&this.pageStream.writeLine("0 1 -1 0 0 0 cm"),s==p.Rotate90CW&&this.pageStream.writeLine("0 -1 1 0 0 0 cm"),s==p.Rotate180&&this.pageStream.writeLine("-1 0 0 -1 0 0 cm"),s==p.FlipHorizontal&&this.pageStream.writeLine("-1 0 0 1 0 0 cm"),s==p.FlipVertical&&this.pageStream.writeLine("1 0 0 -1 0 0 cm"),s==p.Rotate90CCW||s==p.Rotate90CW?this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(g),this.convertToString(c),this.convertToString(-g/2),this.convertToString(-c/2)):this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(c),this.convertToString(g),this.convertToString(-c/2),this.convertToString(-g/2))),this.pageStream.writeLine1("/{0} Do",r.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()}writeImageInfo2(t,e,i){let r=this.imageList[this.imagesCurrent];this.imagesCurrent++,this.pageStream.writeLine("q"),this.pushColorToStack(),this.setNonStrokeColor(u.black),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(this.hiToTwips*r.Width/e),this.convertToString(this.hiToTwips*r.Height/i),this.convertToString(t.X),this.convertToString(t.Y)),this.pageStream.writeLine1("/{0} Do",r.Name),this.pageStream.writeLine("Q"),this.popColorFromStack()}renderImage(t,i){if(this.imageInfoList.containsKey(this.imageInfoCounter)){let e=this.imageInfoList.get(this.imageInfoCounter);this.writeImageInfo(t,e)}else{let r=t.Component.as(z);if(null!=r&&t.Component.isExportAsImage(e.StiExportFormat.Pdf)){let n=i,s={ref:n},o=r.getImage(s,e.StiExportFormat.Pdf);n=s.ref,null!=o&&null!=o.bytes&&this.writeImageInfo(t,n)}}}renderWatermark(e,r,n,s,o){let a=e.watermark;if(null!=a&&a.enabled){if(null!=a.image&&a.showImageBehind==r){let e=this.imageList[this.imagesCurrent],i=e.Width*this.hiToTwips*a.imageMultipleFactor,r=e.Height*this.hiToTwips*a.imageMultipleFactor,o=0,l=0,m=1,c=1,g=a.imageAlignment,h=a.imageTiling;if(a.imageStretch){let t=r/i;i=n,r=s,h=!1,a.aspectRatio&&(s/n>t?r=i*t:i=r/t)}switch((a.imageStretch||a.imageMultipleFactor>1)&&this.imageInterpolationTable.set(this.imageCache.imageIndex[this.imagesCurrent],!0),h&&(g=t.System.Drawing.ContentAlignment.TopLeft,m=Math.round2(n/i)+1,c=Math.round2(s/r)+1),g){case t.System.Drawing.ContentAlignment.TopCenter:case t.System.Drawing.ContentAlignment.MiddleCenter:case t.System.Drawing.ContentAlignment.BottomCenter:o=(n-i)/2;break;case t.System.Drawing.ContentAlignment.TopRight:case t.System.Drawing.ContentAlignment.MiddleRight:case t.System.Drawing.ContentAlignment.BottomRight:o=n-i;break}switch(g){case t.System.Drawing.ContentAlignment.TopLeft:case t.System.Drawing.ContentAlignment.TopCenter:case t.System.Drawing.ContentAlignment.TopRight:l=s-r;break;case t.System.Drawing.ContentAlignment.MiddleLeft:case t.System.Drawing.ContentAlignment.MiddleCenter:case t.System.Drawing.ContentAlignment.MiddleRight:l=(s-r)/2;break}this.setNonStrokeColor(u.fromArgb(255-a.imageTransparency,u.black));for(let t=0;t<c;t++)for(let n=0;n<m;n++)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} 0 0 {1} {2} {3} cm",this.convertToString(i),this.convertToString(r),this.convertToString(o+i*n),this.convertToString(l-r*t)),this.pageStream.writeLine1("/{0} Do",e.Name),this.pageStream.writeLine("Q"),this.popColorFromStack();this.imagesCurrent++}if(!w.isNullOrEmpty(a.text)&&a.showBehind==r){let r=new V(this);r.X=0,r.Y=0,r.Width=n,r.Height=s;let o=new L(new U(r.X,r.Y,r.Width,r.Height));o.text=a.text,o.textBrush=a.textBrush,o.font=a.font,o.textOptions=new t.Base.Drawing.StiTextOptions,o.textOptions.angle=a.angle,o.horAlignment=t.Base.Drawing.StiTextHorAlignment.Center,o.vertAlignment=W.Center,o.page=e,o.textQuality=t.Report.Components.StiTextQuality.Standard,r.Component=o,i.StiPdfRenderText.renderTextFont(r),i.StiPdfRenderText.renderText(r)}}}storeShadingData1(t,e){if(null!=t){if(t.is(b)){let i=t,r=new q;r.Angle=i.angle,r.Page=e,r.FunctionIndex=this.getShadingFunctionNumber(i.startColor,i.endColor,!1),this.shadingArray.push(r)}if(t.is(y)){let i=t,r=new q;r.Angle=i.angle,r.FunctionIndex=this.getShadingFunctionNumber(i.startColor,i.endColor,!0),r.Page=e,this.shadingArray.push(r)}}}storeShadingData2(t,e,i,r,n){if(null!=n&&(n.is(b)||n.is(y))){let n=this.shadingArray[this.shadingCurrent];n.X=t,n.Y=e,n.Width=i,n.Height=r,this.shadingArray[this.shadingCurrent]=n,this.shadingCurrent++}return this.shadingCurrent}storeHatchData(t){if(null!=t&&(t.is(x)&&this.getHatchNumber(t),t.is(A))){let e;t.as(A).drawHatch}}renderMetadata(e){let r=new f,n='<?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?>\r\n';r.writeString(n);let s=new f,o=new N(t.System.Text.Encoding.UTF8,s);if(o.formatting=t.System.Xml.Formatting.Indented,o.writeStartElement("x:xmpmeta"),o.writeAttributeString("xmlns:x","adobe:ns:meta/"),o.writeAttributeString("x:xmptk","Adobe XMP Core 4.0-c316 44.253921, Sun Oct 01 2006 17:14:39"),o.writeStartElement("rdf:RDF"),o.writeAttributeString("xmlns:rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:xap","http://ns.adobe.com/xap/1.0/"),o.writeElementString("xap:ModifyDate",this.currentDateTimeMeta),o.writeElementString("xap:CreateDate",this.currentDateTimeMeta),o.writeElementString("xap:MetadataDate",this.currentDateTimeMeta),o.writeElementString("xap:CreatorTool",t["StiOptions"].Export.Pdf.creatorString),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),o.writeElementString("dc:format","application/pdf"),o.writeStartElement("dc:title"),o.writeStartElement("rdf:Alt"),w.isNullOrEmpty(e.reportName)||(o.writeStartElement("rdf:li"),o.writeAttributeString("xml:lang","x-default"),o.writeString(e.reportName),o.writeFullEndElement()),o.writeEndElement(),o.writeFullEndElement(),o.writeStartElement("dc:description"),o.writeStartElement("rdf:Alt"),w.isNullOrEmpty(e.reportAlias)||(o.writeStartElement("rdf:li"),o.writeAttributeString("xml:lang","x-default"),o.writeString(e.reportAlias),o.writeFullEndElement()),o.writeEndElement(),o.writeFullEndElement(),o.writeStartElement("dc:creator"),o.writeStartElement("rdf:Seq"),w.isNullOrEmpty(e.reportAuthor)||(o.writeStartElement("rdf:li"),o.writeAttributeString("xml:lang","x-default"),o.writeString(e.reportAuthor),o.writeFullEndElement()),o.writeEndElement(),o.writeFullEndElement(),o.writeStartElement("dc:subject"),o.writeStartElement("rdf:Bag"),!w.isNullOrEmpty(this.keywords)){let t=this.keywords.split(";");for(let e of t)o.writeStartElement("rdf:li"),o.writeString(e.trim()),o.writeFullEndElement()}o.writeEndElement(),o.writeFullEndElement(),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:xapMM","http://ns.adobe.com/xap/1.0/mm/"),o.writeElementString("xapMM:DocumentID",this.IDValueStringMeta),o.writeElementString("xapMM:InstanceID",this.IDValueStringMeta),o.writeFullEndElement(),o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:pdf","http://ns.adobe.com/pdf/1.3/"),o.writeAttributeString("xmlns:pdfx","http://ns.adobe.com/pdf/1.3/"),o.writeElementString("pdf:Producer",this.producerName),o.writeElementString("pdf:Keywords",this.keywords);for(let t of e.metaTags.list)t.name.stimulsoft.startsWith("pdf:")&&o.writeElementString("pdfx:"+t.name.substr(4),t.tag);if(o.writeFullEndElement(),this.usePdfA){o.writeStartElement("rdf:Description"),o.writeAttributeString("rdf:about",""),o.writeAttributeString("xmlns:pdfaid","http://www.aiim.org/pdfa/ns/id/");let t="1";switch(this.pdfComplianceMode){case i.StiPdfComplianceMode.A1:t="1";break;case i.StiPdfComplianceMode.A2:t="2";break;case i.StiPdfComplianceMode.A3:t="3";break}o.writeElementString("pdfaid:part",t),o.writeElementString("pdfaid:conformance","A"),o.writeFullEndElement()}o.writeFullEndElement(),o.writeFullEndElement(),o.writeString("                              \r\n"),o.writeString("                              \r\n"),o.writeString("                              \r\n"),o.writeString("                              \r\n"),o.writeString("                              \r\n");let a=s.toArray();o.close(),s.close(),r.write(a,0,a.length),r.writeString('<?xpacket end="w"?>'),this.addXref(this.info.metadata.ref),this.sw.writeLine1("{0} 0 obj",this.info.metadata.ref),this.sw.writeLine("<<"),this.sw.writeLine("/Type /Metadata"),this.sw.writeLine("/Subtype /XML"),this.storeMemoryStream2(r,"/Length {0}"),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderColorSpace(){this.addXref(this.info.destOutputProfile.ref),this.sw.writeLine1("{0} 0 obj",this.info.destOutputProfile.ref),this.sw.writeLine("<<"),this.sw.writeLine("/N 3");let t=null,e=null;1==this.compressed?(t=i.StiExportUtils.makePdfDeflateStream(i.StiPdfResources.sRGBprofile),e="/Length {0} /Filter [/FlateDecode] /Length1 "+i.StiPdfResources.sRGBprofile.length.toString(),this.storeMemoryStream2(t,e)):(t=new f,t.write(i.StiPdfResources.sRGBprofile,0,i.StiPdfResources.sRGBprofile.length),e="/Length {0}",this.storeMemoryStream2(t,e)),this.sw.writeLine(""),this.sw.writeLine("endstream"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.outputIntents.ref),this.sw.writeLine1("{0} 0 obj",this.info.outputIntents.ref),this.sw.writeLine("[<<"),this.storeStringLine("/Info","sRGB IEC61966-2.1"),this.storeStringLine("/OutputConditionIdentifier","Custom"),this.storeStringLine("/OutputCondition",""),this.storeStringLine("/RegistryName",""),this.sw.writeLine("/S /GTS_PDFA1"),this.sw.writeLine1("/DestOutputProfile {0} 0 R",this.info.destOutputProfile.ref),this.sw.writeLine("/Type /OutputIntent"),this.sw.writeLine(">>]"),this.sw.writeLine("endobj"),this.sw.writeLine("")}renderAutoPrint(){this.autoPrint!=i.StiPdfAutoPrintMode.None&&(this.addXref(this.info.embeddedJS.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.ref),this.sw.writeLine("<<"),this.sw.writeLine1("/Names [(EmbeddedJS) {0} 0 R]",this.info.embeddedJS.content.ref),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""),this.addXref(this.info.embeddedJS.content.ref),this.sw.writeLine1("{0} 0 obj",this.info.embeddedJS.content.ref),this.sw.writeLine("<<"),this.sw.writeLine("/S /JavaScript"),this.sw.writeLine1("/JS (print\\({0}\\);)",this.autoPrint==i.StiPdfAutoPrintMode.Dialog?"true":"false"),this.sw.writeLine(">>"),this.sw.writeLine("endobj"),this.sw.writeLine(""))}addBookmarkNode(t,e){let i=new Z;i.Parent=-1,i.First=-1,i.Last=-1,i.Prev=-1,i.Next=-1,i.Count=-1,i.Page=-1,i.Y=-1,i.Title="",i.Guid="",i.Used=-1==e,this.bookmarksTree.push(i);let r=this.bookmarksTree.stimulsoft.countItems-1;if(i.Parent=e,i.Title=t.text,i.Guid=t.componentGuid,0==t.bookmarks.count)i.Count=0;else{let e=-1;for(let i=0;i<=t.bookmarks.count-1;i++){let n=this.bookmarksTree.stimulsoft.countItems,s=t.bookmarks.list[i];this.addBookmarkNode(s,r);let o=this.bookmarksTree[n];i<t.bookmarks.count-1&&(o.Next=this.bookmarksTree.stimulsoft.countItems),i>0&&(o.Prev=e),this.bookmarksTree[n]=o,e=n}i.First=r+1,i.Last=this.bookmarksTree.stimulsoft.countItems-1,i.Count=this.bookmarksTree.stimulsoft.countItems-r-1}this.bookmarksTree[r]=i}makeBookmarkFromTree(t,e){if(t.text=e.Title,t.bookmarks=new m,e.Count>0){let i=e.First;while(-1!=i){let e=this.bookmarksTree[i];if(e.Used){let i=new c;t.bookmarks.add(i),this.makeBookmarkFromTree(i,e)}i=e.Next}}}exportPdf(t,e,i){try{this.exportPdf1(t,e,i)}finally{}}exportPdf1(m,g,p){if(null==p)throw new Error("The 'settings' argument cannot be equal in null.");this.report=m;let S=p.pageRange,d=p.imageResolution;this.imageResolutionMode=p.imageResolutionMode,this.imageQuality=p.imageQuality,this.embeddedFonts=p.embeddedFonts,this.standardPdfFonts=!!p.standardPdfFonts,this.compressed=!!p.compressed,this.useUnicodeMode=p.useUnicode;let u=p.passwordInputUser,f=p.passwordInputOwner,b=p.userAccessPrivileges;this.keyLength=p.keyLength,this.pdfComplianceMode=p.pdfComplianceMode,this.autoPrint=p.autoPrintMode,this.allowEditable=p.allowEditable,this.creatorName=t["StiOptions"].Export.Pdf.creatorString,this.keywords=t["StiOptions"].Export.Pdf.keywordsString,w.isNullOrEmpty(p.creatorString)||(this.creatorName=p.creatorString),w.isNullOrEmpty(p.keywordsString)||(this.keywords=p.keywordsString),w.isNullOrEmpty(this.creatorName)&&(this.creatorName=this.producerName),this.usePdfA=this.pdfComplianceMode!=i.StiPdfComplianceMode.None,this.useTransparency=this.pdfComplianceMode!=i.StiPdfComplianceMode.A1,this.compressed=!1,this.compressedFonts=!0,this.usePdfA&&(this.standardPdfFonts=!1,this.embeddedFonts=!0,this.useUnicodeMode=!0);let y=S.rangeType!=e.StiRangeType.All,x=!this.usePdfA;this.embeddedFonts&&(this.standardPdfFonts=!1),this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.useUnicodeMode&&(this.standardPdfFonts=!1),d<10&&(d=10),d/=100,this.imageResolutionMain=d,this.bidi=new i.StiBidirectionalConvert(!0),this.pdfFont=new i.PdfFonts,this.pdfFont.standardPdfFonts=this.standardPdfFonts,this.pdfFont.forceUseUnicode=this.useUnicodeMode,this.fontGlyphsReduceNotNeed=null;for(let e=0;e<=255;e++){let i,r=Math.round2(e/255,3).toString().split(",").join(t.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator);this.colorTable[e]=r,this.alphaTable[e]=!1}switch(this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,this.colorStack=new Array,this.imageList=new Array,this.imageCompressionMethod){case i.StiPdfImageCompressionMethod.Flate:this.imageCache=new e.StiImageCache(!0,!0,e.ImageFormat.MemoryBmp,this.imageQuality,x);break;default:this.imageCache=new e.StiImageCache(!0,!0,e.ImageFormat.Jpeg,this.imageQuality,x);break}this.imageInterpolationTable=new T,this.imageCacheIndexToList=new T,this.imageInfoList=new T,this.imageInfoCounter=0,this.pdfFont.fontList=new Array,this.xref=new Array,this.bookmarksTree=new Array,this.haveBookmarks=!1,this.linksArray=new Array,this.annotsArray=new Array,this.annots2Array=new Array,this.unsignedSignaturesArray=new Array,this.shadingArray=new Array,this.shadingFunctionArray=new Array,this.hatchArray=new Array,this.tooltipsArray=new Array,this.sw=g,this.fontsCounter=0,this.bookmarksCounter=0,this.linksCounter=0,this.annotsCounter=0,this.annots2Counter=0,this.tooltipsCounter=0;for(let t=0;t<256;t++)this.CodePage1252[t]=t;for(let t=0;t<32;t++)this.CodePage1252[128+t]=this.CodePage1252part80AF[t];this.fontGlyphsReduceNotNeed=l.create(Boolean,256);let A=H.now,N=A.toString("yyyyMMddHHmmsszzz");this.currentDateTime=N.substr(0,17)+"'"+N.substr(18,2)+"'",this.currentDateTimeMeta=A.toString("yyyy-MM-ddTHH:mm:sszzz");let M=A.toString("yyyyMMddHHmmssffff");M+=this.producerName,M+=this.creatorName,M+=m.reportAuthor,M+=m.reportAlias,M+=m.reportName;let U="";for(let t=0;t<M.length;t++)U+=String.fromCharCode(255&M.charCodeAt(t));this.IDValue=t.Base.StiMD5Helper.MD5(U,!1);let X="";for(let t=0;t<this.IDValue.length;t++)X+=i.StiExportUtils.toHex(this.IDValue[t]);this.IDValueString=X,this.IDValueStringMeta=w.format("uuid:{0}-{1}-{2}-{3}-{4}",this.IDValueString.substring(0,8),this.IDValueString.substring(8,4),this.IDValueString.substring(12,4),this.IDValueString.substring(16,4),this.IDValueString.substring(20,12)).toLowerCase(),this.pdfSecurity=new i.StiPdfSecurity(this),this.usePdfA||(this.encrypted=this.pdfSecurity.computingCryptoValues(b,f,u,this.keyLength,this.IDValue)),this.encrypted&&this.useUnicodeMode&&(this.embeddedFonts=!0);let W=S.getSelectedPages(m.renderedPages);null!=m.bookmark&&0!=m.bookmark.bookmarks.count&&(this.addBookmarkNode(m.bookmark,-1),this.haveBookmarks=!0,this.bookmarksCounter=this.bookmarksTree.stimulsoft.countItems);let _=0;for(let l of W.list){if(W.getPage(l),this.storeShadingData1(l.brush,_),this.storeHatchData(l.brush),null!=l.hyperlinkValue&&l.hyperlinkValue.toString().trim().length>0&&!l.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA){let t=new J;t.Link=l.hyperlinkValue.ToString(),t.Page=_,this.linksArray.push(t)}if(null!=l.watermark&&l.watermark.enabled){if(!w.isNullOrEmpty(l.watermark.text)){null!=l.watermark.font&&this.pdfFont.getFontNumber(l.watermark.font);let t=new P(l.watermark.text);t=this.bidi.convert(t,!1),this.pdfFont.storeUnicodeSymbolsInMap(t.toString()),this.storeShadingData1(l.watermark.textBrush,_),this.storeHatchData(l.watermark.textBrush)}1==l.watermark.showImageBehind&&null!=l.watermark.image&&this.storeImageData(l.watermark.image,d,!1,!1)}for(let c of l.components.list)if(c.enabled&&(!m.isPrinting||c.printable)){let l;if(this.imageInfoCounter++,c.width>0&&c.height>0){let l=c.as(B);null!=l&&(this.storeShadingData1(l.brush,_),this.storeHatchData(l.brush));let g=c.as(C);if(null!=g&&i.StiPdfRenderPrimitives.checkShape(g))continue;if(c.stimulsoft.is(j)){let t=c;if(this.storeShadingData1(t.textBrush,_),this.storeHatchData(t.textBrush),this.allowEditable==i.StiPdfAllowEditable.Yes&&t.editable){let t=new Q;t.Page=_,t.Component=c,this.annots2Array.push(t)}continue}let h=c.isExportAsImage(e.StiExportFormat.Pdf);if(h){let t=!1,r=c;if(this.imageResolutionMode!=i.StiImageResolutionMode.Exactly&&null!=r&&null!=r.imageToDraw&&null!=r.imageToDraw.bytes){t=!0;let e=r.imageToDraw.horizontalResolution/100;this.imageResolutionMode==i.StiImageResolutionMode.NoMoreThan&&(e=r.stretch?r.imageToDraw.width/m.unit.convertToHInches(c.width):1/r.multipleFactor),e=this.storeImageData(r.imageToDraw,e,!0,r.smoothing),this.imageInfoList.set(this.imageInfoCounter,e)}if(!t){let t=c.as(z);if(null!=t){let i=d,r={ref:i},n=t.getImage(r,e.StiExportFormat.Pdf);i=r.ref,null!=n&&(this.storeImageData(n,i,!1,!1),this.imageInfoList.set(this.imageInfoCounter,i))}}}let p=c.as(R);if(null!=p){let t=this.pdfFont.getFontNumber(p.font)}let S=c.stimulsoft.as(k);if(c.is(L)&&!h){let e=c,l=null!=S&&null!=S.textOptions&&S.textOptions.rightToLeft,m=new P(e.text);if(e.allowHtmlTags){let i=new t.Base.Drawing.StiHtmlTagsState(e.font.bold,e.font.italic,e.font.underline,e.font.strikeout,e.font.size,e.font.name,v.toColor(e.textBrush),v.toColor(e.brush),!1,!1,0,0,1,e.horAlignment),r=new t.Base.Drawing.StiHtmlState(i,0),n=t.Base.Drawing.StiTextRenderer.parseHtmlToStates(e.text,r);m=new P;for(let e=0;e<n.length;e++){let i=n[e];m.append(t.Base.Drawing.StiTextRenderer.prepareStateText(i.text))}}m=this.bidi.convert(m,l),this.pdfFont.storeUnicodeSymbolsInMap(m.toString());let g=c.as(I);if(null!=e&&null!=g&&(this.storeShadingData1(g.textBrush,_),this.storeHatchData(g.textBrush)),this.allowEditable==i.StiPdfAllowEditable.Yes&&e.editable){let t=new Q;t.Page=_,this.annotsArray.push(t),this.fontGlyphsReduceNotNeed[this.pdfFont.currentFont]=!0}if(null!=e.indicator){let i=e.indicator.stimulsoft.as(a);if(null!=i&&(i.icon!=o.None||null!=i.customIcon)){let t=s.getIcon(i),e=1;e=this.storeImageData(t,e,!1,!0,!0),this.imageInfoList[this.imageInfoCounter]=e}let l=e.indicator.stimulsoft.as(n);if(null!=l&&0!=l.value&&l.brushType==t.Report.Components.StiBrushType.Gradient){let t=l.value<0?l.negativeColor:l.positiveColor,e=r.light(t,200),i=new q;i.Page=_,i.FunctionIndex=this.getShadingFunctionNumber(t,e,!1),this.shadingArray.push(i)}}}if(c.is(Y)&&!h){let t=new i.StiPdfGeomWriter(this.pageStream,this,!0),e=i.StiBarCodeExportPainter.createNew(t),r=c;if(!w.isNullOrEmpty(r.codeValue)&&null!=r.page){let t=m.unit.convertRectangleToHInches(r.clientRectangle);r.barCodeType.draw(e,r,t,1)}}else if(c.is(O)&&!h){let t=new V(this);t.Component=c,i.StiPdfRenderChart.renderChart(t,!0,_)}}if(null!=c.hyperlinkValue&&c.hyperlinkValue.toString().trim().length>0&&!c.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA){let t=new J;t.Link=c.hyperlinkValue.toString(),t.Page=_,this.linksArray.push(t)}if(null!=c.toolTipValue&&c.toolTipValue.toString().trim().length>0&&!this.usePdfA){let t=new J;t.Page=_,this.tooltipsArray.push(t)}if(null!=c.tagValue&&"pdfunsignedsignaturefield"==c.tagValue.toString().toLowerCase()&&!this.usePdfA){let t=new Q;t.Page=_,this.unsignedSignaturesArray.push(t)}}_++,null!=l.watermark&&l.watermark.enabled&&0==l.watermark.showImageBehind&&null!=l.watermark.image&&this.storeImageData(l.watermark.image,d,!1,!1)}for(let t=0;t<this.pdfFont.fontList.length;t++)this.pdfFont.currentFont=t,this.pdfFont.storeUnicodeSymbolsInMap("…");if(this.unsignedSignaturesArray.stimulsoft.countItems>0&&(this.annotsArray.stimulsoft.countItems>0||this.annots2Array.stimulsoft.countItems>0))for(let t=0;t<this.pdfFont.fontList.stimulsoft.countItems;t++){let e;"Arial"==this.pdfFont.fontList[t].Name&&(this.fontGlyphsReduceNotNeed[t]=!0)}let K="";for(let t=32;t<256;t++)K+=String.fromCharCode(this.CodePage1252[t]);for(let t=0;t<this.pdfFont.fontList.length;t++)this.fontGlyphsReduceNotNeed[t]&&(this.pdfFont.currentFont=t,this.pdfFont.storeUnicodeSymbolsInMap(K));this.imagesCurrent=0,this.annotsCurrent=0,this.annots2Current=0,this.shadingCurrent=0,this.linksCounter=this.linksArray.stimulsoft.countItems,this.haveLinks=this.linksCounter>0,this.annotsCounter=this.annotsArray.length,this.annots2Counter=this.annots2Array.length,this.unsignedSignaturesCounter=this.unsignedSignaturesArray.length,this.haveAnnots=this.annotsCounter>0||this.annots2Counter>0||this.unsignedSignaturesCounter>0,this.tooltipsCounter=this.tooltipsArray.stimulsoft.countItems,this.haveTooltips=this.tooltipsCounter>0,this.pdfFont.InitFontsData(m),this.fontsCounter=this.pdfFont.fontList.length,this.info=new i.StiPdfStructure;for(let t=0;t<W.count;t++)this.info.pageList.push(this.info.createContentObject(!0));for(let t=0;t<this.imageCache.imagePackedStore.length;t++)this.info.xObjectList.push(this.info.createXObject(!0,null!=this.imageCache.imageMaskStore[t]));for(let t=0;t<this.pdfFont.fontList.length;t++){let e=this.pdfFont.fontList[t];this.info.fontList.push(this.info.createFontObject(!0,e.UseUnicode,this.standardPdfFonts,this.embeddedFonts||i.PdfFonts.isFontStimulsoft(e.Name)))}if(this.info.outlines=this.info.createOutlinesObject(this.haveBookmarks),this.haveBookmarks)for(let t=0;t<this.bookmarksCounter;t++)this.info.outlines.items.push(this.info.createObject(!0));this.info.patterns=this.info.createPatternsObject(!0);for(let t=0;t<this.hatchArray.length;t++)this.info.patterns.hatchItems.push(this.info.createObject(!0));for(let t=0;t<this.shadingArray.length;t++)this.info.patterns.shadingItems.push(this.info.createObject(!0));for(let t=0;t<this.shadingFunctionArray.length;t++)this.info.patterns.shadingFunctionItems.push(this.info.createObject(!0));for(let t=0;t<this.linksCounter;t++)this.info.linkList.push(this.info.createObject(!0));if(this.info.encode=this.info.createObject(this.encrypted),this.info.extGState=this.info.createObject(!0),this.info.acroForm=this.info.createAcroFormObject(this.haveAnnots||this.haveTooltips),this.haveAnnots){for(let t=0;t<this.annotsCounter;t++)this.info.acroForm.annots.push(this.info.createAnnotObject(!0,!0,0));for(let t=0;t<this.fontsCounter;t++)this.info.acroForm.annotFontItems.push(this.info.createFontObject(!0,!1,!1,!1,!0));for(let t=0;t<this.annots2Counter;t++)this.info.acroForm.checkBoxes.push(new i.StiPdfCheckBoxObjInfo),this.info.acroForm.checkBoxes[t].items=[],this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!0,2)),this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!0,2)),null==this.annots2Array[t].Component.as(j).checkedValue&&this.info.acroForm.checkBoxes[t].items.push(this.info.createAnnotObject(!0,!1,2));for(let t=0;t<this.unsignedSignaturesCounter;t++)this.info.acroForm.unsignedSignatures.push(this.info.createAnnotObject(!0,!1,0))}for(let t=0;t<this.tooltipsCounter;t++)this.info.acroForm.tooltips.push(this.info.createAnnotObject(!0,!1,0));this.info.metadata=this.info.createObject(!0),this.info.destOutputProfile=this.info.createObject(!0),this.info.outputIntents=this.info.createObject(!0),this.info.embeddedJS=this.info.createContentObject(this.autoPrint!=i.StiPdfAutoPrintMode.None),this.renderStartDoc(m,W);let $=0;this.linksArray.stimulsoft.clear(),this.tagsArray=new Array,this.tooltipsArray.stimulsoft.clear(),this.unsignedSignaturesArray.stimulsoft.clear(),this.imageInfoCounter=0,this.currentPassNumber++;for(let r of W.list){if(W.getPage(r),this.isStopped)return;this.renderPageHeader($++);let n=this.hiToTwips*m.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),s=this.hiToTwips*m.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),o=this.hiToTwips*m.unit.convertToHInches(r.margins.left),a=this.hiToTwips*m.unit.convertToHInches(r.margins.right),l=this.hiToTwips*m.unit.convertToHInches(r.margins.top),c=this.hiToTwips*m.unit.convertToHInches(r.margins.bottom);if(n>14400&&(n=14400),this.haveBookmarks&&(!w.isNullOrEmpty(r.guid)||null!=r.bookmarkValue&&""!=r.bookmarkValue.toString())){let t=0;while(t<this.bookmarksCounter){let e=this.bookmarksTree[t];if(0==e.Used&&-1==e.Page){let i=!1;if(w.isNullOrEmpty(e.Guid)?w.isNullOrEmpty(e.Title)||null!=r.bookmarkValue&&r.bookmarkValue.length>0&&e.Title==r.bookmarkValue&&(i=!0):w.isNullOrEmpty(r.guid)||e.Guid!=r.guid||(i=!0),i){e.Page=$-1,e.Y=n,e.Used=!0,this.bookmarksTree[t]=e;break}}t++}}if(null!=r.hyperlinkValue&&r.hyperlinkValue.toString().trim().length>0&&!r.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA){let t=new J;t.Link=r.hyperlinkValue.toString(),t.X=0,t.Y=0,t.Width=s,t.Height=n,t.Page=$,t.DestPage=-1,t.DestY=-1,this.linksArray.push(t)}if(null!=r.brush){let t=new V(this);t.X=0,t.Y=0,t.Width=s,t.Height=n;let e=new E;e.brush=r.brush,e.border=null,t.Component=e,i.StiPdfRenderPrimitives.renderBorder1(t)}this.renderWatermark(r,!0,s,n,d);let g=new Array;for(let s of r.components.list)if(s.enabled&&(!m.isPrinting||s.printable)){this.imageInfoCounter++;let r=this.hiToTwips*m.unit.convertToHInches(s.left),a=this.hiToTwips*m.unit.convertToHInches(s.top),c=this.hiToTwips*m.unit.convertToHInches(s.right),p=this.hiToTwips*m.unit.convertToHInches(s.bottom),S=new V(this),u;if(S.X=r+o,S.Y=a+l,S.Width=c-r,S.Height=p-a,S.Y=n-(S.Y+S.Height),S.Component=s,s.width>0&&s.height>0){let r=s.isExportAsImage(e.StiExportFormat.Pdf);if(this.usePdfA||s.printable||this.pageStream.writeLine("/OC /oc1 BDC"),s.is(C)||i.StiPdfRenderPrimitives.renderBorder1(S),s.is(L)&&!r){let e=s,r=0;this.haveAnnots&&e.editable&&(r=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255);let n=i.StiPdfRenderIndicators.renderIndicators(S);if(e.allowHtmlTags){let r=new t.Base.Drawing.StiHtmlTagsState(e.font.bold,e.font.italic,e.font.underline,e.font.strikeout,e.font.size,e.font.name,v.toColor(e.textBrush),v.toColor(e.brush),!1,!1,0,0,1,e.horAlignment),s=new t.Base.Drawing.StiHtmlState(r,0),o=t.Base.Drawing.StiTextRenderer.parseHtmlToStates(e.text,s),a=e.text.stimulsoft.startsWith("<StiHtmlJs>"),l="";for(let e=0;e<o.length;e++){let i=o[e];if(i.ts.tag.tag==h.P&&"\n"==i.text.toString())continue;l+=t.Base.Drawing.StiTextRenderer.prepareStateText(i.text)}let m=e.clone(!0);if(m.text=l,S.Component=m,i.StiPdfRenderText.renderTextFont(n),i.StiPdfRenderText.renderText(n),this.haveAnnots&&e.editable){let i=this.annotsArray[this.annotsCurrent];i.Multiline=e.wordWrap,i.X=S.X,i.Y=S.Y,i.Width=S.Width,i.Height=S.Height,i.Component=S.Component,i.Alignment=t.Base.Drawing.StiTextHorAlignment.Left;let r=S.Component.as(G);if(null!=r){let e=r.horAlignment,n=S.Component.as(k);null!=n&&null!=n.textOptions&&n.textOptions.rightToLeft&&(e==t.Base.Drawing.StiTextHorAlignment.Left?e=t.Base.Drawing.StiTextHorAlignment.Right:e==t.Base.Drawing.StiTextHorAlignment.Right&&(e=t.Base.Drawing.StiTextHorAlignment.Left)),i.Alignment=e}i.Text=l.toString().split("\n").join("")}}else i.StiPdfRenderText.renderTextFont(n),i.StiPdfRenderText.renderText(n);if(this.haveAnnots&&e.editable){this.pageStream.flush();let e=this.pageStream.position;this.pageStream.seek(r,t.System.IO.SeekOrigin.Begin);let i=[],n;this.pageStream.read(i,0,e-r),this.pageStream.seek(r,t.System.IO.SeekOrigin.Begin),this.pageStream.setLength(r),this.annotsArray[this.annotsCurrent].Content=i,this.annotsCurrent++,this.popColorFromStack()}}if(s.is(C))i.StiPdfRenderPrimitives.renderShape(S,d);else if(s.is(Y)&&!r){let t=new i.StiPdfGeomWriter(this.pageStream,this),e=i.StiBarCodeExportPainter.createNew(t),r=s;if(!w.isNullOrEmpty(r.codeValue)&&null!=r.page){this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("{0} {1} {2} {3} re W n",this.convertToString(S.X),this.convertToString(S.Y),this.convertToString(S.Width),this.convertToString(S.Height)),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(o),this.convertToString(n-l)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips));let t=m.unit.convertRectangleToHInches(r.clientRectangle);r.barCodeType.draw(e,r,t,1),this.pageStream.writeLine("Q"),this.popColorFromStack()}}else if(s.is(O)&&!r)this.pageStream.writeLine("q"),this.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(S.X),this.convertToString(S.Y+S.Height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",this.convertToString(this.hiToTwips/.96)),i.StiPdfRenderChart.renderChart(S,!1,$-1),this.pageStream.writeLine("Q"),this.popColorFromStack();else if(s.is(j)){let e=s;if(this.haveAnnots&&e.editable){let e=this.annots2Array[this.annots2Current];e.Multiline=!1,e.X=S.X,e.Y=S.Y,e.Width=S.Width,e.Height=S.Height,e.Component=S.Component,e.Alignment=t.Base.Drawing.StiTextHorAlignment.Center,e.Text="";let r=S.X,n=S.Y;S.X=0,S.Y=0,this.pageStream.flush();let s=this.pageStream.position;this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,i.StiPdfRenderPrimitives.renderCheckbox(S,!0),this.pageStream.flush();let o=this.pageStream.position;this.pageStream.seek(s,t.System.IO.SeekOrigin.Begin);let a=[];this.pageStream.read(a,0,o-s),this.pageStream.seek(s,t.System.IO.SeekOrigin.Begin),e.Content=a,this.popColorFromStack(),this.pageStream.flush(),s=this.pageStream.position,this.pushColorToStack(),this.lastColorStrokeA=255,this.lastColorNonStrokeA=255,i.StiPdfRenderPrimitives.renderCheckbox(S,!1,!1),this.pageStream.flush(),o=this.pageStream.position,this.pageStream.seek(s,t.System.IO.SeekOrigin.Begin),a=[],this.pageStream.read(a,0,o-s),this.pageStream.seek(s,t.System.IO.SeekOrigin.Begin),e.Content2=a,this.popColorFromStack(),this.annots2Current++,S.X=r,S.Y=n}else{let t=i.StiPdfRenderPrimitives.getCheckBoxValue(e);null!=t&&i.StiPdfRenderPrimitives.renderCheckbox(S,t)}}else r&&this.renderImage(S,d);if(s.is(F))i.StiPdfRenderPrimitives.renderRoundedRectanglePrimitive(S);else{let t=S.Component.as(D);null!=t&&null!=t.border&&t.border.topmost?g.push(S):i.StiPdfRenderPrimitives.renderBorder2(S)}this.usePdfA||s.printable||this.pageStream.writeLine("EMC")}if(this.haveBookmarks&&(!w.isNullOrEmpty(s.guid)||null!=s.bookmarkValue&&""!=s.bookmarkValue)){let t=0;while(t<this.bookmarksCounter){let e=this.bookmarksTree[t];if(0==e.Used&&-1==e.Page){let i=!1;if(w.isNullOrEmpty(e.Guid)?w.isNullOrEmpty(e.Title)||null!=s.bookmarkValue&&s.bookmarkValue.length>0&&e.Title==s.bookmarkValue&&(i=!0):w.isNullOrEmpty(s.guid)||e.Guid!=s.guid||(i=!0),i){e.Page=$-1,e.Y=S.Y+S.Height,e.Used=!0,this.bookmarksTree[t]=e;break}}t++}}if(null!=s.hyperlinkValue&&s.hyperlinkValue.toString().trim().length>0&&!s.hyperlinkValue.toString().trim().stimulsoft.startsWith("javascript:")&&!this.usePdfA){let t=new J;t.Link=s.hyperlinkValue.toString(),t.X=S.X,t.Y=S.Y,t.Width=S.Width,t.Height=S.Height,t.Page=$,t.DestPage=-1,t.DestY=-1,this.linksArray.push(t)}if(null!=s.tagValue&&s.tagValue.toString().trim().length>0){let t=new J;if(t.Link=s.tagValue.toString(),t.X=S.X,t.Y=S.Y,t.Width=S.Width,t.Height=S.Height,t.Page=$-1,t.DestPage=-1,t.DestY=-1,this.tagsArray.push(t),"pdfunsignedsignaturefield"==t.Link.trim().toLowerCase()&&!this.usePdfA){let e=new Q;e.X=t.X,e.Y=t.Y,e.Width=t.Width,e.Height=t.Height,e.Page=t.Page,e.Component=s,this.unsignedSignaturesArray.push(e)}}if(null!=s.toolTipValue&&s.toolTipValue.toString().trim().length>0&&!this.usePdfA){let t=new J;t.Link=s.toolTipValue.toString().trim(),t.X=S.X,t.Y=S.Y,t.Width=S.Width,t.Height=S.Height,t.Page=$-1,t.DestPage=-1,t.DestY=-1,this.tooltipsArray.push(t)}}for(let t of g)i.StiPdfRenderPrimitives.renderBorder2(t);if(g.stimulsoft.clear(),null!=r.border){let t=new V(this);t.X=o,t.Y=c,t.Width=s-o-a,t.Height=n-l-c;let e=new E;e.border=r.border,t.Component=e,i.StiPdfRenderPrimitives.renderBorder2(t)}this.renderWatermark(r,!1,s,n,d),this.renderPageFooter(n,s)}if(this.bookmarksTreeTemp=null,this.haveBookmarks&&y){for(let t=0;t<this.bookmarksTree.stimulsoft.countItems;t++){let e=this.bookmarksTree[t];if(e.Used)while(-1!=e.Parent)e=this.bookmarksTree[e.Parent],e.Used=!0}let t=new c;this.makeBookmarkFromTree(t,this.bookmarksTree[0]),this.bookmarksTreeTemp=this.bookmarksTree,this.bookmarksTree=new Array,this.addBookmarkNode(t,-1);let e=this.bookmarksCounter-this.bookmarksTree.stimulsoft.countItems;if(e>0){let t=new Z;t.Parent=-1,t.First=-1,t.Last=-1,t.Prev=-1,t.Next=-1,t.Count=-1,t.Page=-1,t.Y=-1,t.Title="";for(let i=0;i<e;i++)this.bookmarksTree.push(t)}let i=new T;for(let t=0;t<this.bookmarksTreeTemp.stimulsoft.countItems;t++){let e=this.bookmarksTreeTemp[t];i.set(e.Title,e)}for(let t=0;t<this.bookmarksTree.stimulsoft.countItems;t++){let e=this.bookmarksTree[t];if(!w.isNullOrEmpty(e.Title)){let t=i.get(e.Title);e.Page=t.Page,e.Y=t.Y}}this.bookmarksTreeTemp=null}this.renderImageTable(),this.renderFontTable(),this.renderBookmarksTable(),this.renderPatternTable(),this.renderLinkTable(),this.renderEncodeRecord(),this.renderExtGStateRecord(),this.renderAnnotTable(),this.renderTooltipTable(),this.renderMetadata(m),this.renderColorSpace(),this.renderAutoPrint(),this.renderEndDoc(),this.xref=null,this.bookmarksTree=null,this.linksArray=null,this.tagsArray=null,this.tooltipsArray=null,this.annotsArray=null,this.annots2Array=null,this.unsignedSignaturesArray=null,this.shadingArray=null,this.hatchArray=null,this.colorStack=null,this.pdfFont.clear(),this.pdfFont=null,this.bidi.clear(),this.bidi=null}}$.regexEscape=new RegExp("([{}()^$&.*?/+|[\\\\]|]|-)","g"),i.StiPdfExportService=$}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.System.StiArray,r=t.System.Text.StringBuilder,n=t.System.Drawing.Font,s=t.System.Collections.Hashtable,o=t.System.IO.MemoryStream,a=t.System.Drawing.FontStyle;class l{}e.PdfFontInfo=l;class m{}e.pfontInfo=m;class c{constructor(){this.TagString=null,this.Tag=0,this.CheckSum=0,this.Offset=0,this.Length=0,this.NewOffset=0,this.NewLength=0,this.Required=!1,this.NewTable=null}}class g{constructor(){this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.IndexCmapTable=0,this.FontName=null,this.HeaderOffset=0,this.NumTables=0,this.NumTablesRequired=0,this.SfntVersion=0,this.Tables=null,this.HeadCheckSumOffset=0,this.NumGlyphs=0,this.IndexToLocFormat=0,this.IndexLocaTable=0,this.IndexGlyfTable=0,this.FontName=new s}}class h extends l{constructor(){super(),this.standardFontQuantity=12,this.standardFontNumWidths=310,this.standardFontNumChars=3680+189,this.firstMappedSymbol=64,this.factor=1,this.maxSymbols=32767,this.forceUseUnicode=!0,this.WIDTHS=null,this.fonts=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.standardPdfFonts=!0,this.fontsInfoStore=null,this.family_Helvetica=["Arial","Arial Black","Arial Narrow","Century Gothic","Comic Sans MS","Impact","Microsoft Sans Serif","Tahoma","Verdana"],this.family_Courier=["Courier New","Lucida Console"],this.family_Times_Roman=["Book Antiqua","Bookman Old Style","Garamond","Georgia","Times New Roman"],this.family_Symbol=["Symbol"],this.family_ZapfDingbats=["Wingdings 2"],this.PdfFontName=["Helvetica","Helvetica-Bold","Helvetica-Oblique","Helvetica-BoldOblique","Times-Roman","Times-Bold","Times-Italic","Times-BoldItalic","Courier","Courier-Bold","Courier-Oblique","Courier-BoldOblique","Symbol","ZapfDingbats"],this._currentFont=-1,this.TtfHeaderSize=12,this.ARG_1_AND_2_ARE_WORDS=1,this.ARGS_ARE_XY_VALUES=2,this.ROUND_XY_TO_GRID=4,this.WE_HAVE_A_SCALE=8,this.MORE_COMPONENTS=32,this.WE_HAVE_AN_X_AND_Y_SCALE=64,this.WE_HAVE_A_TWO_BY_TWO=128,this.WE_HAVE_INSTRUCTIONS=256,this.USE_MY_METRICS=512,this.OVERLAP_COMPOUND=1024,this.SCALED_COMPONENT_OFFSET=2048,this.UNSCALED_COMPONENT_OFFSET=4096,this.TablesNames=["head","hhea","hmtx","maxp","cmap","OS/2","post","cvt ","fpgm","glyf","loca","prep","name"],this.fontList=new Array,this.UnicodeMapsList=new Array,this.GlyphMapsList=new Array,this.fontsInfoStore=new p}getFontMetrics(e,r,s,o){if(this.WIDTHS=i.create(Number,this.maxSymbols+1),null==e)return;let a=new n(e.name,1024,e.style,t.System.Drawing.GraphicsUnit.Pixel);i.copy(r.UnicodeMapBack,0,this.WIDTHS,r.MappedSymbolsCount);let l=t.System.Drawing.Graphics.measureChars(this.WIDTHS,r.MappedSymbolsCount,a),m=l.height,c=l.width;r.CH=0,r.tmASC=Math.round2(.8*m*this.factor),r.tmDESC=Math.round2(.2*m*this.factor),r.tmExternal=Math.round2((c-m)*this.factor),r.LLX=0,r.LLY=0,r.URX=0,r.URY=0,r.StemV=0,r.ItalicAngle=0,r.UnderscoreSize=Math.round2(m*(e.bold?.08:.06)*this.factor),r.UnderscorePosition=Math.round2(.1*-m*this.factor),r.StrikeoutSize=Math.round2(.045*m*this.factor),r.StrikeoutPosition=Math.round2(.25*m*this.factor);for(let t=0;t<r.MappedSymbolsCount;t++)this.WIDTHS[t]=Math.round2(this.WIDTHS[t]*this.factor,0);let g=this.getFontDataBuf(e,o);if(null!=g&&g.stimulsoft.is(Uint8Array)&&g.byteLength>0){let t=this.getCharToGlyphTable(g,e.name);if(null!=t){let i=0;"Wingdings"!=e.name&&"Wingdings 2"!=e.name&&"Wingdings 3"!=e.name||(i=61440);for(let e=0;e<r.MappedSymbolsCount;e++){let n=r.UnicodeMapBack[e];n>=128&&n<=255&&(n+=i),r.GlyphList[e]=t[n]}}}r.NeedSyntBold=this.NeedSyntBold,r.NeedSyntItalic=this.NeedSyntItalic}static isFontStimulsoft(t){return"Stimulsoft"==t}get currentFont(){return this._currentFont}set currentFont(t){this._currentFont!=t&&(this._currentFont=t,null!=this.fonts&&this.fonts.length>0&&(this.Widths=this.fonts[this._currentFont].Widths,this.CH=this.fonts[this._currentFont].CH,this.XH=this.fonts[this._currentFont].XH,this.ASC=this.fonts[this._currentFont].ASC,this.DESC=this.fonts[this._currentFont].DESC,this.tmASC=this.fonts[this._currentFont].tmASC,this.tmDESC=this.fonts[this._currentFont].tmDESC,this.tmExternal=this.fonts[this._currentFont].tmExternal,this.MacAscend=this.fonts[this._currentFont].MacAscend,this.MacDescend=this.fonts[this._currentFont].MacDescend,this.MacLineGap=this.fonts[this._currentFont].MacLineGap,this.LLX=this.fonts[this._currentFont].LLX,this.LLY=this.fonts[this._currentFont].LLY,this.URX=this.fonts[this._currentFont].URX,this.URY=this.fonts[this._currentFont].URY,this.StemV=this.fonts[this._currentFont].StemV,this.ItalicAngle=this.fonts[this._currentFont].ItalicAngle,this.LineGap=this.fonts[this._currentFont].LineGap,this.NtmFlags=this.fonts[this._currentFont].NtmFlags,this.UnderscoreSize=this.fonts[this._currentFont].UnderscoreSize,this.UnderscorePosition=this.fonts[this._currentFont].UnderscorePosition,this.StrikeoutSize=this.fonts[this._currentFont].StrikeoutSize,this.StrikeoutPosition=this.fonts[this._currentFont].StrikeoutPosition,this.UnicodeMap=this.fonts[this._currentFont].UnicodeMap,this.UnicodeMapBack=this.fonts[this._currentFont].UnicodeMapBack,this.GlyphList=this.fonts[this._currentFont].GlyphList,this.GlyphBackList=this.fonts[this._currentFont].GlyphBackList,this.GlyphRtfList=this.fonts[this._currentFont].GlyphRtfList,this.SymsToPDF=this.fonts[this._currentFont].SymsToPDF,this.CharPdfNames=this.fonts[this._currentFont].CharPdfNames,this.MappedSymbolsCount=this.fonts[this._currentFont].MappedSymbolsCount,this.NeedSyntBold=this.fonts[this._currentFont].NeedSyntBold,this.NeedSyntItalic=this.fonts[this._currentFont].NeedSyntItalic,this.GlyphWidths=this.fonts[this._currentFont].GlyphWidths,this.ChildFontsMap=this.fonts[this._currentFont].ChildFontsMap,this.UseUnicode=this.fonts[this._currentFont].UseUnicode))}InitFontsData(t){let r=this.fontList.length;for(let e=0;e<r;e++){let r=this.fontList[e],n=this.forceUseUnicode;if(n){let e=null;e=this.getFontDataBuf(r.Font,t),null!=e&&0!=e.Length||(n=!1)}if(r.UseUnicode=n,this.fontList[e]=r,!n){let t=this.UnicodeMapsList[e],s=this.firstMappedSymbol;for(let e=this.firstMappedSymbol;e<65536;e++)t[e]>0&&s++;if(s>255){r=this.fontList[e];let o=null,a=i.create(Number,65536),l=this.fontList.length;for(let t=0;t<this.firstMappedSymbol;t++)a[t]=l;let c=!0;s=this.firstMappedSymbol;for(let g=this.firstMappedSymbol;g<65536;g++){if(c){let a=new m;a.Name=r.Name,a.PdfName=r.PdfName,a.Bold=r.Bold,a.Italic=r.Italic,a.Number=r.Number,a.Font=r.Font,a.ParentFontNumber=e,a.UseUnicode=n,this.fontList.push(a),o=i.create(Number,65536),i.copy(t,0,o,64),this.UnicodeMapsList.push(o),this.GlyphMapsList.push(i.create(Number,65536)),l=this.fontList.length-1,s=this.firstMappedSymbol,c=!1}t[g]>0&&(o[g]=1,a[g]=l,s++,254==s&&(c=!0))}r.ChildFontsMap=a,this.fontList[e]=r}}}this.fonts=i.create(l,this.fontList.length);for(let r=0;r<this.fontList.length;r++){this.fonts[r]=new l;let n=this.fonts[r];n.UnicodeMap=this.UnicodeMapsList[r],n.UnicodeMapBack=i.create(Number,this.maxSymbols+1),n.UseUnicode=this.fontList[r].UseUnicode;let s=this.GlyphMapsList[r],o=i.create(Number,65536);s[65535];let a=this.firstMappedSymbol;for(let t=this.firstMappedSymbol;t<65536;t++)0!=n.UnicodeMap[t]&&(n.UnicodeMap[t]=a,n.UnicodeMapBack[a]=t,a++,a>this.maxSymbols&&(a=this.maxSymbols),n.UseUnicode||92!=a||(n.UnicodeMapBack[a]=t,a++));let m=8226;n.UnicodeMap[m]=a,n.UnicodeMapBack[a]=m,a++,n.MappedSymbolsCount=a;for(let t=0;t<this.firstMappedSymbol;t++)n.UnicodeMap[t]=t,n.UnicodeMapBack[t]=t;n.CharPdfNames=i.create(String,a),n.SymsToPDF=i.create(Number,a);for(let t=32;t<n.MappedSymbolsCount;t++){let i=-1;for(let t=0;t<this.standardFontNumWidths;t++);n.SymsToPDF[t]=i;let r=e.StiPdfResources.standardFontCharsNames[n.UnicodeMapBack[t]];null==r&&(r="uni"+n.UnicodeMapBack[t].toString(16).toUpperCase().stimulsoft.padLeft(4,"0")),n.CharPdfNames[t]=r}n.GlyphList=i.create(Number,a);let c=this.fontList[r];this.fonts[r].Widths=i.create(Number,a),this.getFontMetrics(c.Font,n,s,t);for(let t=0;t<a-32;t++)this.fonts[r].Widths[t]=this.WIDTHS[32+t];this.standardPdfFonts,null!=this.fontList[r].ChildFontsMap&&(n.MappedSymbolsCount=255,n.ChildFontsMap=this.fontList[r].ChildFontsMap)}this._currentFont=-1,this.currentFont=0}getFontNumber(t){let e=-1;if(this.fontList.length>0)for(let i=0;i<this.fontList.length;i++){let r=this.fontList[i];if(r.Name==t.name&&r.Bold==t.bold&&r.Italic==t.italic){e=i;break}}if(-1==e){let r=new m;r.Name=t.name,r.Bold=t.bold,r.Italic=t.italic,r.Font=t,r.ParentFontNumber=-1,e=0;for(let t of this.family_Helvetica)r.Name==t&&(e=0);for(let t of this.family_Times_Roman)r.Name==t&&(e=4);for(let t of this.family_Courier)r.Name==t&&(e=8);e<12&&(1==r.Bold&&(e+=1),1==r.Italic&&(e+=2)),r.Number=e,r.PdfName=this.PdfFontName[e],this.fontList.push(r),e=this.fontList.length-1,this.UnicodeMapsList.push(i.create(Number,65536)),this.GlyphMapsList.push(i.create(Number,65536))}return this.currentFont=e,e}storeUnicodeSymbolsInMap(t){if(t.length>0&&-1!=this.currentFont){let e=this.UnicodeMapsList[this.currentFont];for(let i=0;i<t.length;i++)e[t.charCodeAt(i)]=1}}getCharToGlyphTable(t,e){let i=this.scanFontFile(t,e);if(null!=i)return this.getCmapTable(t,i);return null}reduceFontSize(t,e,r){let n=this.scanFontFile(t,e),s=null;if(null!=n){if(r){let e=i.create(Boolean,n.NumGlyphs),r=i.create(Boolean,n.NumGlyphs);for(let t=0;t<this.GlyphList.length;t++){let i=this.GlyphList[t];i<n.NumGlyphs&&(e[i]=!0,r[i]=!0)}e[0]=!0,e[1]=!0,e[2]=!0,e[3]=!0,r[0]=!0,r[1]=!0,r[2]=!0,r[3]=!0;let s=n.Tables[n.IndexLocaTable].Offset,o=n.Tables[n.IndexGlyfTable].Offset,a=!0;while(a){a=!1;for(let i=0;i<n.NumGlyphs;i++)if(1==r[i]){r[i]=!1;let l=s+i*(1==n.IndexToLocFormat?4:2),m=0;if(m=1==n.IndexToLocFormat?this.GetUInt32(t,l):2*this.GetUInt16(t,l),m+=o,-1==this.GetInt16(t,m)){a=!0,m+=10;let i=0;do{i=this.GetUInt16(t,m);let s=this.GetUInt16(t,m+2);s<n.NumGlyphs&&(e[s]=!0,r[s]=!0),m+=4,(i&this.ARG_1_AND_2_ARE_WORDS)>0?(m+=2,m+=2):m+=2,(i&this.WE_HAVE_A_SCALE)>0?m+=2:(i&this.WE_HAVE_AN_X_AND_Y_SCALE)>0?(m+=2,m+=2):(i&this.WE_HAVE_A_TWO_BY_TWO)>0&&(m+=2,m+=2,m+=2,m+=2)}while((i&this.MORE_COMPONENTS)>0)}}}let l=0,m=s;for(let i=0;i<n.NumGlyphs;i++){let r=0,s=0;1==n.IndexToLocFormat?(r=this.GetUInt32(t,m),s=this.GetUInt32(t,m+4),m+=4):(r=2*this.GetUInt16(t,m),s=2*this.GetUInt16(t,m+2),m+=2),e[i]&&(l+=s-r)}let c=new Uint8Array(l+4),g=new Uint8Array(n.Tables[n.IndexLocaTable].Length+4),h=0;m=s;let p=0;for(let i=0;i<n.NumGlyphs;i++){let r=0,s=0;1==n.IndexToLocFormat?(r=this.GetUInt32(t,m),s=this.GetUInt32(t,m+4),m+=4):(r=2*this.GetUInt16(t,m),s=2*this.GetUInt16(t,m+2),m+=2);let a=s-r;if(1==e[i])for(let e=0;e<a;e++)c[h+e]=t[o+r+e];else a=0;0==n.IndexToLocFormat?this.SetUInt16(g,p,h/2):this.SetUInt32(g,p,h),h+=a,p+=1==n.IndexToLocFormat?4:2}0==n.IndexToLocFormat?this.SetUInt16(g,p,h/2):this.SetUInt32(g,p,h),n.Tables[n.IndexGlyfTable].NewLength=h,n.Tables[n.IndexGlyfTable].NewTable=c,n.Tables[n.IndexLocaTable].NewTable=g}let e=new Uint8Array(this.TtfHeaderSize+16*n.NumTablesRequired);this.copyUint8Array(t,n.HeaderOffset,e,0,e.length);let a=1;while(2<<a-1<=n.NumTablesRequired)a++;a--;let l=16*(2<<a-1),m=a,c=16*n.NumTablesRequired-l;this.SetUInt16(e,4,n.NumTablesRequired),this.SetUInt16(e,6,l),this.SetUInt16(e,8,m),this.SetUInt16(e,10,c);let g=0,h=this.TtfHeaderSize+16*n.NumTablesRequired;for(let t=0;t<n.NumTables;t++)if(n.Tables[t].Required){n.Tables[t].NewOffset=h,h+=n.Tables[t].NewLength;let i=h%4;i>0&&(h+=4-i);let r=this.TtfHeaderSize+16*g;this.SetUInt32(e,r,n.Tables[t].Tag),this.SetUInt32(e,r+4,n.Tables[t].CheckSum),this.SetUInt32(e,r+8,n.Tables[t].NewOffset),this.SetUInt32(e,r+12,n.Tables[t].NewLength),g++}s=new o,s.writeBytes(e,0,e.length);for(let e=0;e<n.NumTables;e++)if(n.Tables[e].Required){null!=n.Tables[e].NewTable?s.writeBytes(n.Tables[e].NewTable,0,n.Tables[e].NewLength):s.writeBytes(t,n.Tables[e].Offset,n.Tables[e].NewLength);let r=n.Tables[e].NewLength%4;r>0&&s.write(i.create(Number,4-r),0,4-r)}s.flush()}return s}scanFontFile(t,e){let i=null,r=this.GetUInt32(t,0);if(65536==r)i=this.getTtfInfo(t,0);else{let n=this.GetUInt32(t,4);if(1953784678==r&&(65536==n||131072==n)){let r;for(let r=this.GetUInt32(t,8)-1;r>=0;r--){let n=this.GetUInt32(t,12+4*r),s;if(65536==this.GetUInt32(t,n)&&(i=this.getTtfInfo(t,n),i.FontName.contains(e)))break}}}return i}getCmapTable(t,e){let r=null,n=e.Tables[e.IndexCmapTable].Offset,s=this.GetUInt16(t,n+2);for(let e=0;e<s;e++){let s=n+4+8*e,o=this.GetUInt16(t,s),a=this.GetUInt16(t,s+2),l=n+this.GetUInt32(t,s+4);if(3==o&&1==a){let e;if(4==this.GetUInt16(t,l)){r=i.create(Number,65536);for(let t=0;t<65536;t++)r[t]=65535;let e=this.GetUInt16(t,l+6);for(let i=0;i<e;i+=2){let n=l+14+i,s=this.GetUInt16(t,n),o=this.GetUInt16(t,n+2+e),a=this.GetInt16(t,n+2+2*e),m=this.GetUInt16(t,n+2+3*e);if(65535!=o)for(let i=o;i<=s;i++){let s=65535;if(0==m)s=a+i&65535;else{let r=m+2*(i-o)+(n+2+3*e);s=this.GetUInt16(t,r),0!=s&&(s+=a)}r[i]=s}}}}}return r}copyUint8Array(t,e,i,r,n){for(let s=0;s<n;s++)i[r+s]=t[e+s]}getTtfInfo(t,e){let i=new g;i.HeaderOffset=e,i.SfntVersion=this.GetUInt32(t,i.HeaderOffset),i.NumTables=this.GetUInt16(t,i.HeaderOffset+4),i.NumTablesRequired=0,i.Tables=[];for(let t=0;t<i.NumTables;t++)i.Tables[t]=new c;for(let e=0;e<i.NumTables;e++){let n=i.HeaderOffset+this.TtfHeaderSize+16*e,s=new r;for(let e=0;e<4;e++)s.append(String.fromCharCode(this.GetUInt8(t,n+e)));i.Tables[e].Tag=this.GetUInt32(t,n),i.Tables[e].TagString=s.toString(),i.Tables[e].CheckSum=this.GetUInt32(t,n+4),i.Tables[e].Offset=this.GetUInt32(t,n+8),i.Tables[e].Length=this.GetUInt32(t,n+12),i.Tables[e].NewLength=i.Tables[e].Length;for(let t=0;t<this.TablesNames.length;t++)if(i.Tables[e].TagString==this.TablesNames[t]){i.Tables[e].Required=!0,i.NumTablesRequired++;break}switch(i.Tables[e].TagString){case"head":i.IndexToLocFormat=this.GetUInt16(t,i.Tables[e].Offset+50);break;case"maxp":i.NumGlyphs=this.GetUInt16(t,i.Tables[e].Offset+4);break;case"loca":i.IndexLocaTable=e;break;case"glyf":i.IndexGlyfTable=e;break;case"cmap":i.IndexCmapTable=e;break;case"name":{let n=i.Tables[e].Offset,s=this.GetUInt16(t,n+2),o=this.GetUInt16(t,n+4);for(let e=0;e<s;e++){let s=n+6+12*e,a=this.GetUInt16(t,s),l=this.GetUInt16(t,s+2),m=this.GetUInt16(t,s+6),c=this.GetUInt16(t,s+8),g=this.GetUInt16(t,s+10);if(3==a&&1==l&&1==m||0==a&&3==l&&1==m){let e=new r;for(let i=0;i<c/2;i++)e.append(String.fromCharCode(this.GetUInt16(t,n+o+g+2*i)));let s=e.toString();i.FontName.set(s,s)}}break}}}return i}GetUInt8(t,e){return t[e]}GetUInt16(t,e){return(t[e]<<8)+t[e+1]}GetUInt32(t,e){return(t[e]<<24)+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3]}GetInt16(t,e){let i=(t[e]<<8)+t[e+1];return i>32767?i-65536:i}SetUInt16(t,e,i){t[e+0]=i>>>8&255,t[e+1]=255&i}SetUInt32(t,e,i){t[e+0]=i>>>24&255,t[e+1]=i>>>16&255,t[e+2]=i>>>8&255,t[e+3]=255&i}clear(){this.fonts=null,this.fontList=null,this.UnicodeMapsList=null,this.GlyphMapsList=null,this.Widths=null,this.CharPdfNames=null,this.UnicodeMap=null,this.UnicodeMapBack=null,this.GlyphList=null,this.GlyphBackList=null,this.GlyphRtfList=null,this.SymsToPDF=null,this.GlyphWidths=null,this.fontsInfoStore.clear()}getFontDataBuf(t,e){return this.getFontDataFromGdi(t,e)}getFontDataFromGdi(e,i){let r=null;if(h.isFontStimulsoft(e.name)){let e=t.Report.Resources.StimulsoftFont.getBase64Content(),i=t.System.Convert.fromBase64String(e);return new Uint8Array(i)}let n=t.Base.StiFontCollection.getBinFont(e.name,e.style);if(r=null!=n?n.data:null,null==r||r.stimulsoft.is(Uint8Array)||(r=null),null==r){let i=(e.style&a.Bold)>0,s=(e.style&a.Italic)>0;i&&s?(n=t.Base.StiFontCollection.getBinFont(e.name,a.Italic),null!=n&&null!=n.data?(r=n.data,this.NeedSyntBold=!0):(n=t.Base.StiFontCollection.getBinFont(e.name,a.Bold),null!=n&&null!=n.data?(r=n.data,this.NeedSyntItalic=!0):(n=t.Base.StiFontCollection.getBinFont(e.name,a.Regular),null!=n&&null!=n.data&&(r=n.data,this.NeedSyntItalic=!0,this.NeedSyntBold=!0)))):(i&&(n=t.Base.StiFontCollection.getBinFont(e.name,a.Regular),null!=n&&null!=n.data&&(r=n.data,this.NeedSyntBold=!0)),s&&(n=t.Base.StiFontCollection.getBinFont(e.name,a.Regular),null!=n&&null!=n.data&&(r=n.data,this.NeedSyntItalic=!0)))}if(null==r){let t=i.dictionary.resources.getByName(e.name);null==t&&(t=i.dictionary.resources.getByAlias(e.name)),null!=t&&null!=t.content&&t.content.length>0&&(r=new Uint8Array(t.content),this.NeedSyntBold=!0,this.NeedSyntItalic=!0)}return r}}e.PdfFonts=h;class p{clear(){}}e.FontsInfoStore=p}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.Report.Components.StiImage,r=t.System.StiArray,n=t.System.StiString,s=t.System.Drawing.Point,o=t.System.Drawing.Rectangle,a=t.System.Text.StringBuilder,l=t.Base.Context.StiPenGeom,m=t.System.Drawing.Color,c=t.Base.Drawing.StiBrush,g=t.Base.Drawing.StiGradientBrush,h=t.Base.Drawing.StiGlareBrush,p=t.Base.Drawing.StiHatchBrush,w=t.Base.Drawing.StiGlassBrush,S=t.Base.Drawing.StiPenStyle,d=t.Base.Drawing.StiPenUtils,u=t.System.Drawing.Drawing2D.DashStyle,f=t.System.Drawing.StringFormat,E=t.Report.Components.StiText,v=t.System.Drawing.Rectangle,b=t.System.Drawing.StringAlignment,y=t.Base.Drawing.StiTextHorAlignment,x=t.Base.Drawing.StiVertAlignment,A=t.System.Drawing.StringFormatFlags,T=t.System.Drawing.Size;class P{constructor(t,e,i=!1){this.penWidthDefault=.1,this.precision_digits=3,this.hiToTwips=.72,this.pdfCKT=.55228,this.makepath=!1,this.pathClosed=!1,this.path=null,this.pageStream=null,this.pdfService=null,this.assembleData=!1,this.pageNumber=0,this.matrixCache=null,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,this.pageStream=t,this.pdfService=e,this.assembleData=i,this.matrixCache=new Array}calculateMinMax(t){null==this.xmin?this.xmin=t.x:this.xmin=Math.min(this.xmin,t.x),null==this.xmax?this.xmax=t.x:this.xmax=Math.max(this.xmax,t.x),null==this.ymin?this.ymin=t.y:this.ymin=Math.min(this.ymin,t.y),null==this.ymax?this.ymax=t.y:this.ymax=Math.max(this.ymax,t.y)}convertToString(e){return Math.round2(e,this.precision_digits).toString().stimulsoft.replaceAll(",",t.System.Globalization.CultureInfo.currentCulture.numberFormat.numberDecimalSeparator)}setPen(e,i=!1){if(null==e)return!1;let r=!1;if(e.stimulsoft.is(t.Base.Context.StiPenGeom)){let t=e.stimulsoft.as(l),n=m.transparent;t.brush.stimulsoft.is(m)&&(n=t.brush.stimulsoft.as(m)),t.brush.stimulsoft.is(c)&&(n=c.toColor(t.brush.stimulsoft.as(c))),this.pdfService.setStrokeColor(n);let s=t.thickness>1?t.thickness:t.thickness*this.hiToTwips;0==s&&(s=this.penWidthDefault),this.pageStream.writeLine1("{0} w",this.convertToString(s)),r=i&&t.penStyle!=S.Solid,r&&this.pageStream.writeLine("q");let o=this.getPenStyleDashString(d.getPenStyle(t.penStyle),.025*t.thickness);null!=o&&this.pageStream.writeLine(o)}return r}setBrush(t,e,i=!1){if(null==t)return!1;if(this.assembleData)return(t.stimulsoft.is(g)||t.stimulsoft.is(h)||t.stimulsoft.is(p)||t.stimulsoft.is(w))&&(this.pdfService.storeShadingData1(t.stimulsoft.as(c),this.pageNumber),this.pdfService.storeHatchData(t.stimulsoft.as(c))),!1;let r=!1,n=m.transparent;if(t.stimulsoft.is(m)&&(n=t.stimulsoft.as(m)),t.stimulsoft.is(c)&&(n=c.toColor(t.stimulsoft.as(c))),this.pdfService.setNonStrokeColor(n),t.stimulsoft.is(g)||t.stimulsoft.is(h)||t.stimulsoft.is(p)||t.stimulsoft.is(w)){let i=this.matrixCache.stimulsoft.peek(),n,a,l=[new s(e.x,e.bottom),new s(e.right,e.y)];i.transformPoints(l);let m=new o(l[0].x,l[0].y,l[1].x-l[0].x,l[1].y-l[0].y),w=this.pdfService.storeShadingData2(m.x,m.y,m.width,m.height,t.stimulsoft.as(c));if((t.stimulsoft.is(g)||t.stimulsoft.is(h))&&this.pageStream.writeLine1("/Pattern cs /P{0} scn",1+w),t.stimulsoft.is(p)){let e=t.stimulsoft.as(p);this.pageStream.writeLine1("/Cs1 cs /PH{0} scn",this.pdfService.getHatchNumber(e)+1)}r=!0}return r=r&&i,r&&this.pageStream.writeLine("q"),r}outputLineString(t,e){if(null!=e){let i=this.setPen(e,!0);this.pageStream.writeLine(t),i&&this.pageStream.writeLine("Q")}}convertArcToBezierPoints(t,e,i){let n=t.x+t.width/2,o=t.y+t.height/2,a=t.width/2;e*=Math.PI/180,i*=Math.PI/180;let l=Math.ceil(Math.abs(i)/(Math.PI/2)),m=r.create(s,3*l+1,!0),c=i/l,g=Math.sin(c/2),h=Math.cos(c/2),p=4*(1-h)/3,w=g-p*h/(g+1e-4),S=[],d=[];S[0]=h,d[0]=-g,S[1]=h+p,d[1]=-w,S[2]=h+p,d[2]=w,S[3]=h,d[3]=g;let u=Math.sin(e+c/2),f=Math.cos(e+c/2);m[0].x=n+a*(S[0]*f-d[0]*u),m[0].y=o+a*(S[0]*u+d[0]*f);for(let t=0;t<l;t++){let i=e+c*t;u=Math.sin(i+c/2),f=Math.cos(i+c/2);for(let e=1;e<=3;e++)m[e+3*t].x=n+a*(S[e]*f-d[e]*u),m[e+3*t].y=o+a*(S[e]*u+d[e]*f)}return m}convertSplineToCubicBezier(t,e){let i=t.length,r=3*i-2,n=[];e*=.3,n[0]=t[0],n[1]=this.calculateCurveBezierEndPoints(t[0],t[1],e);for(let r=0;r<i-2;r++){let i=this.calculateCurveBezier(t,r,e);n[3*r+2]=i[0],n[3*r+3]=t[r+1],n[3*r+4]=i[1]}return n[r-2]=this.calculateCurveBezierEndPoints(t[i-1],t[i-2],e),n[r-1]=t[i-1],n}calculateCurveBezier(t,e,i){let r=t[e+2].x-t[e+0].x,n=t[e+2].y-t[e+0].y,o,a;return[new s(t[e+1].x-i*r,t[e+1].y-i*n),new s(t[e+1].x+i*r,t[e+1].y+i*n)]}calculateCurveBezierEndPoints(t,e,i){return new s(i*(e.x-t.x)+t.x,i*(e.y-t.y)+t.y)}getPointString(t){return this.calculateMinMax(t),n.format("{0} {1} {2} ",this.convertToString(t.x),this.convertToString(t.y),this.makepath&&this.path.length>0?"l":"m")}getLineToString(t){return this.calculateMinMax(t),n.format("{0} {1} l ",this.convertToString(t.x),this.convertToString(t.y))}getRectString4(t,e,i,r){return this.getRectString(new o(t,e,i,r))}getRectString(t){return n.format("{0} {1} {2} {3} re ",this.convertToString(t.x),this.convertToString(t.top),this.convertToString(t.right-t.x),this.convertToString(t.bottom-t.y))}getBezierString(t,e,i){return this.calculateMinMax(t),this.calculateMinMax(e),this.calculateMinMax(i),n.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t.x),this.convertToString(t.y),this.convertToString(e.x),this.convertToString(e.y),this.convertToString(i.x),this.convertToString(i.y))}getBezierString2(t,e,i,r,o,a){return this.calculateMinMax(new s(t,e)),this.calculateMinMax(new s(i,r)),this.calculateMinMax(new s(o,a)),n.format("{0} {1} {2} {3} {4} {5} c ",this.convertToString(t),this.convertToString(e),this.convertToString(i),this.convertToString(r),this.convertToString(o),this.convertToString(a))}getPolylineString(t,e,i){let r=new a;i||r.append(this.getPointString(t[0]));for(let e=i?0:1;e<t.length;e++)r.append(this.getLineToString(t[e]));return e&&r.append("h "),r.toString()}getEllipseString4(t,e,i,r){return this.getEllipseString(new o(t,e,i,r))}getEllipseString(t){let e=t.width/2*(1-this.pdfCKT),i=t.height/2*(1-this.pdfCKT),r=new a;return r.appendFormat("{0} {1} m ",this.convertToString(t.x),this.convertToString(t.y+t.height/2)),r.append(this.getBezierString2(t.x,t.y+t.height-i,t.x+e,t.y+t.height,t.x+t.width/2,t.y+t.height)),r.append(this.getBezierString2(t.x+t.width-e,t.y+t.height,t.x+t.width,t.y+t.height-i,t.x+t.width,t.y+t.height/2)),r.append(this.getBezierString2(t.x+t.width,t.y+i,t.x+t.width-e,t.y,t.x+t.width/2,t.y)),r.append(this.getBezierString2(t.x+e,t.y,t.x,t.y+i,t.x,t.y+t.height/2)),r.toString()}getPenStyleDashString(t,e){switch(t){case u.Dot:return n.format("[{0} {1}] 0 d",this.convertToString(e),this.convertToString(58*e));case u.Dash:return n.format("[{0} {1}] 0 d",this.convertToString(49.5*e),this.convertToString(62*e));case u.DashDot:return n.format("[{0} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e));case u.DashDotDot:return n.format("[{0} {1} {2} {1} {2} {1}] 0 d",this.convertToString(50*e),this.convertToString(55*e),this.convertToString(e))}return null}beginPath(){if(this.assembleData)return;this.path=new a,this.makepath=!0,this.pathClosed=!1,this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null}closeFigure(){if(this.assembleData)return;this.path.append("h "),this.pathClosed=!0}endPath(){if(this.assembleData)return;this.makepath=!1}fillPath(t){let e=this.assembleData?new o:new o(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),i=this.setBrush(t,e,!0);if(this.assembleData)return;this.pathClosed||this.endPath(),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("f"),i&&this.pageStream.writeLine("Q")}strokePath(t){if(this.assembleData)return;this.setPen(t),this.pageStream.writeString(this.path.toString()),this.pageStream.writeLine("S")}moveTo(t){if(this.assembleData)return;this.lastPoint=t;let e=this.getPointString(t);this.makepath?this.path.appendLine(e):this.pageStream.writeLine(e)}drawLine(t,e,i){if(this.assembleData)return;let r=this.getPointString(t)+this.getLineToString(e);this.makepath?this.path.appendLine(r):this.outputLineString(r+"S",i),this.lastPoint=e}drawLineTo(t,e){if(this.assembleData)return;let i=this.getLineToString(t);this.makepath?this.path.appendLine(i):this.outputLineString(i+"S",e),this.lastPoint=t}drawRectangle(t,e){if(this.assembleData)return;this.outputLineString(this.getRectString(t)+"S",e)}fillRectangle(t,e){let i=this.setBrush(e,t,!0);if(this.assembleData)return;null!=e&&this.pageStream.writeLine(this.getRectString(t)+"f"),i&&this.pageStream.writeLine("Q")}drawPolygon(t,e){this.drawPolyline(t,e,!0)}drawPolyline(t,e,i=!1,r=!1){if(this.assembleData)return;let n=this.getPolylineString(t,i,r);this.makepath?this.path.appendLine(n):this.outputLineString(n+"S",e),this.lastPoint=t[t.length-1]}drawPolylineTo(t,e){this.drawPolyline(t,e,!1,!0)}fillPolygon(t,e){for(let e of t)this.calculateMinMax(e);let i=new o(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r=this.setBrush(e,i,!0);if(this.assembleData)return;if(null!=e){let e=this.getPolylineString(t,!0,!1);this.pageStream.writeLine(e+"f")}r&&this.pageStream.writeLine("Q")}drawBezier(t,e,i,r,n){if(this.assembleData)return;let s=this.getPointString(t)+this.getBezierString(e,i,r);this.makepath?this.path.appendLine(s):this.outputLineString(s+"S",n),this.lastPoint=r}drawBezierTo(t,e,i,r){if(this.assembleData)return;let n=this.getBezierString(t,e,i);this.makepath?this.path.appendLine(n):this.outputLineString(n+"S",r),this.lastPoint=i}drawSpline(t,e,i){if(this.assembleData)return;let r=this.convertSplineToCubicBezier(t,e),n=(r.length-1)/3,s=new a;s.append(this.getPointString(r[0])+this.getBezierString(r[1],r[2],r[3]));for(let t=1;t<n;t++)s.append(this.getBezierString(r[3*t+1],r[3*t+2],r[3*t+3]));this.makepath?this.path.appendLine(s.toString()):this.outputLineString(s.toString()+"S",i),this.lastPoint=r[r.length-1]}drawArc(t,e,i){if(this.assembleData)return;let r=this.convertArcToBezierPoints(t,e,i),n=(r.length-1)/3;this.drawBezier(r[0],r[1],r[2],r[3],null);for(let t=1;t<n;t++)this.drawBezierTo(r[3*t+1],r[3*t+2],r[3*t+3],null)}drawEllipse(t,e){if(this.assembleData)return;this.outputLineString(this.getEllipseString(t)+"S",e)}fillEllipse(t,e){let i=this.setBrush(e,t,!0);if(this.assembleData)return;null!=e&&this.pageStream.writeLine(this.getEllipseString(t)+"f"),i&&this.pageStream.writeLine("Q")}drawPie(t,e,i){if(this.assembleData)return;let r=this.convertArcToBezierPoints(t,e,i),n=(r.length-1)/3,o=t.x+t.width/2,a=t.y+t.height/2;this.drawBezier(r[0],r[1],r[2],r[3],null);for(let t=1;t<n;t++)this.drawBezierTo(r[3*t+1],r[3*t+2],r[3*t+3],null);this.drawLineTo(new s(o,a),null),this.drawLineTo(r[0],null)}drawString(t,i,r,n,s){if(this.assembleData){if(null!=i){let t=this.pdfService.pdfFont.getFontNumber(i)}return void this.pdfService.pdfFont.storeUnicodeSymbolsInMap(t)}let o=new E;o.clientRectangle=new v(n.x,n.y,n.width,n.height),o.text=t,o.font=i,o.textBrush=r,s||(s=new f),s.alignment==b.Center&&(o.horAlignment=y.Center),s.alignment==b.Far&&(o.horAlignment=y.Right),s.lineAlignment==b.Center&&(o.vertAlignment=x.Center),s.lineAlignment==b.Far&&(o.vertAlignment=x.Bottom),0==(s.formatFlags&A.NoWrap)&&(o.wordWrap=!0);let a=new e.StiPdfData(this.pdfService);a.Component=o,a.Width=n.width*this.hiToTwips,a.Height=n.height*this.hiToTwips,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(n.x),this.convertToString(n.y+n.height)),this.pageStream.writeLine("1.39 0 0 -1.39 0 0 cm"),e.StiPdfRenderText.renderTextFont(a),e.StiPdfRenderText.renderText(a),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()}saveState(){if(this.assembleData)return;this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.matrixCache.length>0&&this.matrixCache.push(this.matrixCache.stimulsoft.peek().clone())}restoreState(){if(this.assembleData)return;this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack(),this.matrixCache.length>0&&this.matrixCache.pop()}translateTransform(t,e){if(this.assembleData)return;this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(t),this.convertToString(e)),this.matrixCache.length>0&&this.matrixCache.stimulsoft.peek().translate(t,e)}rotateTransform(t){if(this.assembleData)return;let e=t*Math.PI/180;this.pageStream.writeLine1("{0} {1} {2} {3} 0 0 cm",this.convertToString(Math.cos(e)),this.convertToString(Math.sin(e)),this.convertToString(-Math.sin(e)),this.convertToString(Math.cos(e))),this.matrixCache.length>0&&this.matrixCache.stimulsoft.peek().rotate(t)}setClip(t){if(this.assembleData)return;this.pageStream.writeLine(this.getRectString(t)+"W n")}drawArc2(t,e,i,r){}drawText(t,e,i,r,n,s,o){}setPixel(t,e){}measureString(t,e){return new T(0,0)}drawImage(t,r){let n=new i;if(n.clientRectangle=r,n.imageToDraw=t,n.smoothing=!0,n.stretch=!0,this.assembleData)return void this.pdfService.storeImageDataForGeom(n);let s=new e.StiPdfData(this.pdfService);s.Component=n,s.Width=r.width,s.Height=r.height,this.pageStream.writeLine("q"),this.pdfService.pushColorToStack(),this.pageStream.writeLine1("1 0 0 1 {0} {1} cm",this.convertToString(r.x),this.convertToString(r.y+r.height)),this.pageStream.writeLine("1 0 0 -1 0 0 cm"),this.pdfService.renderImage(s,100),this.pageStream.writeLine("Q"),this.pdfService.popColorFromStack()}}e.StiPdfGeomWriter=P}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.System.Drawing.Color,r=t.System.Drawing.Graphics,n=t.Base.Context.StiContext,s=t.Base.Context.StiContextPainter,o=t.System.Drawing.Point,a=t.System.Drawing.Point,l=t.System.Drawing.Rectangle,m=t.System.Drawing.Rectangle,c=t.System.Drawing.StringFormat,g=t.Base.Drawing.StiRotationMode,h=t.Base.Context.StiPushTranslateTransformGeom,p=t.Base.Context.StiPushRotateTransformGeom,w=t.Base.Context.StiPopTransformGeom,S=t.Base.Context.StiBorderGeom,d=t.Base.Context.StiLineGeom,u=t.Base.Context.StiLinesGeom,f=t.Base.Context.StiPushClipGeom,E=t.Base.Context.StiPopClipGeom,v=t.Base.Context.StiPushSmothingModeToAntiAliasGeom,b=t.Base.Context.StiPopSmothingModeGeom,y=t.Base.Context.StiPushTextRenderingHintToAntiAliasGeom,x=t.Base.Context.StiPopTextRenderingHintGeom,A=t.Base.Context.StiCurveGeom,T=t.Base.Context.StiEllipseGeom,P=t.Base.Context.StiCachedShadowGeom,L=t.Base.Drawing.StiShadowSides,C=t.Base.Drawing.StiSolidBrush,F=t.Base.Context.StiShadowGeom,R=t.Base.Context.StiTextGeom,B=t.Base.Context.StiPathGeom,I=t.Base.Context.StiPieSegmentGeom,k=t.Base.Context.StiArcSegmentGeom,D=t.Base.Context.StiLineSegmentGeom,N=t.Base.Context.StiLinesSegmentGeom,H=t.Base.Context.StiCurveSegmentGeom,O=t.Base.Context.StiCloseFigureSegmentGeom,M=t.System.Drawing.Drawing2D.Matrix,U=t.Report.Chart.IStiChart,X=t.Base.Drawing.StiPenStyle,W=t.System.Drawing.Font,z=t.Base.Drawing.StiBrush,j=t.Report.Components.StiImageRotation;class Y{static renderChart(g,X,z){let Y=g.Component.stimulsoft.as(U),G=.96,V=g.service.report.unit.convertToHInches(g.Component.width)*G,_=g.service.report.unit.convertToHInches(g.Component.height)*G,q=0,K=0,Q=0,J=1,Z=1;switch(Y.rotation){case j.Rotate90CCW:q=-90,Q=_;break;case j.Rotate90CW:q=90,K=V;break;case j.Rotate180:q=-180,K=V,Q=_;break;case j.FlipVertical:Z=-1,Q=_;break;case j.FlipHorizontal:J=-1,K=V;break}switch(Y.rotation){case j.Rotate90CCW:case j.Rotate90CW:{let t=V;V=_,_=t;break}}if(!X&&Y.rotation!=j.None){let t=new M(1,0,0,1,0,0);t.translate(K,Q),t.scale(J,Z),t.rotate(q),g.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",g.service.convertToString(t.elements[0]),g.service.convertToString(t.elements[1]),g.service.convertToString(t.elements[2]),g.service.convertToString(t.elements[3]),g.service.convertToString(t.elements[4]),g.service.convertToString(t.elements[5]))}let $=new s,tt=new n($,!0,!1,!1,1),et=Y.isAnimation,it;Y.isAnimation=!1,Y.core.render(tt,new m(0,0,V,_),!0).drawGeom(tt),Y.isAnimation=et;let rt=new M(1,0,0,1,0,0),nt=g.service.hiToTwips/.96;rt.translate(g.X,g.Y+g.Height),rt.scale(1,-1),rt.scale(nt,nt);let st=new e.StiPdfGeomWriter(g.service.pageStream,g.service,X);st.pageNumber=z,st.matrixCache.push(rt);for(let e of tt.geoms){if(e.stimulsoft.is(h)){let t=e.stimulsoft.as(h);st.saveState(),st.translateTransform(t.x,t.y)}if(e.stimulsoft.is(p)){let t=e.stimulsoft.as(p);st.saveState(),st.rotateTransform(t.angle)}if(e.stimulsoft.is(w)&&st.restoreState(),e.stimulsoft.is(f)){let t=e.stimulsoft.as(f);st.saveState(),st.setClip(t.clipRectangle)}if(e.stimulsoft.is(E)&&st.restoreState(),e.stimulsoft.is(v)&&st.saveState(),e.stimulsoft.is(b)&&st.restoreState(),e.stimulsoft.is(y)&&st.saveState(),e.stimulsoft.is(x)&&st.restoreState(),e.stimulsoft.is(S)){let t=e.stimulsoft.as(S);null!=t.background&&st.fillRectangle(this.rectToRectangle(t.rect),t.background),this.checkPenGeom(t.borderPen)&&st.drawRectangle(this.rectToRectangle(t.rect),t.borderPen)}if(e.stimulsoft.is(d)){let t=e.stimulsoft.as(d);this.checkPenGeom(t.pen)&&st.drawLine(new o(t.x1,t.y1),new o(t.x2,t.y2),t.pen)}if(e.stimulsoft.is(u)){let t=e.stimulsoft.as(u);this.checkPenGeom(t.pen)&&st.drawPolyline(t.points,t.pen)}if(e.stimulsoft.is(A)){let t=e.stimulsoft.as(A);this.checkPenGeom(t.pen)&&st.drawSpline(t.points,t.tension,t.pen)}if(e.stimulsoft.is(T)){let t=e.stimulsoft.as(T);null!=t.background&&st.fillEllipse(this.rectToRectangle(t.rect),t.background),this.checkPenGeom(t.borderPen)&&st.drawEllipse(this.rectToRectangle(t.rect),t.borderPen)}if(e.stimulsoft.is(P)){let t=e.stimulsoft.as(P),r=t.rect,n=t.sides,s=r.y+8,a=r.x+8,l=(n&L.Edge)>0?4:0;(n&L.Top)>0&&(s=r.y+4),(n&L.Left)>0&&(a=r.x+4);for(let t=0;t<3;t++){let e=new Array;(n&L.Right)>0?(e.push(new o(r.right,s)),(n&L.Bottom)>0?(e.push(new o(r.right,r.bottom)),e.push(new o(a,r.bottom)),e.push(new o(a,r.bottom+t+1)),e.push(new o(r.right+t+1,r.bottom+t+1))):(e.push(new o(r.right,r.bottom+l)),e.push(new o(r.right+t+1,r.bottom+l))),e.push(new o(r.right+t+1,s))):(e.push(new o(a,r.bottom)),e.push(new o(r.right+l,r.bottom)),e.push(new o(r.right+l,r.bottom+t+1)),e.push(new o(a,r.bottom+t+1)));let m=new C(i.fromArgb(40-10*t,i.black));st.fillPolygon(e,m)}}if(e.stimulsoft.is(F)){let t=e.stimulsoft.as(F)}if(e.stimulsoft.is(R)){let i=e.stimulsoft.as(R),n=new W(i.font.fontName,i.font.fontSize,i.font.fontStyle,i.font.unit),s=new c;s.alignment=i.stringFormat.alignment,s.formatFlags=i.stringFormat.formatFlags,s.hotkeyPrefix=i.stringFormat.hotkeyPrefix,s.lineAlignment=i.stringFormat.lineAlignment,s.trimming=i.stringFormat.trimming;let m=this.brushToStiBrush(i.brush);if(i.isRotatedText){let e=new o;if(i.location.stimulsoft.is(o))e=i.location.stimulsoft.as(o);else if(i.location.stimulsoft.is(a)){let t=i.location.stimulsoft.as(a);e=new o(t.x,t.y)}else{let t=this.rectToRectangle(i.location);e=new o(t.x+t.width/2,t.y+t.height/2)}let c=r.measureString(i.text,n,i.maximalWidth),g=new l(0,0,c.width,c.height),h=this.getStartPoint(i.rotationMode,g);g.x-=h.x,g.y-=h.y,s.alignment==t.System.Drawing.StringAlignment.Center&&(g.x-=1),s.alignment==t.System.Drawing.StringAlignment.Far&&(g.x-=2),g.width+=2.5,st.saveState(),st.translateTransform(e.x,e.y),0!=i.angle&&st.rotateTransform(i.angle),st.drawString(i.text,n,m,g,s),st.restoreState()}else st.drawString(i.text,n,m,this.rectToRectangle(i.location),s)}if(e.stimulsoft.is(B)){let t=e.stimulsoft.as(B);st.beginPath();for(let e of t.geoms){if(e.stimulsoft.is(I)){let t=e.stimulsoft.as(I);st.drawPie(t.rect,t.startAngle,t.sweepAngle)}if(e.stimulsoft.is(k)){let t=e.stimulsoft.as(k);st.drawArc(t.rect,t.startAngle,t.sweepAngle)}if(e.stimulsoft.is(D)){let t=e.stimulsoft.as(D);st.drawLine(new o(t.x1,t.y1),new o(t.x2,t.y2),null)}if(e.stimulsoft.is(N)){let t=e.stimulsoft.as(N);st.drawPolyline(t.points,null)}if(e.stimulsoft.is(H)){let t=e.stimulsoft.as(H);st.drawSpline(t.points,t.tension,null)}e.stimulsoft.is(O)&&st.closeFigure()}st.closeFigure(),st.endPath(),null!=t.background&&st.fillPath(t.background),this.checkPenGeom(t.pen)&&st.strokePath(t.pen)}}}static getStartPoint(t,e){let i=new o(e.x+e.width/2,e.y+e.height/2);switch(t){case g.LeftCenter:return new o(e.x,i.y);case g.LeftBottom:return new o(e.x,e.bottom);case g.CenterTop:return new o(i.x,e.top);case g.CenterCenter:return i;case g.CenterBottom:return new o(i.x,e.bottom);case g.RightTop:return new o(e.right,e.top);case g.RightCenter:return new o(e.right,i.y);case g.RightBottom:return new o(e.right,e.bottom);default:return new o(e.x,e.y)}}static rectToRectangle(t){if(null==t)return new l;if(t.stimulsoft.is(l))return t.stimulsoft.as(l);if(t.stimulsoft.is(m)){let e=t.stimulsoft.as(m);return new l(e.x,e.y,e.width,e.height)}return new l}static brushToStiBrush(t){if(null==t)return null;if(t.stimulsoft.is(i))return new C(t.stimulsoft.as(i));if(t.stimulsoft.is(z))return t.stimulsoft.as(z);return null}static checkPenGeom(t){return!(null==t||null==t.brush||t.penStyle==X.None)}}e.StiPdfRenderChart=Y}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.Base.Drawing.StiSolidBrush,r=t.Base.Drawing.StiGradientBrush,n=t.Base.Drawing.StiColorUtils,s=t.Report.Components.StiDataBarDirection,o=t.Report.Components.StiDataBarIndicator,a=t.System.Drawing.ContentAlignment,l=t.Report.Components.StiIcon,m=t.Report.Components.StiIconSetIndicator,c=t.Report.Components.StiText;class g{static renderIndicators(g){let h=g.Component.as(c);if(null==h||null==h.indicator)return g;let p=new Rectangle(g.X,g.Y,g.Width,g.Height),w=h.indicator.stimulsoft.as(m);if(null!=w&&(w.icon!=l.None||null!=w.customIcon)){let t=g.service.imageList[g.service.imagesCurrent],i=t.Width*g.service.hiToTwips,r=t.Height*g.service.hiToTwips,n=p.clone(),s=g.service.hiToTwips;switch(n.inflate(-s,-s),w.alignment){case a.TopLeft:n=new Rectangle(n.x,n.bottom-r,i,r),p.x+=n.width+1,p.width-=n.width+1;break;case a.TopCenter:n=new Rectangle(n.x+(n.width-i)/2,n.bottom-r,i,r);break;case a.TopRight:n=new Rectangle(n.right-i,n.bottom-r,i,r),p.width-=n.width+1;break;case a.MiddleLeft:n=new Rectangle(n.x,n.y+(n.height-r)/2,i,r),p.x+=n.width+1,p.width-=n.width+1;break;case a.MiddleCenter:n=new Rectangle(n.x+(n.width-i)/2,n.y+(n.height-r)/2,i,r);break;case a.MiddleRight:n=new Rectangle(n.right-i,n.y+(n.height-r)/2,i,r),p.width-=n.width+1;break;case a.BottomLeft:n=new Rectangle(n.x,n.y,i,r),p.x+=n.width+1,p.width-=n.width+1;break;case a.BottomCenter:n=new Rectangle(n.x+(n.width-i)/2,n.y,i,r);break;case a.BottomRight:n=new Rectangle(n.right-i,n.y,i,r),p.width-=n.width+1;break}let o=new e.StiPdfData(g.service);o.X=n.x,o.Y=n.y,o.Width=n.width,o.Height=n.height,g.service.writeImageInfo2(o,1,1)}let S=h.indicator.stimulsoft.as(o);if(null!=S&&0!=S.value){let e=p.clone(),o=g.service.hiToTwips;e.inflate(-2*o,-2*o);let a=S.maximum+Math.abs(S.minimum),l=e.width*Math.abs(S.minimum)/a,m=e.width*S.maximum/a,c=e.width*Math.abs(S.value)/a,w=S.direction;w==s.Default&&(w=null!=h.textOptions&&h.textOptions.rightToLeft?s.RighToLeft:s.LeftToRight);let d=0;w==s.LeftToRight?(S.value<0?e.x+=l-c:e.x+=l,e.width=c):(d=180,S.value<0?e.x=e.right-l:e.x=e.right-l-c,e.width=c),S.value<0&&(d+=180);let u=!1;if(e.width>0&&e.height>0){if(S.brushType==t.Report.Components.StiBrushType.Gradient){let t;if(t=w==s.LeftToRight?S.value>0?new Rectangle(p.left+l,p.top,m,p.height):new Rectangle(p.left,p.top,l,p.height):S.value<0?new Rectangle(p.left+m,p.top,l,p.height):new Rectangle(p.left,p.top,m,p.height),e.width>0&&e.width<1&&(e.width=1),t.width>0&&t.width<1&&(t.width=1),t.width>0&&e.width>0){let i=S.value<0?S.negativeColor:S.positiveColor,s=n.light(i,200);t.x-=.1*t.width,t.width+=.2*t.width;let o=new r(i,s,d);g.service.fillRectBrush(o,e);let a=g.service.shadingArray[g.service.shadingCurrent-1];a.Angle=d,a.X=t.x,a.Y=t.y,a.Width=t.width,a.Height=t.height,a.FunctionIndex=g.service.getShadingFunctionNumber(i,s,!1),g.service.shadingArray[g.service.shadingCurrent-1]=a,u=!0}}else{let t=new i(S.value<0?S.negativeColor:S.positiveColor);g.service.fillRectBrush(t,e)}S.showBorder&&(g.service.pageStream.writeLine("q"),g.service.pushColorToStack(),g.service.setStrokeColor(S.value<0?S.negativeBorderColor:S.positiveBorderColor),g.service.pageStream.writeLine1("{0} {1} {2} {3} re S",g.service.convertToString(e.x),g.service.convertToString(e.y),g.service.convertToString(e.width),g.service.convertToString(e.height)),g.service.pageStream.writeLine("Q"),g.service.popColorFromStack())}u||S.brushType!=t.Report.Components.StiBrushType.Gradient||g.service.shadingCurrent++}let d=new e.StiPdfData(g.service);return d.X=p.x,d.Y=g.Y,d.Width=p.width,d.Height=g.Height,d.Component=g.Component,d}}e.StiPdfRenderIndicators=g}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.System.Drawing.Color,r=t.Base.Drawing.StiBrush,n=t.Base.Drawing.StiGradientBrush,s=t.Base.Drawing.StiGlareBrush,o=t.Base.Drawing.StiHatchBrush,a=t.Report.Components.IStiBrush,l=t.Base.Drawing.StiBorderSides,m=t.Report.Components.IStiBorder,c=t.Base.Drawing.StiBorderSide,g=t.Base.Drawing.StiAdvancedBorder,h=t.Base.Drawing.StiPenStyle,p=t.Report.Components.StiShape,w=t.Report.Components.StiVerticalLineShapeType,S=t.Report.Components.StiHorizontalLineShapeType,d=t.Report.Components.StiTopAndBottomLineShapeType,u=t.Report.Components.StiLeftAndRightLineShapeType,f=t.Report.Components.StiRectangleShapeType,E=t.Report.Components.StiRoundedRectangleShapeType,v=t.Report.Components.StiDiagonalDownLineShapeType,b=t.Report.Components.StiDiagonalUpLineShapeType,y=t.Report.Components.StiTriangleShapeType,x=t.Report.Components.StiOvalShapeType,A=t.Report.Components.StiArrowShapeType,T=t.Report.Components.StiOctagonShapeType,P=t.Report.Components.StiComplexArrowShapeType,L=t.Report.Components.StiBentArrowShapeType,C=t.Report.Components.StiChevronShapeType,F=t.Report.Components.StiDivisionShapeType,R=t.Report.Components.StiEqualShapeType,B=t.Report.Components.StiFlowchartCardShapeType,I=t.Report.Components.StiFlowchartCollateShapeType,k=t.Report.Components.StiFlowchartDecisionShapeType,D=t.Report.Components.StiFlowchartManualInputShapeType,N=t.Report.Components.StiFlowchartOffPageConnectorShapeType,H=t.Report.Components.StiFlowchartPreparationShapeType,O=t.Report.Components.StiFlowchartSortShapeType,M=t.Report.Components.StiFrameShapeType,U=t.Report.Components.StiMinusShapeType,X=t.Report.Components.StiMultiplyShapeType,W=t.Report.Components.StiParallelogramShapeType,z=t.Report.Components.StiPlusShapeType,j=t.Report.Components.StiRegularPentagonShapeType,Y=t.Report.Components.StiTrapezoidShapeType,G=t.Report.Components.StiSnipSameSideCornerRectangleShapeType,V=t.Report.Components.StiSnipDiagonalSideCornerRectangleShapeType,_=t.Report.Components.StiShapeDirection,q=t.System.Drawing.Rectangle,K=t.Report.Components.StiCheckBox,Q=t.Report.Components.StiCheckStyle,J=t.Report.Components.StiRoundedRectanglePrimitive,Z=t.System.StiString;class ${static renderBorder1(t){let e=null,i=t.Component.stimulsoft.as(a);null!=i&&null!=i.brush&&(e=i.brush),null!=e&&t.service.fillRectBrush(e,new q(t.X,t.Y,t.Width,t.Height))}static renderBorder2(t){let e=t.Component.stimulsoft.as(m);if(null!=e){let n=i.transparent;if(e.border.dropShadow&&null!=e.border.shadowBrush&&(n=r.toColor(e.border.shadowBrush),0!=n.a)){let i=.8*e.border.shadowSize;t.service.setNonStrokeColor(n),t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X+i),t.service.convertToString(t.Y-i),t.service.convertToString(t.Width-i),t.service.convertToString(i)),t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y-i),t.service.convertToString(i),t.service.convertToString(t.Height))}let s=new c(e.border.color,e.border.size,e.border.style),o=e.border.stimulsoft.as(g),a=null!=o,m=e.border.isLeftBorderSidePresent,p=e.border.isRightBorderSidePresent,w=e.border.isTopBorderSidePresent,S=e.border.isBottomBorderSidePresent,d=e.border.style!=h.None&&e.border.style!=h.Solid,u=e.border.side!=l.None&&e.border.style!=h.None;if(a&&(u=o.side!=l.None),u){let i=0;a||(d&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(s,t)),a||e.border.side!=l.All?(m&&(a&&(s=o.leftSide,s.style!=h.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(s,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-i),t.service.convertToString(t.Y-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X-i),t.service.convertToString(t.Y+t.Height+i)),s.style==h.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+(S?i:-i))),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+t.Height+(w?-i:i)))),a&&s.style!=h.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),p&&(a&&(s=o.rightSide,s.style!=h.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(s,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y+t.Height+i)),s.style==h.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width-i),t.service.convertToString(t.Y+(S?i:-i))),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width-i),t.service.convertToString(t.Y+t.Height+(w?-i:i)))),a&&s.style!=h.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),w&&(a&&(s=o.topSide,s.style!=h.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(s,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-i),t.service.convertToString(t.Y+t.Height+i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y+t.Height+i)),s.style==h.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+(m?i:-i)),t.service.convertToString(t.Y+t.Height-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+(p?-i:i)),t.service.convertToString(t.Y+t.Height-i))),a&&s.style!=h.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())),S&&(a&&(s=o.bottomSide,s.style!=h.Solid&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack()),i=this.storeBorderSideData(s,t)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X-i),t.service.convertToString(t.Y-i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+i),t.service.convertToString(t.Y-i)),s.style==h.Double&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+(m?i:-i)),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width+(p?-i:i)),t.service.convertToString(t.Y+i))),a&&s.style!=h.Solid&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()))):(t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(t.X-i),t.service.convertToString(t.Y-i),t.service.convertToString(t.Width+2*i),t.service.convertToString(t.Height+2*i)),e.border.style==h.Double&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re S",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+i),t.service.convertToString(t.Width-2*i),t.service.convertToString(t.Height-2*i))),!a&&d&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())}}}static storeBorderSideData(t,e){let i=t.size;i<1&&(i=1),t.style==h.Double&&(i=1);let r=i*e.service.hiToTwips*.955;e.service.pageStream.writeLine1("{0} w",e.service.convertToString(r));let n=this.getPenStyleDashString(t.style,.04*r,e);return null!=n&&e.service.pageStream.writeLine(n),e.service.setStrokeColor(t.color),t.style==h.Double?r:0}static getPenStyleDashString(t,e,i){switch(t){case h.Dot:return Z.format("[{0} {1}] 0 d",i.service.convertToString(e),i.service.convertToString(58*e));case h.Dash:return Z.format("[{0} {1}] 0 d",i.service.convertToString(49.5*e),i.service.convertToString(62*e));case h.DashDot:return Z.format("[{0} {1} {2} {1}] 0 d",i.service.convertToString(50*e),i.service.convertToString(55*e),i.service.convertToString(e));case h.DashDotDot:return Z.format("[{0} {1} {2} {1} {2} {1}] 0 d",i.service.convertToString(50*e),i.service.convertToString(55*e),i.service.convertToString(e))}return null}static checkShape(t){if(t.shapeType.stimulsoft.is(w)||t.shapeType.stimulsoft.is(S)||t.shapeType.stimulsoft.is(d)||t.shapeType.stimulsoft.is(u)||t.shapeType.stimulsoft.is(f)||t.shapeType.stimulsoft.is(E)||t.shapeType.stimulsoft.is(v)||t.shapeType.stimulsoft.is(b)||t.shapeType.stimulsoft.is(y)||t.shapeType.stimulsoft.is(x)||t.shapeType.stimulsoft.is(A)||t.shapeType.stimulsoft.is(T)||t.shapeType.stimulsoft.is(P)||t.shapeType.stimulsoft.is(L)||t.shapeType.stimulsoft.is(C)||t.shapeType.stimulsoft.is(F)||t.shapeType.stimulsoft.is(R)||t.shapeType.stimulsoft.is(B)||t.shapeType.stimulsoft.is(I)||t.shapeType.stimulsoft.is(k)||t.shapeType.stimulsoft.is(D)||t.shapeType.stimulsoft.is(N)||t.shapeType.stimulsoft.is(H)||t.shapeType.stimulsoft.is(O)||t.shapeType.stimulsoft.is(M)||t.shapeType.stimulsoft.is(U)||t.shapeType.stimulsoft.is(X)||t.shapeType.stimulsoft.is(W)||t.shapeType.stimulsoft.is(z)||t.shapeType.stimulsoft.is(j)||t.shapeType.stimulsoft.is(Y)||t.shapeType.stimulsoft.is(G)||t.shapeType.stimulsoft.is(V))return!0;return!1}static renderShape(t,l){let m=t.Component.stimulsoft.as(p);if(null!=m)if(1==this.checkShape(m)){let l=t.Component.stimulsoft.as(a),c=new e.StiPdfGeomWriter(t.service.pageStream,t.service,!1),g=i.transparent;if(null!=l&&(g=r.toColor(l.brush)),0!=g.a&&t.service.setNonStrokeColor(g),null!=l&&((l.brush.stimulsoft.is(n)||l.brush.stimulsoft.is(s))&&(t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,l.brush),t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent)),l.brush.stimulsoft.is(o))){let e=l.brush.stimulsoft.as(o);t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(e)+1)}let p=m.borderColor;t.service.setStrokeColor(p);let K=g.a>0,Q=m.style!=h.None;if(!K&&!Q)return;let J=K?Q?"B":"f":Q?"S":"n";t.service.pageStream.writeLine1("{0} w",t.service.convertToString(m.size*t.service.hiToTwips)),t.service.pageStream.writeLine("q");let Z=m.size*t.service.hiToTwips*.04;switch(m.style){case h.Dot:t.service.pageStream.writeLine1("[{0} {1}] 0 d",t.service.convertToString(Z),t.service.convertToString(55*Z));break;case h.Dash:t.service.pageStream.writeLine1("[{0} {1}] 0 d",t.service.convertToString(50*Z),t.service.convertToString(55*Z));break;case h.DashDot:t.service.pageStream.writeLine1("[{0} {1} {2} {1}] 0 d",t.service.convertToString(50*Z),t.service.convertToString(55*Z),t.service.convertToString(Z));break;case h.DashDotDot:t.service.pageStream.writeLine1("[{0} {1} {2} {1} {2} {1}] 0 d",t.service.convertToString(50*Z),t.service.convertToString(55*Z),t.service.convertToString(Z));break}if(m.shapeType.stimulsoft.is(w)&&(K&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),Q&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)))),m.shapeType.stimulsoft.is(S)&&(K&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),Q&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)))),m.shapeType.stimulsoft.is(d)&&(K&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),Q&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)))),m.shapeType.stimulsoft.is(u)&&(K&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),Q&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)))),m.shapeType.stimulsoft.is(f)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y))),m.shapeType.stimulsoft.is(v)&&(K&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),Q&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)))),m.shapeType.stimulsoft.is(b)&&(K&&t.service.pageStream.writeLine1("{0} {1} {2} {3} re f",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.Width),t.service.convertToString(t.Height)),Q&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)))),m.shapeType.stimulsoft.is(y)){let e=m.shapeType.stimulsoft.as(y).direction;e==_.Up&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y))),e==_.Down&&(J=K?Q?"B*":"f*":Q?"S":"n",t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height))),e==_.Left&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y))),e==_.Right&&(J=K?Q?"B*":"f*":Q?"S":"n",t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y)))}if(m.shapeType.stimulsoft.is(x)&&t.service.pageStream.writeLine1(c.getEllipseString(new q(t.X,t.Y,t.Width,t.Height))+J),m.shapeType.stimulsoft.is(E)){let e=m.shapeType.stimulsoft.as(E).round,i=t.Width;i>t.Height&&(i=t.Height);let r=Math.min(i,70)*e,n=r*(1-t.service.pdfCKT);t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-r)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-n),t.service.convertToString(t.X+n),t.service.convertToString(t.Y+t.Height),t.service.convertToString(t.X+r),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-r),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y+t.Height),t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-n),t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+r)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+n),t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width-r),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+r),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c "+J,t.service.convertToString(t.X+n),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+n),t.service.convertToString(t.X),t.service.convertToString(t.Y+r))}if(m.shapeType.stimulsoft.is(A)){let e=m.shapeType.stimulsoft.as(A).direction,i=m.shapeType.stimulsoft.as(A).arrowWidth,r=m.shapeType.stimulsoft.as(A).arrowHeight,n=t.Width*i,s=t.Height*r;e!=_.Left&&e!=_.Right||(n=t.Height*i,s=t.Width*r),0==r&&(s=Math.min(t.Width/2,t.Height/2)),e==_.Up&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+n),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+n),t.service.convertToString(t.Y+t.Height-s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y+t.Height-s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X+n),t.service.convertToString(t.Y))),e==_.Down&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y+s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+n),t.service.convertToString(t.Y+s)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+n),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X+t.Width-n),t.service.convertToString(t.Y+t.Height))),e==_.Left&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+s),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+s),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+s),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+s),t.service.convertToString(t.Y+t.Height-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-n)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+n))),e==_.Right&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-s),t.service.convertToString(t.Y+t.Height-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-s),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-s),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-s),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-n)))}if(m.shapeType.stimulsoft.is(T)){let e=m.shapeType.stimulsoft.as(T),i=(null!=m.report?m.report.unit.convertToHInches(e.bevel):e.bevel)*t.service.hiToTwips,r=i;e.autoSize&&(i=t.Width/(2.414*1.414),r=t.Height/(2.414*1.414)),i>t.Width/2&&(i=t.Width/2),r>t.Height/2&&(r=t.Height/2),t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+i),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-i),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width),t.service.convertToString(t.Y+t.Height-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width-i),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Y+t.Height)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+r)),t.service.pageStream.writeLine1("{0} {1} l "+J,t.service.convertToString(t.X+i),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(P)){let e=t.Width<t.Height?t.Width/2:t.Height/2,i=t.Height/3.8,r=t.Width/3.8,n=t.Height<t.Width?t.Height/2:t.Width/2;switch(m.shapeType.stimulsoft.as(P).direction){case _.Left:case _.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y+t.Height/2));break;case _.Down:case _.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-r),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-r),t.service.convertToString(t.Top-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+r),t.service.convertToString(t.Top-n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+r),t.service.convertToString(t.Y+n)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y+n));break}}if(m.shapeType.stimulsoft.is(L)){let e=0,i=0,r=0;switch(t.Height>t.Width?(i=t.Width/4,e=i,r=i/2):(e=Math.floor(t.Height/4),i=e,r=i/2),m.shapeType.stimulsoft.as(L).direction){case _.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-(r+e)),t.service.convertToString(t.Y+e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-(r+e)),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-2*i),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-i),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-r),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-r),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y));break;case _.Left:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Top-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Top-2*i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Top-i-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top-i-r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Y));break;case _.Down:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+r),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+r),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+2*i),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i+r),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+i+r),t.service.convertToString(t.Top-e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-e)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top));break;case _.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-i),t.service.convertToString(t.Y+r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-i),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-i),t.service.convertToString(t.Y+2*i)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-i),t.service.convertToString(t.Y+i+r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Y+i+r)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(C)){let e=t.Width>t.Height?t.Height/2:t.Width/2;switch(m.shapeType.stimulsoft.as(C).direction){case _.Right:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Top));break;case _.Left:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top));break;case _.Up:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top-e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Top-e));break;case _.Down:t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top-e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.Right),t.service.convertToString(t.Y+e)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(t.X),t.service.convertToString(t.Y+e)),t.service.pageStream.writeLine1("{0} {1} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(F)){let e=t.Height/3,i=4*t.service.hiToTwips;t.service.pageStream.writeLine1(c.getRectString4(t.X,t.Y+e+i,t.Width,e-2*i)+J),t.service.pageStream.writeLine1(c.getEllipseString4(t.X+t.Width/2-e/2,t.Top-t.service.hiToTwips-e,e,e)+J),t.service.pageStream.writeLine1(c.getEllipseString4(t.X+t.Width/2-e/2,t.Y+2*t.service.hiToTwips,e,e)+J)}if(m.shapeType.stimulsoft.is(R)){let e=(t.Height-t.Height/6)/2;t.service.pageStream.writeLine1(c.getRectString4(t.X,t.Top-e,t.Width,e)+J),t.service.pageStream.writeLine1(c.getRectString4(t.X,t.Y,t.Width,e)+J)}if(m.shapeType.stimulsoft.is(B)&&(t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5),t.service.convertToString(t.X+t.Width/5),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top))),m.shapeType.stimulsoft.is(I))switch(m.shapeType.stimulsoft.as(I).direction){case _.Down:case _.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Y));break;case _.Left:case _.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Top));break}if(m.shapeType.stimulsoft.is(k)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2))),m.shapeType.stimulsoft.is(D)&&(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/5))),m.shapeType.stimulsoft.is(N)){let e=t.Height/5,i=t.Width/5;switch(m.shapeType.stimulsoft.as(N).direction){case _.Down:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Y+e),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+e),t.service.convertToString(t.X),t.service.convertToString(t.Top));break;case _.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-e)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-e),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y));break;case _.Left:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X+i),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+i),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+i),t.service.convertToString(t.Top));break;case _.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right-i),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right-i),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(H)){let e=t.Width/5,i=t.Height/5,r=t.Width/2,n=t.Height/2;switch(m.shapeType.stimulsoft.as(H).direction){case _.Left:case _.Right:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-n),t.service.convertToString(t.X+e),t.service.convertToString(t.Top),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top-n),t.service.convertToString(t.Right-e),t.service.convertToString(t.Y),t.service.convertToString(t.X+e),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-n));break;case _.Down:case _.Up:t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X+r),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-i),t.service.convertToString(t.Right),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X+r),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+i),t.service.convertToString(t.X),t.service.convertToString(t.Top-i),t.service.convertToString(t.X+r),t.service.convertToString(t.Top));break}}if(m.shapeType.stimulsoft.is(O)&&(t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Top-t.Height/2))),m.shapeType.stimulsoft.is(M)){let e=t.Width/7,i=t.Height/7;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y)),t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X+e),t.service.convertToString(t.Top-i),t.service.convertToString(t.X+e),t.service.convertToString(t.Y+i),t.service.convertToString(t.Right-e),t.service.convertToString(t.Y+i),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top-i))}if(m.shapeType.stimulsoft.is(U)){let e=t.Height/3;t.service.pageStream.writeLine1(c.getRectString4(t.X,t.Y+e,t.Width,e)+J)}if(m.shapeType.stimulsoft.is(X)){let e=t.Width/4,i=t.Height/4;t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.X+e),t.service.convertToString(t.Top),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top-i),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top-t.Height/2),t.service.convertToString(t.Right),t.service.convertToString(t.Y+i),t.service.convertToString(t.Right-e),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.X+e),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+i),t.service.convertToString(t.X+e),t.service.convertToString(t.Top-t.Height/2))}if(m.shapeType.stimulsoft.is(W)){let e=t.Width/7,i=t.Height/7;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+t.Width/5),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top),t.service.convertToString(t.Right-t.Width/5),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(z)){let e=t.Width/3,i=t.Height/3;t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(t.X+e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Top),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top-i),t.service.convertToString(t.Right),t.service.convertToString(t.Top-i),t.service.convertToString(t.Right),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l",t.service.convertToString(t.Right-e),t.service.convertToString(t.Y+i),t.service.convertToString(t.Right-e),t.service.convertToString(t.Y),t.service.convertToString(t.X+e),t.service.convertToString(t.Y),t.service.convertToString(t.X+e),t.service.convertToString(t.Y+i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y+i),t.service.convertToString(t.X),t.service.convertToString(t.Top-i),t.service.convertToString(t.X+e),t.service.convertToString(t.Top-i),t.service.convertToString(t.X+e),t.service.convertToString(t.Top))}if(m.shapeType.stimulsoft.is(j)){let e=t.Height/2.6,i=t.Width/5.5;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-e),t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top-e),t.service.convertToString(t.Right-i),t.service.convertToString(t.Y),t.service.convertToString(t.X+i),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Top-e))}if(m.shapeType.stimulsoft.is(Y)){let e=t.Width/4.75;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l {6} {7} l h "+J,t.service.convertToString(t.X),t.service.convertToString(t.Y),t.service.convertToString(t.X+e),t.service.convertToString(t.Top),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(G)){let e=t.Width/7.2,i=t.Height/4.6;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top-i),t.service.convertToString(t.X+e),t.service.convertToString(t.Top),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Top-i),t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y))}if(m.shapeType.stimulsoft.is(V)){let e=t.Width/7.2,i=t.Height/4.6;t.service.pageStream.writeLine1("{0} {1} m {2} {3} l {4} {5} l",t.service.convertToString(t.X),t.service.convertToString(t.Top),t.service.convertToString(t.Right-e),t.service.convertToString(t.Top),t.service.convertToString(t.Right),t.service.convertToString(t.Top-i)),t.service.pageStream.writeLine1("{0} {1} l {2} {3} l {4} {5} l h "+J,t.service.convertToString(t.Right),t.service.convertToString(t.Y),t.service.convertToString(t.X+e),t.service.convertToString(t.Y),t.service.convertToString(t.X),t.service.convertToString(t.Y+i))}t.service.pageStream.writeLine("Q")}else{let t=l}}static renderRoundedRectanglePrimitive(t){let e=t.Component.stimulsoft.as(m);if(null!=e){let i=new c(e.border.color,e.border.size,e.border.style),r=t.Component.stimulsoft.as(J);if(r.style==h.None)return;let n=e.border.style!=h.None&&e.border.style!=h.Solid;n&&(t.service.pageStream.writeLine("q"),t.service.pushColorToStack());let s=this.storeBorderSideData(i,t),o=Math.min(t.Width<t.Height?t.Width:t.Height,100*t.Component.page.zoom)*r.round,a=o*(1-t.service.pdfCKT),l=t.X-s,m=t.X+t.Width+s,g=t.X+t.Width/2,p=t.Y-s,w=t.Y+t.Height+s;if(r.leftSide&&(r.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(r.rightSide?g:m),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(l+o),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(l+a),t.service.convertToString(p),t.service.convertToString(l),t.service.convertToString(p+a),t.service.convertToString(l),t.service.convertToString(p+o))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(p)),r.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(l),t.service.convertToString(w-o)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(l),t.service.convertToString(w-a),t.service.convertToString(l+a),t.service.convertToString(w),t.service.convertToString(l+o),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(r.rightSide?g:m),t.service.convertToString(w))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(l),t.service.convertToString(w))),r.rightSide&&(r.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(r.leftSide?g:l),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(m-o),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(m-a),t.service.convertToString(p),t.service.convertToString(m),t.service.convertToString(p+a),t.service.convertToString(m),t.service.convertToString(p+o))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(m),t.service.convertToString(p)),r.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(m),t.service.convertToString(w-o)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(m),t.service.convertToString(w-a),t.service.convertToString(m-a),t.service.convertToString(w),t.service.convertToString(m-o),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(r.leftSide?g:l),t.service.convertToString(w))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(w))),!r.topSide||r.leftSide||r.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(w)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(w))),!r.bottomSide||r.leftSide||r.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(p)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(p))),i.style==h.Double){o-=2*s,a=o*(1-t.service.pdfCKT);let e=t.X+s,i=t.X+t.Width-s,n=t.Y+s,c=t.Y+t.Height-s;r.leftSide&&(r.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(r.rightSide?g:m),t.service.convertToString(n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(e+o),t.service.convertToString(n)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(e+a),t.service.convertToString(n),t.service.convertToString(e),t.service.convertToString(n+a),t.service.convertToString(e),t.service.convertToString(n+o))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(e),t.service.convertToString(p)),r.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(e),t.service.convertToString(c-o)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(e),t.service.convertToString(c-a),t.service.convertToString(e+a),t.service.convertToString(c),t.service.convertToString(e+o),t.service.convertToString(c)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(r.rightSide?g:m),t.service.convertToString(c))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(e),t.service.convertToString(w))),r.rightSide&&(r.bottomSide?(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(r.leftSide?g:l),t.service.convertToString(n)),t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(i-o),t.service.convertToString(n)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(i-a),t.service.convertToString(n),t.service.convertToString(i),t.service.convertToString(n+a),t.service.convertToString(i),t.service.convertToString(n+o))):t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(i),t.service.convertToString(p)),r.topSide?(t.service.pageStream.writeLine1("{0} {1} l",t.service.convertToString(i),t.service.convertToString(c-o)),t.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} c",t.service.convertToString(i),t.service.convertToString(c-a),t.service.convertToString(i-a),t.service.convertToString(c),t.service.convertToString(i-o),t.service.convertToString(c)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(r.leftSide?g:l),t.service.convertToString(c))):t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(i),t.service.convertToString(w))),!r.topSide||r.leftSide||r.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(c)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(c))),!r.bottomSide||r.leftSide||r.rightSide||(t.service.pageStream.writeLine1("{0} {1} m",t.service.convertToString(l),t.service.convertToString(n)),t.service.pageStream.writeLine1("{0} {1} l S",t.service.convertToString(m),t.service.convertToString(n)))}n&&(t.service.pageStream.writeLine("Q"),t.service.popColorFromStack())}}static renderCheckbox(t,e,i=!0){let a=t.Component.stimulsoft.as(K);if(null!=a){let l=null;switch(e?a.checkStyleForTrue:a.checkStyleForFalse){case Q.Cross:l="62.568 52.024 m 62.018 52.166 60.405 52.537 58.984 52.848 c 55.336 53.645 49.313 58.685 44.741 64.767 c 40.839 69.958 l 45.919 71.092 l \r\n"+"53.272 72.735 59.559 76.81 67.746 85.239 c 74.954 92.661 l 68.543 100.174 l 56.77 113.972 54.196 123.193 59.915 131.088 c 62.809 135.083 71.734 143.458 73.097 143.458 c \r\n"+"73.509 143.458 74.16 141.77 74.546 139.708 c 75.526 134.457 81.002 122.942 85.482 116.708 c 87.557 113.82 89.473 111.458 89.74 111.458 c \r\n"+"90.006 111.458 93.515 114.945 97.537 119.208 c 113.934 136.584 127.211 138.972 135.818 126.095 c 139.973 119.877 140.004 118.024 135.958 117.739 c \r\n"+"130.11 117.329 118.795 109.205 110.443 99.42 c 105.812 93.994 l 110.69 89.679 l 117.241 83.884 129.589 77.786 136.531 76.919 c \r\n"+"139.576 76.539 142.068 75.813 142.068 75.307 c 142.068 72.526 132.802 60.889 129.038 58.942 c 121.077 54.825 112.668 58.23 96.273 72.209 c \r\n"+"91.287 76.46 l 84.2 67.488 l 80.303 62.554 75.379 57.368 73.259 55.965 c 69.353 53.38 64.393 51.552 62.568 52.024 c h";break;case Q.Check:l="60.972 37.503 m 51.173 63.277 43.562 76.623 35.37 82.397 c 30.912 85.54 l 33.664 88.435 l 37.539 92.513 43.698 95.935 48.566 96.713 c \r\n"+"52.426 97.33 53.024 97.093 57.102 93.334 c 59.763 90.882 63.368 85.726 66.269 80.223 c 68.899 75.234 71.18 71.153 71.337 71.153 c \r\n"+"71.493 71.153 73.65 74.19 76.13 77.903 c 96.259 108.044 129.683 141.214 157.565 158.718 c 166.414 164.274 l 168.677 161.643 l \r\n"+"170.941 159.012 l 163.178 152.717 l 139.859 133.81 108.017 94.486 89.043 61.164 c 82.362 49.432 81.87 48.851 73.952 43.345 c \r\n"+"69.45 40.214 64.908 37.04 63.858 36.292 c 62.149 35.074 61.848 35.2 60.972 37.503 c h";break;case Q.CrossRectangle:l="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h \r\n"+"67.337 54.521 m 65.513 54.912 62.41 56.378 60.442 57.778 c 57.123 60.14 48.153 70.186 48.153 71.541 c 48.153 71.87 50.57 72.68 53.525 73.342 c \r\n"+"60.71 74.95 67.272 79.277 75.328 87.718 c 82.003 94.713 l 75.624 102.027 l 64.931 114.288 61.644 123.705 65.472 131.108 c \r\n"+"67.054 134.168 78.562 145.458 80.098 145.458 c 80.556 145.458 81.245 143.77 81.63 141.708 c 82.611 136.457 88.086 124.942 92.567 118.708 c \r\n"+"94.642 115.82 96.558 113.458 96.824 113.458 c 97.091 113.458 100.6 116.945 104.622 121.208 c 121.019 138.584 134.296 140.972 142.903 128.095 c \r\n"+"147.058 121.877 147.089 120.024 143.043 119.739 c 137.213 119.33 124.806 110.39 117.127 101.066 c 113.226 96.33 113.155 96.112 114.876 94.198 c \r\n"+"118.066 90.648 128.579 83.654 133.847 81.578 c 136.682 80.461 141.285 79.244 144.077 78.873 c 146.868 78.503 149.153 77.878 149.153 77.484 c \r\n"+"149.153 75.37 140.777 64.275 137.501 62.048 c 129.107 56.344 120.869 59.278 103.358 74.209 c 98.372 78.46 l 91.285 69.488 l \r\n"+"81.563 57.18 74.76 52.928 67.337 54.521 c h";break;case Q.CheckRectangle:l="19.915 96.5 m 19.915 169 l 91.857 169 l 163.8 169 l 170.357 173.111 l 176.914 177.223 l 178.882 174.861 l 179.963 173.563 180.864 172.217 180.882 171.872 c \r\n"+"180.9 171.526 178.44 169.334 175.415 167 c 169.915 162.757 l 169.915 93.378 l 169.915 24 l 94.915 24 l 19.915 24 l 19.915 96.5 l h \r\n"+"153.915 92.622 m 153.915 141.962 153.786 146.137 152.294 144.899 c 149.513 142.592 136.609 126.998 127.965 115.5 c 117.473 101.544 104.486 81.963 98.451 71 c \r\n"+"93.993 62.903 93.316 62.192 84.16 56 c 78.873 52.425 74.256 49.375 73.9 49.223 c 73.544 49.07 71.988 52.22 70.441 56.223 c \r\n"+"68.895 60.225 65.183 68.635 62.192 74.911 c 57.906 83.903 55.515 87.56 50.914 92.161 c 47.703 95.372 44.364 98 43.495 98 c \r\n"+"40.697 98 41.79 99.66 47.479 104.049 c 53.073 108.365 60.662 111.14 64.28 110.194 c 67.84 109.263 73.689 102.039 78.2 93.002 c \r\n"+"82.663 84.062 l 87.207 90.895 l 95.518 103.394 108.214 118.311 125.807 136.25 c 143.215 154 l 89.565 154 l 35.915 154 l 35.915 96.5 l \r\n"+"35.915 39 l 94.915 39 l 153.915 39 l 153.915 92.622 l h";break;case Q.CrossCircle:l="83.347 26.864 m 61.07 31.95 42.193 47.128 32.202 67.986 c 23.401 86.36 23.68 110.034 32.919 128.958 c 41.882 147.315 60.868 162.86 80.847 168.201 c \r\n"+"91.083 170.936 112.112 170.628 121.812 167.6 c 147.999 159.425 167.881 138.673 173.432 113.721 c 175.869 102.768 175 85.662 171.452 74.743 c \r\n"+"164.795 54.256 145.804 35.792 124.126 28.729 c 117.735 26.647 113.94 26.133 102.847 25.845 c 93.814 25.61 87.363 25.947 83.347 26.864 c h \r\n"+"112.414 41.542 m 129.545 44.672 146.131 57.503 153.827 73.579 c 168.725 104.698 152.719 141.239 119.425 152.119 c 112.712 154.313 109.49 154.763 100.347 154.781 c \r\n"+"90.993 154.8 88.185 154.404 81.579 152.131 c 64.423 146.231 51.91 134.6 45.14 118.265 c 42.988 113.072 42.446 109.911 42.069 100.368 c \r\n"+"41.551 87.229 42.811 81.166 48.181 70.958 c 52.288 63.15 63.613 51.864 71.549 47.67 c 83.611 41.295 98.688 39.034 112.414 41.542 c h \r\n"+"69.097 66.583 m 66.21 69.342 63.847 71.942 63.847 72.361 c 63.847 72.78 69.506 78.671 76.422 85.451 c 88.996 97.78 l 76.198 110.607 l 63.4 123.434 l \r\n"+"68.336 128.446 l 71.051 131.202 73.641 133.458 74.091 133.458 c 74.542 133.458 80.666 127.846 87.7 120.988 c 100.49 108.517 l 104.919 113.071 l \r\n"+"107.354 115.575 113.31 121.259 118.154 125.701 c 126.961 133.777 l 132.308 128.496 l 137.656 123.215 l 124.694 110.658 l 111.733 98.1 l 124.866 84.939 l \r\n"+"137.999 71.779 l 132.815 67.118 l 129.964 64.555 127.11 62.458 126.474 62.458 c 125.837 62.458 119.93 67.858 113.347 74.458 c \r\n"+"106.765 81.058 100.96 86.458 100.449 86.458 c 99.938 86.458 93.856 80.857 86.933 74.013 c 74.347 61.567 l 69.097 66.583 l h";break;case Q.DotCircle:l="81.653 29.406 m 59.375 34.493 40.499 49.67 30.507 70.529 c 21.706 88.903 21.985 112.576 31.224 131.5 c 40.187 149.857 59.173 165.402 79.153 170.743 c \r\n"+"89.388 173.479 110.417 173.17 120.117 170.142 c 146.304 161.968 166.186 141.215 171.737 116.263 c 174.174 105.311 173.305 88.205 169.757 77.285 c \r\n"+"163.1 56.798 144.109 38.334 122.431 31.271 c 116.04 29.189 112.245 28.675 101.153 28.387 c 92.119 28.152 85.668 28.49 81.653 29.406 c h \r\n"+"111.653 44.504 m 132.341 48.848 149.671 64.959 155.751 85.5 c 158.113 93.481 158.113 107.519 155.751 115.5 c 150.089 134.629 134.635 149.703 114.653 155.588 c \r\n"+"106.553 157.973 90.741 157.974 82.695 155.589 c 62.46 149.592 46.687 133.961 41.605 114.869 c 39.656 107.547 39.74 91.753 41.764 84.932 c \r\n"+"50.494 55.507 80.736 38.013 111.653 44.504 c h \r\n"+"90.005 77.33 m 76.55 82.362 69.825 98.176 75.898 110.5 c 78.035 114.836 83.045 119.856 87.653 122.277 c 93.231 125.208 104.066 125.204 109.705 122.27 c \r\n"+"127.735 112.887 128.781 89.485 111.62 79.428 c 106.047 76.162 95.789 75.166 90.005 77.33 c h";break;case Q.DotRectangle:l="23.847 98.805 m 23.847 171.305 l 98.347 171.305 l 172.847 171.305 l 172.847 98.805 l 172.847 26.305 l 98.347 26.305 l 23.847 26.305 l 23.847 98.805 l h \r\n"+"157.847 98.813 m 157.847 156.321 l 98.597 156.063 l 39.347 155.805 l 39.089 98.555 l 38.831 41.305 l 98.339 41.305 l 157.847 41.305 l 157.847 98.813 l h \r\n"+"63.527 64.959 m 63.153 65.333 62.847 80.638 62.847 98.972 c 62.847 132.305 l 98.361 132.305 l 133.874 132.305 l 133.611 98.555 l 133.347 64.805 l \r\n"+"98.777 64.542 l 79.763 64.398 63.901 64.585 63.527 64.959 c h";break;case Q.NoneCircle:l="83.5 29.406 m 61.222 34.493 42.346 49.67 32.355 70.529 c 23.554 88.903 23.832 112.576 33.071 131.5 c 42.034 149.857 61.02 165.402 81 170.743 c \r\n"+"91.235 173.479 112.265 173.17 121.965 170.142 c 148.151 161.968 168.034 141.215 173.585 116.263 c 176.022 105.311 175.152 88.205 171.605 77.285 c \r\n"+"164.948 56.798 145.957 38.334 124.278 31.271 c 117.887 29.189 114.092 28.675 103 28.387 c 93.966 28.152 87.515 28.49 83.5 29.406 c h \r\n"+"113.5 44.504 m 134.189 48.848 151.519 64.959 157.598 85.5 c 159.961 93.481 159.961 107.519 157.598 115.5 c 151.937 134.629 136.483 149.703 116.5 155.588 c \r\n"+"108.401 157.973 92.589 157.974 84.543 155.589 c 64.308 149.592 48.534 133.961 43.453 114.869 c 41.504 107.547 41.588 91.753 43.612 84.932 c \r\n"+"52.342 55.507 82.583 38.013 113.5 44.504 c h";break;case Q.NoneRectangle:l="24.153 97.958 m 24.153 170.458 l 98.653 170.458 l 173.153 170.458 l 173.153 97.958 l 173.153 25.458 l 98.653 25.458 l 24.153 25.458 l 24.153 97.958 l h \r\n"+"157.911 97.708 m 157.653 154.958 l 98.653 154.958 l 39.653 154.958 l 39.393 98.958 l 39.25 68.158 39.348 42.395 39.611 41.708 c \r\n"+"39.987 40.727 52.819 40.458 99.129 40.458 c 158.169 40.458 l 157.911 97.708 l h";break}t.service.pageStream.writeLine("q"),t.service.pushColorToStack();let m=r.toColor(a.textBrush);if(0!=m.a&&t.service.setNonStrokeColor(m),(a.textBrush.stimulsoft.is(n)||a.textBrush.stimulsoft.is(s))&&(i&&t.service.storeShadingData2(t.X,t.Y,t.Width,t.Height,a.textBrush),t.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+t.service.shadingCurrent)),a.textBrush.stimulsoft.is(o)){let e=a.textBrush.stimulsoft.as(o);t.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",t.service.getHatchNumber(e)+1)}t.service.setStrokeColor(a.contourColor),t.service.pageStream.writeLine1("{0} w",t.service.convertToString(a.size)),t.service.pageStream.writeLine1("1 0 0 1 {0} {1} cm",t.service.convertToString(t.X+t.Width/2),t.service.convertToString(t.Y+t.Height/2));let c,g=Math.min(t.Width,t.Height)/200;t.service.pageStream.writeLine1("{0} 0 0 {0} 0 0 cm",t.service.convertToString(g)),t.service.pageStream.writeLine("1 0 0 1 -98 -98 cm"),t.service.pageStream.writeLine(l),t.service.pageStream.writeLine("B"),t.service.pageStream.writeLine("Q"),t.service.popColorFromStack()}}static getCheckBoxValue(t){let e=null;if(null!=t&&null!=t.checkedValue){e=!1;let i=t.checkedValue.toString().trim().toLowerCase(),r=t.values.split("/");if(1==r.length&&(r=t.values.split(";")),1==r.length&&(r=t.values.split(",")),null!=r&&r.length>0){let t;e=i==r[0].trim().toLowerCase()}}return e}}e.StiPdfRenderPrimitives=$}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.Base.Drawing.StiPenStyle,r=t.Base.Drawing.StiAdvancedBorder,n=t.System.StiArray,s=t.System.StiString,o=t.Report.Components.IStiTextBrush,a=t.Report.Components.IStiText,l=t.Report.Components.IStiTextHorAlignment,m=t.Report.Components.IStiVertAlignment,c=t.Report.Components.IStiTextOptions,g=t.Report.Components.IStiFont,h=t.Report.Components.StiText,p=t.Base.Drawing.StiTextHorAlignment,w=t.Base.Drawing.StiVertAlignment,S=t.System.Drawing.Color,d=t.Base.Drawing.StiBrush,u=t.Base.Drawing.StiGradientBrush,f=t.Base.Drawing.StiGlareBrush,E=t.Base.Drawing.StiHatchBrush,v=t.System.Text.StringBuilder,b=t.System.Char,y=t.System.Drawing.Drawing2D.Matrix;class x{static renderText(x){let A=x.Component.as(o),T=x.Component.as(a),P=x.Component.as(c),L=x.Component.as(l),C=x.Component.as(m),F=x.Component.as(h),R=null!=P&&P.textOptions.wordWrap,B=null!=L&&L.horAlignment==p.Width,I=x.service.haveAnnots&&F.editable,k=null!=P&&null!=P.textOptions&&P.textOptions.rightToLeft,D=null,N=0,H=0,O=F.textQuality==t.Report.Components.StiTextQuality.Wysiwyg;B&&(R=!0);let M=x.service.pdfFont.UseUnicode;if(null!=T){let o=F.margins,a=this.hiToTwips*o.left,l=this.hiToTwips*o.right,m=this.hiToTwips*o.top,c=this.hiToTwips*o.bottom,h=x.X+a,U=x.Y+c,X=x.Width-a-l,W=x.Height-m-c,z=0,j=0,Y=0,G=0;if(F.border.style!=i.None){let t=F.border.getSizeOffset();F.border.isLeftBorderSidePresent&&(z=t),F.border.isRightBorderSidePresent&&(j=t),F.border.isTopBorderSidePresent&&(Y=t),F.border.isBottomBorderSidePresent&&(G=t)}let V=F.border.stimulsoft.as(r);null!=V&&(z=V.leftSide.getSizeOffset(),j=V.rightSide.getSizeOffset(),Y=V.topSide.getSizeOffset(),G=V.bottomSide.getSizeOffset());let _=.94;h+=this.hiToTwips*_*z,U+=this.hiToTwips*_*G,X-=this.hiToTwips*_*(z+j),W-=this.hiToTwips*_*(Y+G),I||(x.service.pageStream.writeLine("q"),x.service.pushColorToStack(),x.service.pageStream.writeLine1("{0} {1} {2} {3} re W n",x.service.convertToString(x.X),x.service.convertToString(x.Y),x.service.convertToString(x.Width),x.service.convertToString(x.Height)));let q=S.transparent;if(null!=A){if(q=d.toColor(A.textBrush),x.service.setNonStrokeColor(q),x.service.storeShadingData2(x.X,x.Y,x.Width,x.Height,A.textBrush),(A.textBrush.is(u)||A.textBrush.is(f))&&x.service.pageStream.writeLine1("/Pattern cs /P{0} scn",1+x.service.shadingCurrent),A.textBrush.is(E)){let t=A.textBrush.as(E);x.service.pageStream.writeLine1("/Cs1 cs /PH{0} scn",x.service.getHatchNumber(t)+1)}if(I){let t;x.service.annotsArray[x.service.annotsCurrent].FontColor=q}}let K=1,Q=x.Component.as(g);null!=Q&&(K=Q.font.sizeInPoints);let J=1,Z=K*this.fontCorrectValue*x.service.pdfFont.tmASC/1e3*J,$=K*this.fontCorrectValue*x.service.pdfFont.tmDESC/1e3*-1*J,tt=K*this.fontCorrectValue*x.service.pdfFont.tmExternal/1e3*J,et=K*this.fontCorrectValue*x.service.pdfFont.UnderscoreSize/1e3*J,it=K*this.fontCorrectValue*x.service.pdfFont.UnderscorePosition/1e3*J,rt=K*this.fontCorrectValue*x.service.pdfFont.StrikeoutSize/1e3*J,nt=K*this.fontCorrectValue*x.service.pdfFont.StrikeoutPosition/1e3*J,st=(Z-$+tt)*F.lineSpacing,ot=Z,at=$,lt=!1;null!=P&&(H=P.textOptions.angle,lt=H>45&&H<135||H>225&&H<315),I&&(h-=x.X,U-=x.Y);let mt=.85,ct=0;if(F.textQuality==t.Report.Components.StiTextQuality.Standard){let t=.35-.04*(14-K);ct=137.61;let e=ct*(K*this.fontCorrectValue)/1e3;lt?(U+=t+e,W-=2*(t+e)):(h+=t+e,X-=2*(t+e))}if(F.textQuality==t.Report.Components.StiTextQuality.Typographic){let t=.05+.009*(8-K);lt?(U+=t,W-=2*t):(h+=t,X-=2*t)}let gt=T.text;if(null==gt&&(gt=""),gt=x.service.stringReplace(gt,"\r",""),gt=x.service.stringReplace(gt,"",""),I&&(D=x.service.stringReplace(T.text,"\n","")),X>0&&gt.length>0){let i=h,r=U,o=X,a=W;if(null!=P&&(H=P.textOptions.angle,0!=H)){if(lt){let t=X;X=W,W=t}h=-X/2,U=-W/2}let l=e.StiExportUtils.splitString(gt,!1);if(R)for(let t=0;t<l.length;t++){let e=l[t];if(e.length<2)continue;let i=new v,r=0;while(r<e.length)if(b.isWhitespace(e,r))i.append(e.charAt(r)),r++;else{let t=new v;while(r<e.length&&!b.isWhitespace(e,r))t.append(e.charAt(r)),r++;let n=x.service.bidi.convert(t,!1);i.append(n);let o=t.length-n.length;o>0&&i.append(s.repeat(String.fromCharCode(0),o))}let o=[],a=i.toString();for(let t=0;t<e.length;t++)o[t]=x.service.pdfFont.UnicodeMap[a.charCodeAt(t)];let m=n.create(Number,e.length),c=n.create(Number,e.length),g=0,h=0,p;for(let t=0;t<o.length;t++)o[t]>=32&&(h+=x.service.pdfFont.Widths[o[t]-32]),9==o[t]&&(h+=this.getTabsSize(P,K,h+ct)+ct),m[t]=Math.trunc(h),this.isWordWrapSymbol(a,t)&&t>0&&g++,c[t]=g;if(h*(K*this.fontCorrectValue)/1e3>X){let i=e.length-1,r=Math.trunc(1e3*X/(K*this.fontCorrectValue));while(m[i]>r&&i>0)i--;let n=i;if(c[i]>0)if(c[i]!=c[i+1]){n=i++;while(b.isWhitespace(a,i)&&"\t"!=a.charAt(i))i++}else{while(!this.isWordWrapSymbol(a,i))i--;n=i-1;while(b.isWhitespace(a,n)&&n>0)n--;while(b.isWhitespace(a,i)&&"\t"!=a.charAt(i))i++}else i++;l[t]=B?e.substr(0,n+1)+String.fromCharCode(7):e.substr(0,n+1),l.stimulsoft.insert(t+1,e.substr(i,e.length-i).stimulsoft.trimStart(" "))}}N=l.length;let m=-1;for(let t=0;t<l.length;t++){let e=l[t],i=x.service.bidi.convert(new v(e),k).toString(),r="";for(let t=0;t<i.length;t++)r+=String.fromCharCode(x.service.pdfFont.UnicodeMap[i.charCodeAt(t)]);l[t]=r}if(null!=C){let e=st,i=N*e,r=C.vertAlignment;0!=H&&90!=H&&180!=H&&270!=H&&(r=w.Center),r==w.Top&&(U+=W-i+(e-ot)),r==w.Center&&(F.textQuality==t.Report.Components.StiTextQuality.Typographic?U+=(W-i)/2-at:U+=(W-i)/2+1.2*(e-ot)),r==w.Bottom&&(F.textQuality==t.Report.Components.StiTextQuality.Typographic?U+=-at:U+=1.4*(e-ot))}x.service.pageStream.writeLine("BT");let c=0,g=0,S=n.create2(Number,l.length,3),d=null;if(0!=H){let t=H*Math.PI/180;d=new y(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),i+o/2,r+a/2),x.service.pdfFont.NeedSyntItalic&&null!=Q&&Q.font.italic||x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",x.service.convertToString(d.elements[0]),x.service.convertToString(d.elements[1]),x.service.convertToString(d.elements[2]),x.service.convertToString(d.elements[3]),x.service.convertToString(d.elements[4]),x.service.convertToString(d.elements[5]))}x.service.pdfFont.NeedSyntBold&&null!=Q&&Q.font.bold&&(x.service.pageStream.writeLine1("{0} w 2 Tr",x.service.convertToString(this.boldFontStrokeWidthValue*K,3)),x.service.setStrokeColor(q));for(let t=0;t<N;t++){let i=l[t],r=n.create(Number,i.length),s=0,o=0,a=0,w=1e3*X/(K*this.fontCorrectValue),u=x.service.pdfFont.Widths[x.service.pdfFont.UnicodeMap["…".charCodeAt(0)]],f=0;for(let t=0;t<i.length;t++){let e=i.charCodeAt(t);if(e>=32&&(o+=x.service.pdfFont.Widths[e-32]),9==e){let t=this.getTabsSize(P,K,o);o+=t,r[s++]=t}o+u<w&&(a=o,f=t)}if(o=o*(K*this.fontCorrectValue)/1e3,-1!=m&&(t==N-1&&m<l.length||o>X)&&(i=i.substr(0,f)+String.fromCharCode(x.service.pdfFont.UnicodeMap["…".charCodeAt(0)]),o=(a+u)*(K*this.fontCorrectValue)/1e3),M){let t=new v;for(let e=0;e<i.length;e++){e%121==120&&t.appendLine("\r");let r=i.charCodeAt(e);if(32==r||9==r||7==r)t.append(i.charAt(e));else{let e=x.service.pdfFont.GlyphList[r];65535==e&&(e=0),t.appendFormat("{0:X4}",e)}}i=t.toString()}else i=e.StiPdfExportService.convertToEscapeSequence(i);let E=h,b=U+st*(N-t-1),A=!1,T=!1;if(null!=L){let e=L.horAlignment;if(B&&(i.length>0&&7===i.charCodeAt(i.length-1)?i=i.substr(0,i.length-1):e=p.Left),null!=P&&null!=P.textOptions&&P.textOptions.rightToLeft&&(e==p.Left?e=p.Right:e==p.Right&&(e=p.Left)),e==p.Center&&(E+=(X-o)/2),e==p.Right&&(E+=X-o),e==p.Width){let e=0;for(let t=0;t<i.length;t++)32===i.charCodeAt(t)&&e++;if(e>0&&(t!=l.length-1||O&&o>X)){T=!0;let t=(X-o)/e*1e3/(K*this.fontCorrectValue);if(t>0||O){A=!0,t+=x.service.pdfFont.Widths[0],t<.5*x.service.pdfFont.Widths[0]&&(t=.5*x.service.pdfFont.Widths[0]);let e=M?"<":"(";for(let r=0;r<i.length;r++)32===i.charCodeAt(r)?e+=M?">-"+x.service.convertToString(t)+"<":")-"+x.service.convertToString(t)+"(":e+=i[r];e+=M?">":")",i=e}}}}if(s>0){let t=0,e="";0==T&&(e+=M?"<":"(");for(let n=0;n<i.length;n++)if("\t"==i[n]){let i=r[t++];e+=M?">-"+x.service.convertToString(i)+"<":")-"+x.service.convertToString(i)+"("}else e+=i[n];0==T&&(e+=M?">":")"),i=e}M&&(i=x.service.stringReplace(i," ",x.service.pdfFont.GlyphList[32].toString(16).stimulsoft.padLeft(4,"0")).stimulsoft.replaceAll("a","0000"));let C=null!=x.service.pdfFont.ChildFontsMap,F=0,R=n.create(Number,i.length),I=new Array;for(let t=0;t<i.length;t++){let e=i.charCodeAt(t);R[t]=e;let r=!1;if(13==e&&(I.push(t),r=!0),C){let n=x.service.pdfFont.UnicodeMapBack[e];92==e&&(n=x.service.pdfFont.UnicodeMapBack[i.charCodeAt(t+1)]);let s=x.service.pdfFont.ChildFontsMap[n];n<64&&(t>0?s=F:i.length>1&&(s=x.service.pdfFont.ChildFontsMap[x.service.pdfFont.UnicodeMapBack[i.charCodeAt(1)]])),92!=e&&(R[t]=x.service.pdfFont.fonts[s].UnicodeMap[n]),s==F||r||0==t||I.push(t),F=s}}if(I.push(i.length),S[t][0]=E,S[t][1]=b,S[t][2]=o,x.service.pdfFont.NeedSyntItalic&&null!=Q&&Q.font.italic){let t=new y(1,0,this.italicAngleTanValue,1,E,b);null!=d&&t.multiply(t),x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} Tm",x.service.convertToString(t.elements[0]),x.service.convertToString(t.elements[1]),x.service.convertToString(t.elements[2]),x.service.convertToString(t.elements[3]),x.service.convertToString(t.elements[4]),x.service.convertToString(t.elements[5]))}else x.service.pageStream.writeLine1("{0} {1} Td",x.service.convertToString(E-c),x.service.convertToString(b-g)),c=E,g=b;let k=0;for(let t=0;t<I.length;t++){if(C&&i.length>0){let t=i.charCodeAt(k)<64&&i.length>k+1?k+1:k,e=x.service.pdfFont.ChildFontsMap[x.service.pdfFont.UnicodeMapBack[i.charCodeAt(t)]];x.service.pageStream.writeLine1("/F{0} {1} Tf",e,x.service.convertToString(K*this.fontCorrectValue,this.precision_digits_font))}let e=I[t],r=e-k;r>0&&(A||s>0?(x.service.pageStream.writeString("["),t>0&&x.service.pageStream.writeString(M?"<":"("),x.service.pageStream.write(R,k,r),t<I.length-1&&x.service.pageStream.writeString(M?">":")"),x.service.pageStream.writeLine("] TJ")):(x.service.pageStream.writeString(M?"<":"("),x.service.pageStream.write(R,k,r),x.service.pageStream.writeLine1("{0} Tj",M?">":")"))),k=e,e<R.length-1&&13==R[e]&&k++}}if(x.service.pdfFont.NeedSyntBold&&null!=Q&&Q.font.bold&&x.service.pageStream.writeLine("0 Tr"),x.service.pageStream.writeLine("ET"),null!=Q&&Q.font.underline){x.service.pageStream.writeLine("q"),x.service.pushColorToStack();let t=.07*K,e=.1*-K;if(0!=x.service.pdfFont.UnderscoreSize&&(t=et,e=it),t<.1&&(t=.1),x.service.pageStream.writeLine1("{0} w",x.service.convertToString(t)),0!=H){let t=H*Math.PI/180;x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",x.service.convertToString(Math.cos(t)),x.service.convertToString(Math.sin(t)),x.service.convertToString(-Math.sin(t)),x.service.convertToString(Math.cos(t)),x.service.convertToString(i+o/2),x.service.convertToString(r+a/2))}null!=A&&x.service.setStrokeColor(q);for(let t=0;t<l.length;t++)0!=S[t][2]&&(x.service.pageStream.writeLine1("{0} {1} m",x.service.convertToString(S[t][0]),x.service.convertToString(S[t][1]+e)),x.service.pageStream.writeLine1("{0} {1} l S",x.service.convertToString(S[t][0]+S[t][2]),x.service.convertToString(S[t][1]+e)));x.service.pageStream.writeLine("Q"),x.service.popColorFromStack()}if(null!=Q&&Q.font.strikeout){x.service.pageStream.writeLine("q"),x.service.pushColorToStack();let t=.045*K,e=.25*K;if(0!=x.service.pdfFont.StrikeoutSize&&(t=rt,e=nt),t<.1&&(t=.1),x.service.pageStream.writeLine1("{0} w",x.service.convertToString(t)),0!=H){let t=H*Math.PI/180;x.service.pageStream.writeLine1("{0} {1} {2} {3} {4} {5} cm",x.service.convertToString(Math.cos(t)),x.service.convertToString(Math.sin(t)),x.service.convertToString(-Math.sin(t)),x.service.convertToString(Math.cos(t)),x.service.convertToString(i+o/2),x.service.convertToString(r+a/2))}null!=A&&x.service.setStrokeColor(q);for(let t=0;t<l.length;t++)0!=S[t][2]&&(x.service.pageStream.writeLine1("{0} {1} m",x.service.convertToString(S[t][0]),x.service.convertToString(S[t][1]+e)),x.service.pageStream.writeLine1("{0} {1} l S",x.service.convertToString(S[t][0]+S[t][2]),x.service.convertToString(S[t][1]+e)));x.service.pageStream.writeLine("Q"),x.service.popColorFromStack()}}if(I){let t=x.service.annotsArray[x.service.annotsCurrent];if(t.Multiline=R,t.X=x.X,t.Y=x.Y,t.Width=x.Width,t.Height=x.Height,t.Text=D,t.Component=x.Component,t.Alignment=p.Left,null!=L){let e=L.horAlignment;null!=P&&null!=P.textOptions&&P.textOptions.rightToLeft&&(e==p.Left?e=p.Right:e==p.Right&&(e=p.Left)),t.Alignment=e}}I||(x.service.pageStream.writeLine("Q"),x.service.popColorFromStack())}}static isWordWrapSymbol(t,e){let i=t.charCodeAt(e),r=t.charAt(e);if(i>=12288&&i<=55215||b.isWhitespace(t,e)&&160!=i||"("==r||"{"==r)return!0;if(e>0){let i=t.charAt(e-1);if("!"==i||"%"==i||")"==i||"}"==i||"-"==i||"?"==i)return!0}return!1}static getTabsSize(t,e,i){if(null!=t&&null!=t.textOptions){let r=i,n=750/e,s=n*t.textOptions.distanceBetweenTabs,o=n*t.textOptions.firstTabOffset+s;if(i<o)r=o;else if(t.textOptions.distanceBetweenTabs>0){let t=Math.trunc((i-o)/s);t++,r=o+t*s}return r-i}return 0}static renderTextFont(t){let e=t.Component.as(g);if(null!=e){let i=t.service.pdfFont.getFontNumber(e.font),r=e.font.sizeInPoints*this.fontCorrectValue;if(t.service.pageStream.writeLine1("/F{0} {1} Tf",i,t.service.convertToString(r,this.precision_digits_font)),t.service.pdfFont.currentFont=i,t.service.haveAnnots&&t.Component.as(h).editable){let e=t.service.annotsArray[t.service.annotsCurrent];e.FontNumber=i,e.FontSize=r}}}}x.hiToTwips=.72,x.precision_digits_font=3,x.fontCorrectValue=.955,x.boldFontStrokeWidthValue=.031,x.italicAngleTanValue=.325,e.StiPdfRenderText=x}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(t){var e;!function(t){class e{static get standardFontCharsNames(){if(null==this._standardFontCharsNames){let t=["0020space","0021exclam","0022quotedbl","0023numbersign","0024dollar","0025percent","0026ampersand","0027quotesingle","0028parenleft","0029parenright","002Aasterisk","002Bplus","002Ccomma","002Dhyphen","002Eperiod","002Fslash","0030zero","0031one","0032two","0033three","0034four","0035five","0036six","0037seven","0038eight","0039nine","003Acolon","003Bsemicolon","003Cless","003Dequal","003Egreater","003Fquestion","0040at","0041A","0042B","0043C","0044D","0045E","0046F","0047G","0048H","0049I","004AJ","004BK","004CL","004DM","004EN","004FO","0050P","0051Q","0052R","0053S","0054T","0055U","0056V","0057W","0058X","0059Y","005AZ","005Bbracketleft","005Cbackslash","005Dbracketright","005Easciicircum","005Funderscore","0060grave","0061a","0062b","0063c","0064d","0065e","0066f","0067g","0068h","0069i","006Aj","006Bk","006Cl","006Dm","006En","006Fo","0070p","0071q","0072r","0073s","0074t","0075u","0076v","0077w","0078x","0079y","007Az","007Bbraceleft","007Cbar","007Dbraceright","007Easciitilde","007FcontrolDEL","00A0nbspace","00A1exclamdown","00A2cent","00A3sterling","00A4currency","00A5yen","00A6brokenbar","00A7section","00A8dieresis","00A9copyright","00AAordfeminine","00ABguillemotleft","00AClogicalnot","00ADsofthyphen","00AEregistered","00AFmacron","00B0degree","00B1plusminus","00B2twosuperior","00B3threesuperior","00B4acute","00B5mu","00B6paragraph","00B7periodcentered","00B8cedilla","00B9onesuperior","00BAordmasculine","00BBguillemotright","00BConequarter","00BDonehalf","00BEthreequarters","00BFquestiondown","00C0Agrave","00C1Aacute","00C2Acircumflex","00C3Atilde","00C4Adieresis","00C5Aring","00C6AE","00C7Ccedilla","00C8Egrave","00C9Eacute","00CAEcircumflex","00CBEdieresis","00CCIgrave","00CDIacute","00CEIcircumflex","00CFIdieresis","00D0Eth","00D1Ntilde","00D2Ograve","00D3Oacute","00D4Ocircumflex","00D5Otilde","00D6Odieresis","00D7multiply","00D8Oslash","00D9Ugrave","00DAUacute","00DBUcircumflex","00DCUdieresis","00DDYacute","00DEThorn","00DFgermandbls","00E0agrave","00E1aacute","00E2acircumflex","00E3atilde","00E4adieresis","00E5aring","00E6ae","00E7ccedilla","00E8egrave","00E9eacute","00EAecircumflex","00EBedieresis","00ECigrave","00EDiacute","00EEicircumflex","00EFidieresis","00F0eth","00F1ntilde","00F2ograve","00F3oacute","00F4ocircumflex","00F5otilde","00F6odieresis","00F7divide","00F8oslash","00F9ugrave","00FAuacute","00FBucircumflex","00FCudieresis","00FDyacute","00FEthorn","00FFydieresis","0100Amacron","0101amacron","0102Abreve","0103abreve","0104Aogonek","0105aogonek","0106Cacute","0107cacute","0108Ccircumflex","0109ccircumflex","010ACdotaccent","010Bcdotaccent","010CCcaron","010Dccaron","010EDcaron","010Fdcaron","0110Dcroat","0111dcroat","0112Emacron","0113emacron","0114Ebreve","0115ebreve","0116Edotaccent","0117edotaccent","0118Eogonek","0119eogonek","011AEcaron","011Becaron","011CGcircumflex","011Dgcircumflex","011EGbreve","011Fgbreve","0120Gdotaccent","0121gdotaccent","0122Gcommaaccent","0123gcommaaccent","0124Hcircumflex","0125hcircumflex","0126Hbar","0127hbar","0128Itilde","0129itilde","012AImacron","012Bimacron","012CIbreve","012Dibreve","012EIogonek","012Fiogonek","0130Idotaccent","0131dotlessi","0132IJ","0133ij","0134Jcircumflex","0135jcircumflex","0136Kcommaaccent","0137kcommaaccent","0138kgreenlandic","0139Lacute","013Alacute","013BLcommaaccent","013Clcommaaccent","013DLcaron","013Elcaron","013FLdot","0140ldot","0141Lslash","0142lslash","0143Nacute","0144nacute","0145Ncommaaccent","0146ncommaaccent","0147Ncaron","0148ncaron","0149napostrophe","014AEng","014Beng","014COmacron","014Domacron","014EObreve","014Fobreve","0150Ohungarumlaut","0151ohungarumlaut","0152OE","0153oe","0154Racute","0155racute","0156Rcommaaccent","0157rcommaaccent","0158Rcaron","0159rcaron","015ASacute","015Bsacute","015CScircumflex","015Dscircumflex","015EScedilla","015Fscedilla","0160Scaron","0161scaron","0162Tcommaaccent","0163tcommaaccent","0164Tcaron","0165tcaron","0166Tbar","0167tbar","0168Utilde","0169utilde","016AUmacron","016Bumacron","016CUbreve","016Dubreve","016EUring","016Furing","0170Uhungarumlaut","0171uhungarumlaut","0172Uogonek","0173uogonek","0174Wcircumflex","0175wcircumflex","0176Ycircumflex","0177ycircumflex","0178Ydieresis","0179Zacute","017Azacute","017BZdotaccent","017Czdotaccent","017DZcaron","017Ezcaron","017Flongs","0180bstroke","0181Bhook","0182Btopbar","0183btopbar","0184Tonesix","0185tonesix","0186Oopen","0187Chook","0188chook","0189Dafrican","018ADhook","018BDtopbar","018Cdtopbar","018Ddeltaturned","018EEreversed","018FSchwa","0190Eopen","0191Fhook","0192florin","0193Ghook","0194Gammaafrican","0195hv","0196Iotaafrican","0197Istroke","0198Khook","0199khook","019Albar","019Blambdastroke","019CMturned","019DNhookleft","019Enlegrightlong","019FOcenteredtilde","01A0Ohorn","01A1ohorn","01A2Oi","01A3oi","01A4Phook","01A5phook","01A6yr","01A7Tonetwo","01A8tonetwo","01A9Esh","01AAeshreversedloop","01ABtpalatalhook","01ACThook","01ADthook","01AETretroflexhook","01AFUhorn","01B0uhorn","01B1Upsilonafrican","01B2Vhook","01B3Yhook","01B4yhook","01B5Zstroke","01B6zstroke","01B7Ezh","01B8Ezhreversed","01B9ezhreversed","01BAezhtail","01BBtwostroke","01BCTonefive","01BDtonefive","01BEglottalinvertedstroke","01BFwynn","01C0clickdental","01C1clicklateral","01C2clickalveolar","01C3clickretroflex","01C4DZcaron","01C5Dzcaron","01C6dzcaron","01C7LJ","01C8Lj","01C9lj","01CANJ","01CBNj","01CCnj","01CDAcaron","01CEacaron","01CFIcaron","01D0icaron","01D1Ocaron","01D2ocaron","01D3Ucaron","01D4ucaron","01F0jcaron","01F1DZ","01F2Dz","01F3dz","01F4Gacute","01F5gacute","01FAAringacute","01FBaringacute","01FCAEacute","01FDaeacute","01FEOslashacute","01FFoslashacute","0254oopen","0255ccurl","0256dtail","0257dhook","0258ereversed","0259schwa","025Aschwahook","025Beopen","025Fjdotlessstroke","0260ghook","0261gscript","0264ramshorn","0265hturned","0266hhook","0267henghook","0268istroke","0269iotalatin","026Clbelt","026Elezh","026Fmturned","0271mhook","0272nhookleft","0275obarred","0278philatin","0279rturned","027Brhookturned","027Crlongleg","027Drhook","027Erfishhook","0282shook","0283esh","0286eshcurl","0287tturned","0289ubar","028Bvhook","028Cvturned","028Dwturned","028Eyturned","0290zretroflexhook","0291zcurl","0292ezh","0293ezhcurl","0294glottalstop","02A3dzaltone","02A4dezh","02A5dzcurl","02A6ts","02A7tesh","02A8tccurl","02D6plusmod","02D7minusmod","02D8breve","02D9dotaccent","02DAring","02DBogonek","02DCtilde","0391Alpha","0392Beta","0393Gamma","0394Deltagreek","0395Epsilon","0396Zeta","0397Eta","0398Theta","0399Iota","039AKappa","039BLambda","039CMu","039DNu","039EXi","039FOmicron","03A0Pi","03A1Rho","03A3Sigma","03A4Tau","03A5Upsilon","03A6Phi","03A7Chi","03A8Psi","03A9Omegagreek","03AAIotadieresis","03ABUpsilondieresis","03ACalphatonos","03ADepsilontonos","03AEetatonos","03AFiotatonos","03B0upsilondieresistonos","03B1alpha","03B2beta","03B3gamma","03B4delta","03B5epsilon","03B6zeta","03B7eta","03B8theta","03B9iota","03BAkappa","03BBlambda","03BCmu","03BDnu","03BExi","03BFomicron","03C0pi","03C1rho","03C2sigma1","03C3sigma","03C4tau","03C5upsilon","03C6phi","03C7chi","03C8psi","03C9omega","03CAiotadieresis","03CBupsilondieresis","03CComicrontonos","03CDupsilontonos","03CEomegatonos","03D0betasymbolgreek","03D1theta1","03D2Upsilon1","03D5phi1","03D6omega1","03DAStigmagreek","03DCDigammagreek","03DEKoppagreek","03E0Sampigreek","03E2Sheicoptic","03E3sheicoptic","03E4Feicoptic","03E5feicoptic","03E6Kheicoptic","03E7kheicoptic","03E8Horicoptic","03E9horicoptic","03EAGangiacoptic","03EBgangiacoptic","03ECShimacoptic","03EDshimacoptic","03EEDeicoptic","03EFdeicoptic","03F0kappasymbolgreek","03F1rhosymbolgreek","03F3yotgreek","0401afii10023","0402afii10051","0403afii10052","0404afii10053","0405afii10054","0406afii10055","0407afii10056","0408afii10057","0409afii10058","040Aafii10059","040Bafii10060","040Cafii10061","040Eafii10062","040Fafii10145","0410afii10017","0411afii10018","0412afii10019","0413afii10020","0414afii10021","0415afii10022","0416afii10024","0417afii10025","0418afii10026","0419afii10027","041Aafii10028","041Bafii10029","041Cafii10030","041Dafii10031","041Eafii10032","041Fafii10033","0420afii10034","0421afii10035","0422afii10036","0423afii10037","0424afii10038","0425afii10039","0426afii10040","0427afii10041","0428afii10042","0429afii10043","042Aafii10044","042Bafii10045","042Cafii10046","042Dafii10047","042Eafii10048","042Fafii10049","0430afii10065","0431afii10066","0432afii10067","0433afii10068","0434afii10069","0435afii10070","0436afii10072","0437afii10073","0438afii10074","0439afii10075","043Aafii10076","043Bafii10077","043Cafii10078","043Dafii10079","043Eafii10080","043Fafii10081","0440afii10082","0441afii10083","0442afii10084","0443afii10085","0444afii10086","0445afii10087","0446afii10088","0447afii10089","0448afii10090","0449afii10091","044Aafii10092","044Bafii10093","044Cafii10094","044Dafii10095","044Eafii10096","044Fafii10097","0451afii10071","0452afii10099","0453afii10100","0454afii10101","0455afii10102","0456afii10103","0457afii10104","0458afii10105","0459afii10106","045Aafii10107","045Bafii10108","045Cafii10109","045Eafii10110","045Fafii10193","0462afii10146","0463afii10194","0472afii10147","0473afii10195","0474afii10148","0475afii10196","0490afii10050","0491afii10098","04D9afii10846","060Cafii57388","061Bafii57403","061Fafii57407","0621afii57409","0622afii57410","0623afii57411","0624afii57412","0625afii57413","0626afii57414","0627afii57415","0628afii57416","0629afii57417","062Aafii57418","062Bafii57419","062Cafii57420","062Dafii57421","062Eafii57422","062Fafii57423","0630afii57424","0631afii57425","0632afii57426","0633afii57427","0634afii57428","0635afii57429","0636afii57430","0637afii57431","0638afii57432","0639afii57433","063Aafii57434","0640afii57440","0641afii57441","0642afii57442","0643afii57443","0644afii57444","0645afii57445","0646afii57446","0647afii57470","0648afii57448","0649afii57449","064Aafii57450","064Bafii57451","064Cafii57452","064Dafii57453","064Eafii57454","064Fafii57455","0650afii57456","0651afii57457","0652afii57458","0660afii57392","0661afii57393","0662afii57394","0663afii57395","0664afii57396","0665afii57397","0666afii57398","0667afii57399","0668afii57400","0669afii57401","066Aafii57381","066Bdecimalseparatorarabic","066Cthousandsseparatorarabic","066Dafii63167","0679afii57511","067Eafii57506","0686afii57507","0688afii57512","0691afii57513","0698afii57508","06A4afii57505","06AFafii57509","06BAafii57514","06C1hehaltonearabic","06D1yehthreedotsbelowarabic","06D2afii57519","06D5afii57534","06F0zeropersian","06F1onepersian","06F2twopersian","06F3threepersian","06F4fourpersian","06F5fivepersian","06F6sixpersian","06F7sevenpersian","06F8eightpersian","06F9ninepersian","1E00Aringbelow","1E01aringbelow","1E02Bdotaccent","1E03bdotaccent","1E04Bdotbelow","1E05bdotbelow","1E06Blinebelow","1E07blinebelow","1E08Ccedillaacute","1E09ccedillaacute","1E0ADdotaccent","1E0Bddotaccent","1E0CDdotbelow","1E0Dddotbelow","1E0EDlinebelow","1E0Fdlinebelow","1E10Dcedilla","1E11dcedilla","1E12Dcircumflexbelow","1E13dcircumflexbelow","1E14Emacrongrave","1E15emacrongrave","1E16Emacronacute","1E17emacronacute","1E18Ecircumflexbelow","1E19ecircumflexbelow","1E1AEtildebelow","1E1Betildebelow","1E1CEcedillabreve","1E1Decedillabreve","1E1EFdotaccent","1E1Ffdotaccent","1E20Gmacron","1E21gmacron","1E22Hdotaccent","1E23hdotaccent","1E24Hdotbelow","1E25hdotbelow","1E26Hdieresis","1E27hdieresis","1E28Hcedilla","1E29hcedilla","1E2AHbrevebelow","1E2Bhbrevebelow","1E2CItildebelow","1E2Ditildebelow","1E2EIdieresisacute","1E2Fidieresisacute","1E30Kacute","1E31kacute","1E32Kdotbelow","1E33kdotbelow","1E34Klinebelow","1E35klinebelow","1E36Ldotbelow","1E37ldotbelow","1E38Ldotbelowmacron","1E39ldotbelowmacron","1E3ALlinebelow","1E3Bllinebelow","1E3CLcircumflexbelow","1E3Dlcircumflexbelow","1E3EMacute","1E3Fmacute","1E40Mdotaccent","1E41mdotaccent","1E42Mdotbelow","1E43mdotbelow","1E44Ndotaccent","1E45ndotaccent","1E46Ndotbelow","1E47ndotbelow","1E48Nlinebelow","1E49nlinebelow","1E4ANcircumflexbelow","1E4Bncircumflexbelow","1E4COtildeacute","1E4Dotildeacute","1E4EOtildedieresis","1E4Fotildedieresis","1E50Omacrongrave","1E51omacrongrave","1E52Omacronacute","1E53omacronacute","1E54Pacute","1E55pacute","1E56Pdotaccent","1E57pdotaccent","1E58Rdotaccent","1E59rdotaccent","1E5ARdotbelow","1E5Brdotbelow","1E5CRdotbelowmacron","1E5Drdotbelowmacron","1E5ERlinebelow","1E5Frlinebelow","1E60Sdotaccent","1E61sdotaccent","1E62Sdotbelow","1E63sdotbelow","1E64Sacutedotaccent","1E65sacutedotaccent","1E66Scarondotaccent","1E67scarondotaccent","1E68Sdotbelowdotaccent","1E69sdotbelowdotaccent","1E6ATdotaccent","1E6Btdotaccent","1E6CTdotbelow","1E6Dtdotbelow","1E6ETlinebelow","1E6Ftlinebelow","1E70Tcircumflexbelow","1E71tcircumflexbelow","1E72Udieresisbelow","1E73udieresisbelow","1E74Utildebelow","1E75utildebelow","1E76Ucircumflexbelow","1E77ucircumflexbelow","1E78Utildeacute","1E79utildeacute","1E7AUmacrondieresis","1E7Bumacrondieresis","1E7CVtilde","1E7Dvtilde","1E7EVdotbelow","1E7Fvdotbelow","1E80Wgrave","1E81wgrave","1E82Wacute","1E83wacute","1E84Wdieresis","1E85wdieresis","1E86Wdotaccent","1E87wdotaccent","1E88Wdotbelow","1E89wdotbelow","1E8AXdotaccent","1E8Bxdotaccent","1E8CXdieresis","1E8Dxdieresis","1E8EYdotaccent","1E8Fydotaccent","1E90Zcircumflex","1E91zcircumflex","1E92Zdotbelow","1E93zdotbelow","1E94Zlinebelow","1E95zlinebelow","1E96hlinebelow","1E97tdieresis","1E98wring","1E99yring","1E9Aarighthalfring","1E9Bslongdotaccent","1EA0Adotbelow","1EA1adotbelow","1EA2Ahookabove","1EA3ahookabove","1EA4Acircumflexacute","1EA5acircumflexacute","1EA6Acircumflexgrave","1EA7acircumflexgrave","1EA8Acircumflexhookabove","1EA9acircumflexhookabove","1EAAAcircumflextilde","1EABacircumflextilde","1EACAcircumflexdotbelow","1EADacircumflexdotbelow","1EAEAbreveacute","1EAFabreveacute","1EB0Abrevegrave","1EB1abrevegrave","1EB2Abrevehookabove","1EB3abrevehookabove","1EB4Abrevetilde","1EB5abrevetilde","1EB6Abrevedotbelow","1EB7abrevedotbelow","1EB8Edotbelow","1EB9edotbelow","1EBAEhookabove","1EBBehookabove","1EBCEtilde","1EBDetilde","1EBEEcircumflexacute","1EBFecircumflexacute","1EC0Ecircumflexgrave","1EC1ecircumflexgrave","1EC2Ecircumflexhookabove","1EC3ecircumflexhookabove","1EC4Ecircumflextilde","1EC5ecircumflextilde","1EC6Ecircumflexdotbelow","1EC7ecircumflexdotbelow","1EC8Ihookabove","1EC9ihookabove","1ECAIdotbelow","1ECBidotbelow","1ECCOdotbelow","1ECDodotbelow","1ECEOhookabove","1ECFohookabove","1ED0Ocircumflexacute","1ED1ocircumflexacute","1ED2Ocircumflexgrave","1ED3ocircumflexgrave","1ED4Ocircumflexhookabove","1ED5ocircumflexhookabove","1ED6Ocircumflextilde","1ED7ocircumflextilde","1ED8Ocircumflexdotbelow","1ED9ocircumflexdotbelow","1EDAOhornacute","1EDBohornacute","1EDCOhorngrave","1EDDohorngrave","1EDEOhornhookabove","1EDFohornhookabove","1EE0Ohorntilde","1EE1ohorntilde","1EE2Ohorndotbelow","1EE3ohorndotbelow","1EE4Udotbelow","1EE5udotbelow","1EE6Uhookabove","1EE7uhookabove","1EE8Uhornacute","1EE9uhornacute","1EEAUhorngrave","1EEBuhorngrave","1EECUhornhookabove","1EEDuhornhookabove","1EEEUhorntilde","1EEFuhorntilde","1EF0Uhorndotbelow","1EF1uhorndotbelow","1EF2Ygrave","1EF3ygrave","1EF4Ydotbelow","1EF5ydotbelow","1EF6Yhookabove","1EF7yhookabove","1EF8Ytilde","1EF9ytilde","2002enspace","200Bzerowidthspace","200Cafii61664","200Dafii301","200Eafii299","200Fafii300","2010hyphentwo","2012figuredash","2013endash","2014emdash","2015afii00208","2016dblverticalbar","2017underscoredbl","2018quoteleft","2019quoteright","201Aquotesinglbase","201Bquotereversed","201Cquotedblleft","201Dquotedblright","201Equotedblbase","2020dagger","2021daggerdbl","2022bullet","2024onedotenleader","2025twodotenleader","2026ellipsis","202Cafii61573","202Dafii61574","202Eafii61575","2030perthousand","2032minute","2033second","2035primereversed","2039guilsinglleft","203Aguilsinglright","203Breferencemark","203Cexclamdbl","203Eoverline","2042asterism","2044fraction","2070zerosuperior","2074foursuperior","2075fivesuperior","2076sixsuperior","2077sevensuperior","2078eightsuperior","2079ninesuperior","207Aplussuperior","207Cequalsuperior","207Dparenleftsuperior","207Eparenrightsuperior","207Fnsuperior","2080zeroinferior","2081oneinferior","2082twoinferior","2083threeinferior","2084fourinferior","2085fiveinferior","2086sixinferior","2087seveninferior","2088eightinferior","2089nineinferior","208Dparenleftinferior","208Eparenrightinferior","20A1colonmonetary","20A2cruzeiro","20A3franc","20A4afii08941","20A7peseta","20A9won","20AAafii57636","20ABdong","20ACEuro","2103centigrade","2105afii61248","2109fahrenheit","2111Ifraktur","2113afii61289","2116afii61352","2118weierstrass","211CRfraktur","211Eprescription","2121telephone","2122trademark","2126Omega","212Bangstrom","212Eestimated","2135aleph","2153onethird","2154twothirds","215Boneeighth","215Cthreeeighths","215Dfiveeighths","215Eseveneighths","2160Oneroman","2161Tworoman","2162Threeroman","2163Fourroman","2164Fiveroman","2165Sixroman","2166Sevenroman","2167Eightroman","2168Nineroman","2169Tenroman","216AElevenroman","216BTwelveroman","2170oneroman","2171tworoman","2172threeroman","2173fourroman","2174fiveroman","2175sixroman","2176sevenroman","2177eightroman","2178nineroman","2179tenroman","217Aelevenroman","217Btwelveroman","2200universal","2202partialdiff","2203existential","2205emptyset","2206Delta","2207gradient","2208element","2209notelement","220Bsuchthat","220Cnotcontains","220Fproduct","2211summation","2212minus","2213minusplus","2215divisionslash","2217asteriskmath","2219bulletoperator","221Aradical","221Dproportional","221Einfinity","221Forthogonal","2220angle","2223divides","2225parallel","2226notparallel","2227logicaland","2228logicalor","2229intersection","222Aunion","222Bintegral","222Cdblintegral","222Econtourintegral","2234therefore","2235because","2236ratio","2237proportion","223Csimilar","223Dreversedtilde","2243asymptoticallyequal","2245congruent","2248approxequal","224Callequal","2250approaches","2251geometricallyequal","2252approxequalorimage","2253imageorapproximatelyequal","2260notequal","2261equivalence","2262notidentical","2264lessequal","2265greaterequal","2266lessoverequal","2267greateroverequal","226Amuchless","226Bmuchgreater","226Enotless","226Fnotgreater","2270notlessnorequal","2271notgreaternorequal","2272lessorequivalent","2273greaterorequivalent","2276lessorgreater","2277greaterorless","2279notgreaternorless","227Aprecedes","227Bsucceeds","2280notprecedes","2281notsucceeds","2282propersubset","2283propersuperset","2284notsubset","2285notsuperset","2286reflexsubset","2287reflexsuperset","228Asubsetnotequal","228Bsupersetnotequal","2295circleplus","2296minuscircle","2297circlemultiply","2299circleot","22A3tackleft","22A4tackdown","22A5perpendicular","22BFrighttriangle","22C5dotmath","22CEcurlyor","22CFcurlyand","22DAlessequalorgreater","22DBgreaterequalorless","22EEellipsisvertical","F6BEdotlessj","F6BFLL","F6C0ll","F6C3commaaccent","F6C4afii10063","F6C5afii10064","F6C6afii10192","F6C7afii10831","F6C8afii10832","F6C9Acute","F6CACaron","F6CBDieresis","F6CCDieresisAcute","F6CDDieresisGrave","F6CEGrave","F6CFHungarumlaut","F6D0Macron","F6D1cyrBreve","F6D2cyrFlex","F6D3dblGrave","F6D4cyrbreve","F6D5cyrflex","F6D6dblgrave","F6D7dieresisacute","F6D8dieresisgrave","F6D9copyrightserif","F6DAregisterserif","F6DBtrademarkserif","F6DConefitted","F6DDrupiah","F8FFapple","FB00ff","FB01fi","FB02fl","FB03ffi","FB04ffl","FE61asterisksmall","FE62plussmall","FE63hyphensmall","FE64lesssmall","FE65greatersmall","FE66equalsmall","FE69dollarsmall","FE6Apercentsmall","FE6Batsmall"];this._standardFontCharsNames=[];for(let e=0;e<t.length;e++){let i=parseInt(t[e].substr(0,4),16);this._standardFontCharsNames[i]=t[e].substr(4)}}return this._standardFontCharsNames}}e.sRGBprofile=[0,0,12,72,76,105,110,111,2,16,0,0,109,110,116,114,82,71,66,32,88,89,90,32,7,206,0,2,0,9,0,6,0,49,0,0,97,99,115,112,77,83,70,84,0,0,0,0,73,69,67,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,246,214,0,1,0,0,0,0,211,45,72,80,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,17,99,112,114,116,0,0,1,80,0,0,0,51,100,101,115,99,0,0,1,132,0,0,0,108,119,116,112,116,0,0,1,240,0,0,0,20,98,107,112,116,0,0,2,4,0,0,0,20,114,88,89,90,0,0,2,24,0,0,0,20,103,88,89,90,0,0,2,44,0,0,0,20,98,88,89,90,0,0,2,64,0,0,0,20,100,109,110,100,0,0,2,84,0,0,0,112,100,109,100,100,0,0,2,196,0,0,0,136,118,117,101,100,0,0,3,76,0,0,0,134,118,105,101,119,0,0,3,212,0,0,0,36,108,117,109,105,0,0,3,248,0,0,0,20,109,101,97,115,0,0,4,12,0,0,0,36,116,101,99,104,0,0,4,48,0,0,0,12,114,84,82,67,0,0,4,60,0,0,8,12,103,84,82,67,0,0,4,60,0,0,8,12,98,84,82,67,0,0,4,60,0,0,8,12,116,101,120,116,0,0,0,0,67,111,112,121,114,105,103,104,116,32,40,99,41,32,49,57,57,56,32,72,101,119,108,101,116,116,45,80,97,99,107,97,114,100,32,67,111,109,112,97,110,121,0,0,100,101,115,99,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,18,115,82,71,66,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,243,81,0,1,0,0,0,1,22,204,88,89,90,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,88,89,90,32,0,0,0,0,0,0,111,162,0,0,56,245,0,0,3,144,88,89,90,32,0,0,0,0,0,0,98,153,0,0,183,133,0,0,24,218,88,89,90,32,0,0,0,0,0,0,36,160,0,0,15,132,0,0,182,207,100,101,115,99,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,22,73,69,67,32,104,116,116,112,58,47,47,119,119,119,46,105,101,99,46,99,104,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,46,73,69,67,32,54,49,57,54,54,45,50,46,49,32,68,101,102,97,117,108,116,32,82,71,66,32,99,111,108,111,117,114,32,115,112,97,99,101,32,45,32,115,82,71,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,100,101,115,99,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,44,82,101,102,101,114,101,110,99,101,32,86,105,101,119,105,110,103,32,67,111,110,100,105,116,105,111,110,32,105,110,32,73,69,67,54,49,57,54,54,45,50,46,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,118,105,101,119,0,0,0,0,0,19,164,254,0,20,95,46,0,16,207,20,0,3,237,204,0,4,19,11,0,3,92,158,0,0,0,1,88,89,90,32,0,0,0,0,0,76,9,86,0,80,0,0,0,87,31,231,109,101,97,115,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,143,0,0,0,2,115,105,103,32,0,0,0,0,67,82,84,32,99,117,114,118,0,0,0,0,0,0,4,0,0,0,0,5,0,10,0,15,0,20,0,25,0,30,0,35,0,40,0,45,0,50,0,55,0,59,0,64,0,69,0,74,0,79,0,84,0,89,0,94,0,99,0,104,0,109,0,114,0,119,0,124,0,129,0,134,0,139,0,144,0,149,0,154,0,159,0,164,0,169,0,174,0,178,0,183,0,188,0,193,0,198,0,203,0,208,0,213,0,219,0,224,0,229,0,235,0,240,0,246,0,251,1,1,1,7,1,13,1,19,1,25,1,31,1,37,1,43,1,50,1,56,1,62,1,69,1,76,1,82,1,89,1,96,1,103,1,110,1,117,1,124,1,131,1,139,1,146,1,154,1,161,1,169,1,177,1,185,1,193,1,201,1,209,1,217,1,225,1,233,1,242,1,250,2,3,2,12,2,20,2,29,2,38,2,47,2,56,2,65,2,75,2,84,2,93,2,103,2,113,2,122,2,132,2,142,2,152,2,162,2,172,2,182,2,193,2,203,2,213,2,224,2,235,2,245,3,0,3,11,3,22,3,33,3,45,3,56,3,67,3,79,3,90,3,102,3,114,3,126,3,138,3,150,3,162,3,174,3,186,3,199,3,211,3,224,3,236,3,249,4,6,4,19,4,32,4,45,4,59,4,72,4,85,4,99,4,113,4,126,4,140,4,154,4,168,4,182,4,196,4,211,4,225,4,240,4,254,5,13,5,28,5,43,5,58,5,73,5,88,5,103,5,119,5,134,5,150,5,166,5,181,5,197,5,213,5,229,5,246,6,6,6,22,6,39,6,55,6,72,6,89,6,106,6,123,6,140,6,157,6,175,6,192,6,209,6,227,6,245,7,7,7,25,7,43,7,61,7,79,7,97,7,116,7,134,7,153,7,172,7,191,7,210,7,229,7,248,8,11,8,31,8,50,8,70,8,90,8,110,8,130,8,150,8,170,8,190,8,210,8,231,8,251,9,16,9,37,9,58,9,79,9,100,9,121,9,143,9,164,9,186,9,207,9,229,9,251,10,17,10,39,10,61,10,84,10,106,10,129,10,152,10,174,10,197,10,220,10,243,11,11,11,34,11,57,11,81,11,105,11,128,11,152,11,176,11,200,11,225,11,249,12,18,12,42,12,67,12,92,12,117,12,142,12,167,12,192,12,217,12,243,13,13,13,38,13,64,13,90,13,116,13,142,13,169,13,195,13,222,13,248,14,19,14,46,14,73,14,100,14,127,14,155,14,182,14,210,14,238,15,9,15,37,15,65,15,94,15,122,15,150,15,179,15,207,15,236,16,9,16,38,16,67,16,97,16,126,16,155,16,185,16,215,16,245,17,19,17,49,17,79,17,109,17,140,17,170,17,201,17,232,18,7,18,38,18,69,18,100,18,132,18,163,18,195,18,227,19,3,19,35,19,67,19,99,19,131,19,164,19,197,19,229,20,6,20,39,20,73,20,106,20,139,20,173,20,206,20,240,21,18,21,52,21,86,21,120,21,155,21,189,21,224,22,3,22,38,22,73,22,108,22,143,22,178,22,214,22,250,23,29,23,65,23,101,23,137,23,174,23,210,23,247,24,27,24,64,24,101,24,138,24,175,24,213,24,250,25,32,25,69,25,107,25,145,25,183,25,221,26,4,26,42,26,81,26,119,26,158,26,197,26,236,27,20,27,59,27,99,27,138,27,178,27,218,28,2,28,42,28,82,28,123,28,163,28,204,28,245,29,30,29,71,29,112,29,153,29,195,29,236,30,22,30,64,30,106,30,148,30,190,30,233,31,19,31,62,31,105,31,148,31,191,31,234,32,21,32,65,32,108,32,152,32,196,32,240,33,28,33,72,33,117,33,161,33,206,33,251,34,39,34,85,34,130,34,175,34,221,35,10,35,56,35,102,35,148,35,194,35,240,36,31,36,77,36,124,36,171,36,218,37,9,37,56,37,104,37,151,37,199,37,247,38,39,38,87,38,135,38,183,38,232,39,24,39,73,39,122,39,171,39,220,40,13,40,63,40,113,40,162,40,212,41,6,41,56,41,107,41,157,41,208,42,2,42,53,42,104,42,155,42,207,43,2,43,54,43,105,43,157,43,209,44,5,44,57,44,110,44,162,44,215,45,12,45,65,45,118,45,171,45,225,46,22,46,76,46,130,46,183,46,238,47,36,47,90,47,145,47,199,47,254,48,53,48,108,48,164,48,219,49,18,49,74,49,130,49,186,49,242,50,42,50,99,50,155,50,212,51,13,51,70,51,127,51,184,51,241,52,43,52,101,52,158,52,216,53,19,53,77,53,135,53,194,53,253,54,55,54,114,54,174,54,233,55,36,55,96,55,156,55,215,56,20,56,80,56,140,56,200,57,5,57,66,57,127,57,188,57,249,58,54,58,116,58,178,58,239,59,45,59,107,59,170,59,232,60,39,60,101,60,164,60,227,61,34,61,97,61,161,61,224,62,32,62,96,62,160,62,224,63,33,63,97,63,162,63,226,64,35,64,100,64,166,64,231,65,41,65,106,65,172,65,238,66,48,66,114,66,181,66,247,67,58,67,125,67,192,68,3,68,71,68,138,68,206,69,18,69,85,69,154,69,222,70,34,70,103,70,171,70,240,71,53,71,123,71,192,72,5,72,75,72,145,72,215,73,29,73,99,73,169,73,240,74,55,74,125,74,196,75,12,75,83,75,154,75,226,76,42,76,114,76,186,77,2,77,74,77,147,77,220,78,37,78,110,78,183,79,0,79,73,79,147,79,221,80,39,80,113,80,187,81,6,81,80,81,155,81,230,82,49,82,124,82,199,83,19,83,95,83,170,83,246,84,66,84,143,84,219,85,40,85,117,85,194,86,15,86,92,86,169,86,247,87,68,87,146,87,224,88,47,88,125,88,203,89,26,89,105,89,184,90,7,90,86,90,166,90,245,91,69,91,149,91,229,92,53,92,134,92,214,93,39,93,120,93,201,94,26,94,108,94,189,95,15,95,97,95,179,96,5,96,87,96,170,96,252,97,79,97,162,97,245,98,73,98,156,98,240,99,67,99,151,99,235,100,64,100,148,100,233,101,61,101,146,101,231,102,61,102,146,102,232,103,61,103,147,103,233,104,63,104,150,104,236,105,67,105,154,105,241,106,72,106,159,106,247,107,79,107,167,107,255,108,87,108,175,109,8,109,96,109,185,110,18,110,107,110,196,111,30,111,120,111,209,112,43,112,134,112,224,113,58,113,149,113,240,114,75,114,166,115,1,115,93,115,184,116,20,116,112,116,204,117,40,117,133,117,225,118,62,118,155,118,248,119,86,119,179,120,17,120,110,120,204,121,42,121,137,121,231,122,70,122,165,123,4,123,99,123,194,124,33,124,129,124,225,125,65,125,161,126,1,126,98,126,194,127,35,127,132,127,229,128,71,128,168,129,10,129,107,129,205,130,48,130,146,130,244,131,87,131,186,132,29,132,128,132,227,133,71,133,171,134,14,134,114,134,215,135,59,135,159,136,4,136,105,136,206,137,51,137,153,137,254,138,100,138,202,139,48,139,150,139,252,140,99,140,202,141,49,141,152,141,255,142,102,142,206,143,54,143,158,144,6,144,110,144,214,145,63,145,168,146,17,146,122,146,227,147,77,147,182,148,32,148,138,148,244,149,95,149,201,150,52,150,159,151,10,151,117,151,224,152,76,152,184,153,36,153,144,153,252,154,104,154,213,155,66,155,175,156,28,156,137,156,247,157,100,157,210,158,64,158,174,159,29,159,139,159,250,160,105,160,216,161,71,161,182,162,38,162,150,163,6,163,118,163,230,164,86,164,199,165,56,165,169,166,26,166,139,166,253,167,110,167,224,168,82,168,196,169,55,169,169,170,28,170,143,171,2,171,117,171,233,172,92,172,208,173,68,173,184,174,45,174,161,175,22,175,139,176,0,176,117,176,234,177,96,177,214,178,75,178,194,179,56,179,174,180,37,180,156,181,19,181,138,182,1,182,121,182,240,183,104,183,224,184,89,184,209,185,74,185,194,186,59,186,181,187,46,187,167,188,33,188,155,189,21,189,143,190,10,190,132,190,255,191,122,191,245,192,112,192,236,193,103,193,227,194,95,194,219,195,88,195,212,196,81,196,206,197,75,197,200,198,70,198,195,199,65,199,191,200,61,200,188,201,58,201,185,202,56,202,183,203,54,203,182,204,53,204,181,205,53,205,181,206,54,206,182,207,55,207,184,208,57,208,186,209,60,209,190,210,63,210,193,211,68,211,198,212,73,212,203,213,78,213,209,214,85,214,216,215,92,215,224,216,100,216,232,217,108,217,241,218,118,218,251,219,128,220,5,220,138,221,16,221,150,222,28,222,162,223,41,223,175,224,54,224,189,225,68,225,204,226,83,226,219,227,99,227,235,228,115,228,252,229,132,230,13,230,150,231,31,231,169,232,50,232,188,233,70,233,208,234,91,234,229,235,112,235,251,236,134,237,17,237,156,238,40,238,180,239,64,239,204,240,88,240,229,241,114,241,255,242,140,243,25,243,167,244,52,244,194,245,80,245,222,246,109,246,251,247,138,248,25,248,168,249,56,249,199,250,87,250,231,251,119,252,7,252,152,253,41,253,186,254,75,254,220,255,109,255,255],e.hatchData=["000000FF00000000","1010101010101010","8040201008040201","0102040810204080","101010FF10101010","8142241818244281","8000000008000000","0010000100100001","2200880022008800","2288228822882288","2255885522558855","AA558A55AA55A855","AA55AA55AA55AA55","BB55EE55BB55EE55","DD77DD77DD77DD77","FFDDFF77FFDDFF77","FF7FFFF7FF7FFFF7","FF7FFFFFFFF7FFFF","8844221188442211","1122448811224488","CC663399CC663399","993366CC993366CC","E070381C0E0783C1","C183070E1C3870E0","4040404040404040","00FF000000FF0000","AAAAAAAAAAAAAAAA","FF00FF00FF00FF00","CCCCCCCCCCCCCCCC","FFFF0000FFFF0000","8844221100000000","1122448800000000","F00000000F000000","8080808008080808","0240088004200110","0C8DB130031BD8C0","8403304884033048","00304A8100304A81","0102040818244281","202020FF020202FF","1422518854224588","F0F0F0F0AA55AA55","0100201020000102","AA00800080008000","0020008800020088","8448300C02010103","33FFCCFF33FFCCFF","98F8F877898F8F77","111111FF111111FF","3333CCCC3333CCCC","0F0F0F0FF0F0F0F0","0502058850205088","10387CFE7C381000","0000000000000000"],e.standardFontWidths=null,e.standardFontInfo=null,e._standardFontCharsNames=null,t.StiPdfResources=e}(e=t.Export||(t.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.System.StiArray,r=t.System.StiString;class n{constructor(t){this.ownerValue=[],this.userValue=[],this.ownerExtendedValue=[],this.userExtendedValue=[],this.permsValue=[],this.IDValue=null,this.encryptionKey=null,this.encryptionKeyLength=0,this.passwordOwner="",this.passwordUser="",this.securityFlags=0,this.keyLength=e.StiPdfEncryptionKeyLength.Bit40,this.pdfService=null,this.pdfService=t}padPassword(t){let e=[],i=0;for(;i<t.length;i++)e[i]=t.charCodeAt(i);for(let t=0;t<n.paddingString.length;t++)e[i++]=n.paddingString[t];let r=[];for(i=0;i<32;i++)r[i]=e[i];return r}computingCryptoValues(t,i,r,n,s){this.securityFlags=4294967232;let o=0;0!=(t&e.StiUserAccessPrivileges.PrintDocument)&&(o|=1<<2),0!=(t&e.StiUserAccessPrivileges.ModifyContents)&&(o|=1<<3),0!=(t&e.StiUserAccessPrivileges.CopyTextAndGraphics)&&(o|=1<<4),0!=(t&e.StiUserAccessPrivileges.AddOrModifyTextAnnotations)&&(o|=1<<5),this.securityFlags|=o,null==i&&(i=""),null==r&&(r=""),this.passwordOwner=i,this.passwordUser=r,this.keyLength=n,this.IDValue=s;let a=!1;if(this.passwordOwner.length>0||this.passwordUser.length>0||t!=e.StiUserAccessPrivileges.All){let t;a=!0,this.computingCryptoValues2()||(a=!1,this.throwEncryptionError(0,"Encryption not work!"))}return a}computingCryptoValues2(){if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128_r4)return this.computingCryptoValuesV4();if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r6)return this.computingCryptoValuesV5();let t=this.passwordOwner;r.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);let i=this.padPassword(t),s=this.computeHashMD5(i);if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)for(let t=0;t<50;t++)s=this.computeHashMD5(s);if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit40){let t=[];t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],s=t}let o=this.padPassword(this.passwordUser);if(o=this.rc4(o,s),this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)for(let t=1;t<=19;t++){for(let e=0;e<16;e++)s[e]^=t-1,s[e]^=t;o=this.rc4(o,s)}o.stimulsoft.copyTo(this.ownerValue,0);let a=this.passwordUser,l=this.padPassword(a),m=this.getBytesUInt32(this.securityFlags),c=[];if(c.stimulsoft.addRange(l),c.stimulsoft.addRange(o),c.stimulsoft.addRange(m),c.stimulsoft.addRange(this.IDValue),s=this.computeHashMD5(c),this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)for(let t=0;t<50;t++)s=this.computeHashMD5(s);this.encryptionKey=[],this.encryptionKeyLength=this.keyLength==e.StiPdfEncryptionKeyLength.Bit128?16:5;for(let t=0;t<this.encryptionKeyLength;t++)this.encryptionKey[t]=s[t];let g=[];if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128){c=[],c.stimulsoft.addRange(n.paddingString),c.stimulsoft.addRange(this.IDValue),s=this.computeHashMD5(c),s=this.rc4(s,this.encryptionKey);let t=[];for(let e=1;e<=19;e++){for(let i=0;i<16;i++)t[i]=this.encryptionKey[i]^e;s=this.rc4(s,t)}n.paddingString.stimulsoft.copyTo(g,0),s.stimulsoft.copyTo(g,0)}else n.paddingString.stimulsoft.copyTo(g,0),g=this.rc4(g,this.encryptionKey);return g.stimulsoft.copyTo(this.userValue,0),!0}computingCryptoValuesV4(){let t=this.passwordOwner;r.isNullOrEmpty(this.passwordOwner)&&(t=this.passwordUser);let e=this.padPassword(t),i=this.computeHashMD5(e);for(let t=0;t<50;t++)i=this.computeHashMD5(i);let s=this.padPassword(this.passwordUser);s=this.rc4(s,i);for(let t=1;t<=19;t++){for(let e=0;e<16;e++)i[e]^=t-1,i[e]^=t;s=this.rc4(s,i)}s.stimulsoft.copyTo(this.ownerValue,0);let o=this.passwordUser,a=this.padPassword(o),l=this.getBytesUInt32(this.securityFlags),m=[];m.stimulsoft.addRange(a),m.stimulsoft.addRange(s),m.stimulsoft.addRange(l),m.stimulsoft.addRange(this.IDValue),i=this.computeHashMD5(m);for(let t=0;t<50;t++)i=this.computeHashMD5(i);this.encryptionKey=[],this.encryptionKeyLength=16;for(let t=0;t<this.encryptionKeyLength;t++)this.encryptionKey[t]=i[t];let c=[];m=[],m.stimulsoft.addRange(n.paddingString),m.stimulsoft.addRange(this.IDValue),i=this.computeHashMD5(m),i=this.rc4(i,this.encryptionKey);let g=[];for(let t=1;t<=19;t++){for(let e=0;e<16;e++)g[e]=this.encryptionKey[e]^t;i=this.rc4(i,g)}return n.paddingString.stimulsoft.copyTo(c,0),i.stimulsoft.copyTo(c,0),c.stimulsoft.copyTo(this.userValue,0),!0}computingCryptoValuesV5(){let e=new t.System.Crypt.SecureRandom,n=null,s=null,o=e.createNextBytes(32),a=e.createNextBytes(8),l=e.createNextBytes(8),m=e.createNextBytes(8),c=e.createNextBytes(8),g=t.System.Text.Encoding.UTF8.getBytes(this.passwordUser);if(g.length>127){let t=[];i.copy2(g,0,t,0,127),g=t}s=this.getHashV5(g,a,null),s.stimulsoft.copyTo(this.userValue,0),a.stimulsoft.copyTo(this.userValue,32),l.stimulsoft.copyTo(this.userValue,40),s=this.getHashV5(g,l,null),this.encodeKeyDataV5(s,o,!0).stimulsoft.copyTo(this.userExtendedValue,0);let h=this.passwordOwner;r.isNullOrEmpty(this.passwordOwner)&&(h=this.passwordUser);let p=t.System.Text.Encoding.UTF8.getBytes(h);if(p.length>127){let t=[];i.copy2(p,0,t,0,127),p=t}return s=this.getHashV5(p,m,this.userValue),s.stimulsoft.copyTo(this.ownerValue,0),m.stimulsoft.copyTo(this.ownerValue,32),c.stimulsoft.copyTo(this.ownerValue,40),s=this.getHashV5(p,c,this.userValue),this.encodeKeyDataV5(s,o,!0).stimulsoft.copyTo(this.ownerExtendedValue,0),n=e.createNextBytes(16),this.getBytesUInt32(this.securityFlags).stimulsoft.copyTo(n,0),n[4]=255,n[5]=255,n[6]=255,n[7]=255,n[8]=84,n[9]=97,n[10]=100,n[11]=98,this.permsValue=this.encodeKeyDataV5(o,n,!1),s=this.getHashV5(g,l,null),this.encryptionKey=this.decodeKeyDataV5(s,this.userExtendedValue,!0),n=this.decodeKeyDataV5(this.encryptionKey,this.permsValue,!1),97==n[9]&&100==n[10]&&98==n[11]||this.throwEncryptionError(102,"Verifying key calculation failed"),!0}encodeKeyDataV5(e,i,r){let n=null;if(r){let r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s;n=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(e,r).encrypt(i)}else{let r;n=new t.ExternalLibrary.aesjs.ModeOfOperation.ecb(e).encrypt(i)}let s=[];for(let t=0;t<n.length;t++)s[t]=n[t];return s}decodeKeyDataV5(e,i,r){let n=null;if(r){let r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s;n=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(e,r).decrypt(i)}else{let r;n=new t.ExternalLibrary.aesjs.ModeOfOperation.ecb(e).decrypt(i)}let s=[];for(let t=0;t<n.length;t++)s[t]=n[t];return s}getHashV5(t,i,r){return this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5?n.calculate_hash_r5(t,i,r):n.calculate_hash_r6(t,i,r)}static calculate_hash_r5(e,i,r){let n=[];return n.stimulsoft.addRange(e),n.stimulsoft.addRange(i),null!=r&&n.stimulsoft.addRange(r),t.System.Crypt.SHA2.SHA256(n)}static calculate_hash_r6(e,r,n){let s=[],o=[],a=32,l=0,m=null,c=[],g=[],h=new t.System.Crypt.SHA2;m=[],m.stimulsoft.addRange(e),m.stimulsoft.addRange(r),null!=n&&m.stimulsoft.addRange(n),h.SHA2_256(m).stimulsoft.copyTo(o,0);for(let r=0;r<64||r<s[64*l-1]+32;r++){m.stimulsoft.clear(),m.stimulsoft.addRange(e);for(let t=0;t<a;t++)m.push(o[t]);l=e.length+a,null!=n&&(m.stimulsoft.addRange(n),l+=48);for(let t=0;t<64;t++)m.stimulsoft.copyTo(s,t*l);i.copy2(o,0,c,0,16),i.copy2(o,16,g,0,16);let r,p=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(c,g).encrypt(s.slice(0,64*l));for(let t=0;t<p.length;t++)s[t]=p[t];let w=0;for(let t=0;t<16;t++)w+=s[t];switch(a=32+w%3*16,a){case 32:h.SHA2_256(s.slice(0,64*l)).stimulsoft.copyTo(o,0);break;case 48:h.SHA2_384(s.slice(0,64*l)).stimulsoft.copyTo(o,0);break;case 64:h.SHA2_512(s.slice(0,64*l)).stimulsoft.copyTo(o,0);break}}let p=[];return i.copy2(o,0,p,0,32),p}encryptData(i,r,n){if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit40||this.keyLength==e.StiPdfEncryptionKeyLength.Bit128){let t=r,s=n,o=[];this.encryptionKey.stimulsoft.copyTo(o,0),this.getBytesUInt32(t).stimulsoft.copyTo(o,this.encryptionKeyLength),this.getBytesUint16(s).stimulsoft.copyTo(o,this.encryptionKeyLength+3);let a=this.computeHashMD5(o);this.keyLength==e.StiPdfEncryptionKeyLength.Bit40&&(a=a.slice(0,10)),i=this.rc4(i,a)}else if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128_r4){let e=r,s=n,o=[];this.encryptionKey.stimulsoft.copyTo(o,0),this.getBytesUInt32(e).stimulsoft.copyTo(o,16),this.getBytesUint16(s).stimulsoft.copyTo(o,19),o[21]=115,o[22]=65,o[23]=108,o[24]=84;let a=this.computeHashMD5(o),l=(new t.System.Crypt.SecureRandom).createNextBytes(16),m=[],c;m.stimulsoft.addRange(l),m.stimulsoft.addRange(i),m=new t.ExternalLibrary.aesjs.padding.pkcs7.pad(m),i=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(a,l).encrypt(m)}else{let e=(new t.System.Crypt.SecureRandom).createNextBytes(16),r=[],n;r.stimulsoft.addRange(e),r.stimulsoft.addRange(i),r=new t.ExternalLibrary.aesjs.padding.pkcs7.pad(r),i=new t.ExternalLibrary.aesjs.ModeOfOperation.cbc(this.encryptionKey,e).encrypt(r)}return i}throwEncryptionError(t,e){throw new Error(r.format("EncryptionError at step {0} : {1}",t,e))}renderEncodeRecord(t){let i="",n="",s=32;this.keyLength!=e.StiPdfEncryptionKeyLength.Bit256_r5&&this.keyLength!=e.StiPdfEncryptionKeyLength.Bit256_r6||(s=48);let o=0;for(o=0;o<s;o++)i+=String.fromCharCode(this.ownerValue[o]),n+=String.fromCharCode(this.userValue[o]);if(t.writeLine("/Filter /Standard"),this.keyLength==e.StiPdfEncryptionKeyLength.Bit128)t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/V2/Length 16>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine("/R 3"),t.writeLine("/V 2"),t.writeLine("/Length 128");else if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit128_r4)t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV2/Length 16>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine("/R 4"),t.writeLine("/V 4"),t.writeLine("/Length 128");else if(this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5||this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r6){t.writeLine("/CF<</StdCF<</AuthEvent/DocOpen/CFM/AESV3/Length 32>>>>"),t.writeLine("/StmF /StdCF"),t.writeLine("/StrF /StdCF"),t.writeLine1("/R {0}",this.keyLength==e.StiPdfEncryptionKeyLength.Bit256_r5?5:6),t.writeLine("/V 5"),t.writeLine("/Length 256");let i="",n="";for(o=0;o<32;o++)i+=String.fromCharCode(this.ownerExtendedValue[o]),n+=String.fromCharCode(this.userExtendedValue[o]);let s="";for(o=0;o<16;o++)s+=String.fromCharCode(this.permsValue[o]);t.writeString(r.format("/OE ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(i)),!0),t.writeString(r.format("/UE ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(n)),!0),t.writeString(r.format("/Perms ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(s)),!0)}else t.writeLine("/R 2"),t.writeLine("/V 1"),t.writeLine("/Length 40");t.writeString(r.format("/O ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(i)),!0),t.writeString(r.format("/U ({0})",e.StiPdfExportService.convertToEscapeSequencePlusTabs(n)),!0),t.writeLine1("/P {0}",this.securityFlags)}getBytesUInt32(t){let e=[];return e.push(255&t),e.push(t>>8&255),e.push(t>>16&255),e.push(t>>24&255),e}getBytesUint16(t){let e=[];return e.push(255&t),e.push(t>>8&255),e}rc4(t,e){let i=[],r=0,n=0,s,o=[],a=e.length,l=t.length;for(r=0;r<256;r++)i[r]=r;for(r=0;r<256;r++)n=(n+i[r]+e[r%a])%256,s=i[r],i[r]=i[n],i[n]=s;r=0,n=0;for(let e=0;e<l;e++)r=(r+1)%256,n=(n+i[r])%256,s=i[r],i[r]=i[n],i[n]=s,o.push(t[e]^i[(i[r]+i[n])%256]);return o}computeHashMD5(e){let i="";for(let t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);return t.Base.StiMD5Helper.MD5(i,!1)}}n.paddingString=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122],e.StiPdfSecurity=n}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(e){var i=t.System.StiString;class r{constructor(){this.ref=-1,this.info=null}get isUsed(){return!(-1==this.ref)}addRef(){this.info.addRef(this)}toString(){if(-1==this.ref)return"-";return i.format("ref = {0}",this.ref)}}e.StiPdfObjInfo=r;class n extends r{}e.StiPdfContentObjInfo=n;class s extends r{}e.StiPdfXObjectObjInfo=s;class o extends r{}e.StiPdfFontObjInfo=o;class a extends r{}e.StiPdfOutlinesObjInfo=a;class l extends r{}e.StiPdfPatternsObjInfo=l;class m extends r{}e.StiPdfAnnotObjInfo=m;class c{}e.StiPdfCheckBoxObjInfo=c;class g extends r{}e.StiPdfAcroFormObjInfo=g;class h{constructor(){this.objectsCounter=0,this.objects=null,this.objectsCounter=0,this.objects=[],this.root=this.createObject(!0),this.info=this.createObject(!0),this.colorSpace=this.createObject(!0),this.pages=this.createObject(!0),this.structTreeRoot=this.createObject(!0),this.optionalContentGroup=this.createObject(!0),this.pageList=[],this.xObjectList=[],this.fontList=[],this.linkList=[],this.embeddedFilesList=[]}addRef(t){this.objectsCounter++,t.ref=this.objectsCounter}createObject(t=!1){let e=new r;return e.info=this,t&&this.addRef(e),e}createContentObject(t=!1){let e=new n;return e.info=this,t&&this.addRef(e),e.content=this.createObject(t),e}createXObject(t=!1,e=!1){let i=new s;return i.info=this,t&&this.addRef(i),i.mask=this.createObject(t&&e),i}createFontObject(t=!1,e=!0,i=!1,r=!0,n=!1){let s=new o;return s.info=this,t&&this.addRef(s),s.descendantFont=this.createObject(t&&e),s.toUnicode=this.createObject(t&&e),s.cIDSet=this.createObject(t&&e),s.encoding=this.createObject(t&&!e&&!n),s.fontDescriptor=this.createObject(t&&!i),s.fontFile2=this.createObject(t&&r),s}createOutlinesObject(t=!1){let e=new a;return e.info=this,t&&this.addRef(e),e.items=[],e}createPatternsObject(t=!1){let e=new l;return e.info=this,e.resources=this.createObject(t),e.first=this.createObject(t),e.hatchItems=[],e.shadingItems=[],e.shadingFunctionItems=[],e}createAcroFormObject(t=!1){let e=new g;return e.info=this,t&&this.addRef(e),e.annots=[],e.checkBoxes=[],e.unsignedSignatures=[],e.signatures=[],e.tooltips=[],e.annotFontItems=[],e}createAnnotObject(t=!1,e=!1,i=0){let r=new m;r.info=this,t&&this.addRef(r),r.aP=this.createObject(t&&e),r.aA=[];for(let e=0;e<i;e++)r.aA.push(this.createObject(t));return r}}e.StiPdfStructure=h}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.System.Char,n=t.Report.Components.StiCheckBox,s=t.System.Globalization.CultureInfo,o=t.Base.Zip.StiZipWriter20,a=t.Report.ImageFormat,l=t.Report.Components.IStiExportImageExtended,m=t.Report.Components.StiText,c=t.System.StiArray,g=t.System.Collections.Hashtable,h=t.Report.Components.StiPageOrientation,p=t.Report.Components.StiPagesCollection,w=t.System.DateTime,S=t.System.Xml.Formatting,d=t.System.Xml.XmlTextWriter,u=t.System.Text.Encoding,f=t.System.IO.StreamWriter,E=t.System.Drawing.Color,v=t.System.StiString,b=t.System.IO.MemoryStream,y=t.Base.Localization.StiLocalization;class x{constructor(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=E.transparent,this.VertAlign=StiVertAlignment.Bottom,this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=E.black,this.HorAlign=StiTextHorAlignment.Left,this.Angle=0,this.Wordwrap=!1,this.DataStyle=-1}}class A{constructor(){this.isNumeric=!1,this.isCurrency=!1,this.isPercent=!1,this.isDate=!1,this.isTime=!1,this.isDefaultFormat=!1,this.DecimalDigits=2,this.DecimalComma=" ",this.GroupDigits=0,this.CurrencySymbol="$",this.CurrencyPositionBefore=!1,this.NegativeBraces=!1,this.DateTimeFormatString=null,this.CurrencyPositivePattern=null,this.CurrencyNegativePattern=null}}class T extends i.StiExportService{constructor(){super(...arguments),this.matrix=null,this.imageCache=null,this.cellStyleList=null,this.dataStyleList=null,this.sheetNameList=null,this.matrixList=null,this.firstPageIndexList=null,this.minRowList=null,this.maxRowList=null,this.cellStyleTableList=null,this.imageQuality=.75,this.imageResolution=96,this.xmlIndentation=1}implements(){return[i.IStiOdsExportService]}get defaultExtension(){return"ods"}get exportFormat(){return e.StiExportFormat.Ods}get groupCategory(){return"Excel"}get position(){return i.StiExportPosition.Ods}get exportNameInMenu(){return y.get("Export","ExportTypeCalcFile")}get multipleFiles(){return!1}getFilter(){return y.get("FileFilters","WriteCalcFilesrFiles")}exportTo(t,e,i){this.exportOds(t,e,i)}exportToAsync(e,i,r,n){t.Report.Export.StiExportImageHelper.convertAllImages(i,t.System.Drawing.Imaging.ImageFormat.Jpeg).try(()=>{this.exportTo(i,r,n),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null),e()})}doubleToString(t){return Math.round2(t/100,4).toString().stimulsoft.replaceAll(",",".")+"in"}getColumnName(t){let e=t/26|0,i=t%26,r="";return e>0&&(r+=String.fromCharCode(65+e-1)),r+=String.fromCharCode(65+i),r}getColorString(t){return"#"+v.format("{0:X8}",t.toArgb()).substr(2)}getCellStyleNumber(e,i,r,s){let o=new x,a=!0,l=!0;for(let t=0;t<r;t++)null==this.matrix.bordersY[e+t][i]&&(a=!1),null==this.matrix.bordersY[e+t][i+s]&&(l=!1);let c=!0,g=!0;for(let t=0;t<s;t++)null==this.matrix.bordersX[e][i+t]&&(c=!1),null==this.matrix.bordersX[e+r][i+t]&&(g=!1);if(c&&(o.BorderTop=this.getStringFromBorder(this.matrix.bordersX[e][i])),a&&(o.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[e][i])),g&&(o.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[e+r][i])),l&&(o.BorderRight=this.getStringFromBorder(this.matrix.bordersY[e][i+s])),null!=this.matrix.cells[e][i]){let r=this.matrix.cells[e][i],s=r.cellStyle;o.BackColor=s.color,o.VertAlign=s.vertAlignment,o.FontName=s.font.name,o.FontSize=s.font.sizeInPoints,o.Bold=s.font.bold,o.Italic=s.font.italic,o.Underline=s.font.underline,o.FontColor=s.textColor,o.HorAlign=s.horAlignment;let a=0;if(null!=s.textOptions&&(a=s.textOptions.angle,o.Wordwrap=s.textOptions.wordWrap),o.Angle=0|Math.round(a),null!=r.component){let e=r.component.stimulsoft.as(m);null!=e&&(o.DataStyle=this.getDataStyleNumber(e));let i=r.component.stimulsoft.as(n);null==i||v.isNullOrEmpty(i.excelDataValue)||(o.FontName=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.name,o.FontSize=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.sizeInPoints,o.Bold=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.bold,o.Italic=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.italic,o.Underline=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.Font.underline,o.VertAlign=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.VertAlignment,o.HorAlign=t["StiOptions"].Export.CheckBoxReplacementForExcelValue.HorAlignment)}}if(this.cellStyleList.length>0)for(let t=0;t<this.cellStyleList.length;t++){let e=this.cellStyleList[t];if(e.BorderLeft==o.BorderLeft&&e.BorderRight==o.BorderRight&&e.BorderTop==o.BorderTop&&e.BorderBottom==o.BorderBottom&&e.BackColor.equals(o.BackColor)&&e.VertAlign==o.VertAlign&&e.FontName==o.FontName&&e.FontSize==o.FontSize&&e.Bold==o.Bold&&e.Italic==o.Italic&&e.Underline==o.Underline&&e.FontColor.equals(o.FontColor)&&e.HorAlign==o.HorAlign&&e.Angle==o.Angle&&e.Wordwrap==o.Wordwrap&&e.DataStyle==o.DataStyle)return t}return this.cellStyleList.push(o),this.cellStyleList.length-1}getStringFromBorder(t){return v.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))}getDataStyleNumber(t){let e=new A,n=t.format,s=null!=t&&t.hideZeros,o=null!=n?n.indexOf("|"):-1,a;if(-1!=o&&(e.CurrencyPositivePattern=i.StiExportUtils.getPositivePattern(n.charCodeAt(o+1)-65),e.CurrencyNegativePattern=i.StiExportUtils.getNegativePattern(n.charCodeAt(o+2)-65),n=n.substr(0,o)),v.isNullOrEmpty(n))return-1;if("C"==n.charAt(0)&&(e.isCurrency=!0),"N"==n.charAt(0)&&(e.isNumeric=!0),"P"==n.charAt(0)&&(e.isPercent=!0),"D"==n.charAt(0)&&(e.isDate=!0,n.length>1&&(e.DateTimeFormatString=n.substr(1))),"T"==n.charAt(0)&&(e.isTime=!0,n.length>1&&(e.DateTimeFormatString=n.substr(1))),1==n.length)e.isDefaultFormat=!0;else if(e.isCurrency||e.isNumeric||e.isPercent){let t=1;if(r.isDigit(n,t)){let i="";while(t<n.length&&r.isDigit(n,t))i+=n.charAt(t),t++;e.DecimalDigits=parseInt(i)}t<n.length&&"G"==n.charAt(t)&&(t++,e.GroupDigits=3),t<n.length&&"("==n.charAt(t)&&(t++,e.NegativeBraces=!0),t<n.length&&("."==n.charAt(t)||","==n.charAt(t))&&(e.DecimalComma=n.charAt(t),t++),t<n.length&&("+"==n.charAt(t)||"-"==n.charAt(t))&&("+"==n.charAt(t)&&(e.CurrencyPositionBefore=!0),t++,t<n.length&&(e.CurrencySymbol=n.substr(t)))}if(t.hideZeros&&!v.isNullOrEmpty(n)&&(e.isDefaultFormat=!1),this.dataStyleList.length>0)for(let t=0;t<this.dataStyleList.length;t++){let i=this.dataStyleList.stimulsoft.getByIndex(t);if(i.isNumeric==e.isNumeric&&i.isCurrency==e.isCurrency&&i.isPercent==e.isPercent&&i.isDate==e.isDate&&i.isTime==e.isTime&&i.isDefaultFormat==e.isDefaultFormat&&i.DecimalDigits==e.DecimalDigits&&i.DecimalComma==e.DecimalComma&&i.GroupDigits==e.GroupDigits&&i.CurrencySymbol==e.CurrencySymbol&&i.CurrencyPositionBefore==e.CurrencyPositionBefore&&i.DateTimeFormatString==e.DateTimeFormatString&&i.CurrencyPositivePattern==e.CurrencyPositivePattern&&i.CurrencyNegativePattern==e.CurrencyNegativePattern)return t}return this.dataStyleList.push(e),this.dataStyleList.stimulsoft.countItems-1}writeMimetype(){let t=new b,e=new f(t,u.ASCII);return e.write("application/vnd.oasis.opendocument.spreadsheet"),e.flush(),t}writeMeta(){let t=new b,e=new d(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?S.None:S.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");let r=w.now.toString("yyyy-MM-ddTHH:mm:ss"),n=i.StiExportUtils.getReportVersion();return e.writeElementString("meta:generator",n),e.writeElementString("meta:creation-date",r),e.writeElementString("dc:date",r),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M0S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:cell-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeManifest(){let t=new b,e=new d(u.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?S.None:S.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.spreadsheet"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft.countItems;t++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",v.format("Pictures/{0:D5}.jpg",t+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeImage(t){let e=new b,i=this.imageCache.imagePackedStore[t];return e.write(i,0,i.length),e}writeSettings(){let t=new b,e=new d(u.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?S.None:S.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("View1"),e.writeEndElement(),e.writeStartElement("config:config-item-map-named"),e.writeAttributeString("config:name","Tables"),e.writeStartElement("config:config-item-map-entry"),e.writeAttributeString("config:name","Sheet1"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CursorPositionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VerticalSplitPosition"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveSplitRange"),e.writeAttributeString("config:type","short"),e.writeString("2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionLeft"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionRight"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PositionBottom"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ActiveTable"),e.writeAttributeString("config:type","string"),e.writeString("Sheet1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HorizontalScrollbarWidth"),e.writeAttributeString("config:type","int"),e.writeString("270"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PageViewZoomValue"),e.writeAttributeString("config:type","int"),e.writeString("60"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreakPreview"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","long"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowZeroValues"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowNotes"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowGrid"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","GridColor"),e.writeAttributeString("config:type","long"),e.writeString("12632256"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowPageBreaks"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("3"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasColumnRowHeaders"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","HasSheetTabs"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsOutlineSymbolsSet"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSnapToRaster"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterIsVisible"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionX"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterResolutionY"),e.writeAttributeString("config:type","int"),e.writeString("1000"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionX"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RasterSubdivisionY"),e.writeAttributeString("config:type","int"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsRasterAxisSynchronized"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AutoCalculate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(t){let e=new b,i=new d(u.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?S.None:S.Indented,i.writeStartDocument(),i.writeStartElement("office:document-styles"),i.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),i.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),i.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),i.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),i.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),i.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),i.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),i.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),i.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),i.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),i.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),i.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),i.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),i.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),i.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),i.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),i.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),i.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),i.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),i.writeAttributeString("office:version","1.1"),i.writeStartElement("office:font-face-decls"),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Arial"),i.writeAttributeString("svg:font-family","Arial"),i.writeEndElement(),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Tahoma"),i.writeAttributeString("svg:font-family","Tahoma"),i.writeAttributeString("style:font-family-generic","system"),i.writeAttributeString("style:font-pitch","variable"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("office:styles"),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table-cell"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:decimal-places","2"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("style:tab-stop-distance","1.25cm"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:language","ru"),i.writeAttributeString("fo:country","RU"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("number:number-style"),i.writeAttributeString("style:name","N0"),i.writeStartElement("number:number"),i.writeAttributeString("number:min-integer-digits","1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Default"),i.writeAttributeString("style:family","table-cell"),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Result"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Default"),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:text-underline-style","solid"),i.writeAttributeString("style:text-underline-width","auto"),i.writeAttributeString("style:text-underline-color","font-color"),i.writeAttributeString("fo:font-weight","bold"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Heading"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Default"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:text-align-source","fix"),i.writeAttributeString("style:repeat-content","false"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:text-align","center"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-size","16pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("fo:font-weight","bold"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Heading1"),i.writeAttributeString("style:family","table-cell"),i.writeAttributeString("style:parent-style-name","Heading"),i.writeStartElement("style:table-cell-properties"),i.writeAttributeString("style:rotation-angle","90"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:automatic-styles");let r=t.getByIndex(0),n=r.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),s=r.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),o=r.unit.convertToHInches(r.margins.left),a=r.unit.convertToHInches(r.margins.right),l=r.unit.convertToHInches(r.margins.top),m=r.unit.convertToHInches(r.margins.bottom)-4;return m<0&&(m=0),i.writeStartElement("style:page-layout"),i.writeAttributeString("style:name","pm1"),i.writeStartElement("style:page-layout-properties"),i.writeAttributeString("fo:page-width",this.doubleToString(s)),i.writeAttributeString("fo:page-height",this.doubleToString(n)),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("style:print-orientation",r.orientation==h.Portrait?"portrait":"landscape"),i.writeAttributeString("fo:margin-top",this.doubleToString(l)),i.writeAttributeString("fo:margin-bottom",this.doubleToString(m)),i.writeAttributeString("fo:margin-left",this.doubleToString(o)),i.writeAttributeString("fo:margin-right",this.doubleToString(a)),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeEndElement(),i.writeStartElement("style:header-style"),i.writeStartElement("style:header-footer-properties"),i.writeAttributeString("fo:min-height","0.101cm"),i.writeAttributeString("fo:margin-left","0cm"),i.writeAttributeString("fo:margin-right","0cm"),i.writeAttributeString("fo:margin-bottom","0cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:footer-style"),i.writeStartElement("style:header-footer-properties"),i.writeAttributeString("fo:min-height","0.101cm"),i.writeAttributeString("fo:margin-left","0cm"),i.writeAttributeString("fo:margin-right","0cm"),i.writeAttributeString("fo:margin-top","0cm"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:master-styles"),i.writeStartElement("style:master-page"),i.writeAttributeString("style:name","Default"),i.writeAttributeString("style:page-layout-name","pm1"),i.writeStartElement("style:header"),i.writeAttributeString("style:display","false"),i.writeStartElement("text:p"),i.writeStartElement("text:sheet-name"),i.writeString("Sheet1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:header-left"),i.writeAttributeString("style:display","false"),i.writeEndElement(),i.writeStartElement("style:footer"),i.writeAttributeString("style:display","false"),i.writeStartElement("text:p"),i.writeString("Page "),i.writeStartElement("text:page-number"),i.writeString("1"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:footer-left"),i.writeAttributeString("style:display","false"),i.writeEndElement(),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeContent(e,r){let n=new b,s=new d(u.UTF8,n);s.indentation=this.xmlIndentation<0?0:this.xmlIndentation,s.formatting=this.xmlIndentation<0?S.None:S.Indented,s.writeStartDocument(),s.writeStartElement("office:document-content"),s.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),s.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),s.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),s.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),s.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),s.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),s.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),s.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),s.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),s.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),s.writeAttributeString("xmlns:presentation","urn:oasis:names:tc:opendocument:xmlns:presentation:1.0"),s.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),s.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),s.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),s.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),s.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),s.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),s.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),s.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),s.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),s.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),s.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),s.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),s.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),s.writeAttributeString("office:version","1.1");let o=0;while(o<r.count){let n=new p(e,r);n.addV2Internal(r.getByIndex(o));let s=o,a=r.getByIndex(o).excelSheetValue;while(o<r.count-1&&r.getByIndex(o+1).excelSheetValue==a)o++,n.addV2Internal(r.getByIndex(o));n.cacheMode=e.renderedPages.cacheMode;let l=n.getByIndex(0).excelSheetValue;v.isNullOrEmpty(l)&&(l=v.format("Page {0}",this.sheetNameList.stimulsoft.countItems+1));let m="",c=1;if(this.matrix=new i.StiMatrix(n,t["StiOptions"].Export.OpenDocumentCalc.divideBigCells,this),this.isStopped)return null;let g=0;do{this.firstPageIndexList.push(s),this.matrixList.push(this.matrix);let e=this.matrix.coordY.countItems-1;if(e-g>t["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight?e=g+t["StiOptions"].Export.OpenDocumentCalc.maximumSheetHeight:this.matrix=null,this.minRowList.push(g),this.maxRowList.push(e),g=e,(null!=this.matrix||m.length>0)&&(m=v.format(" part{0}",c++)),this.sheetNameList.push(l+m),this.isStopped)return null}while(null!=this.matrix);o++}let a=new g,l=new g,m=new g,h=new g;for(let t=0;t<this.matrixList.stimulsoft.countItems;t++){this.matrix=this.matrixList.stimulsoft.getByIndex(t);let e=this.minRowList.stimulsoft.getByIndex(t),i=this.maxRowList.stimulsoft.getByIndex(t),r=c.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),n=c.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems);for(let t=0;t<this.matrix.coordX.countItems-1;t++){let e=this.matrix.coordX.getByIndex(t+1)-this.matrix.coordX.getByIndex(t);if(!m.containsKey(e)){let t=m.count;m.set(e,t),h.set(t,e)}}for(let t=e+1;t<i+1;t++){let e=this.matrix.coordY.getByIndex(t)-this.matrix.coordY.getByIndex(t-1);if(!a.containsKey(e)){let t=a.count;a.set(e,t),l.set(t,e)}for(let e=1;e<this.matrix.coordX.countItems;e++){let i=this.matrix.cells[t-1][e-1];if(!r[t][e])if(null!=i){for(let n=0;n<=i.height;n++)for(let s=0;s<=i.width;s++)r[t+n][e+s]=!0;n[t-1][e-1]=this.getCellStyleNumber(t-1,e-1,i.height+1,i.width+1)}else n[t-1][e-1]=this.getCellStyleNumber(t-1,e-1,1,1)}}this.cellStyleTableList.push(n)}s.writeStartElement("office:scripts"),s.writeEndElement();let w=new g;for(let t of this.cellStyleList)w.set(t.FontName,t.FontName);s.writeStartElement("office:font-face-decls");for(let t of w.keys){let e=w.get(t);s.writeStartElement("style:font-face"),s.writeAttributeString("style:name",e),s.writeAttributeString("svg:font-family",e),s.writeEndElement()}s.writeEndElement(),s.writeStartElement("office:automatic-styles");for(let t=0;t<m.count;t++){s.writeStartElement("style:style"),s.writeAttributeString("style:name",v.format("co{0}",t+1)),s.writeAttributeString("style:family","table-column"),s.writeStartElement("style:table-column-properties"),s.writeAttributeString("fo:break-before","auto");let e=h.get(t);s.writeAttributeString("style:column-width",this.doubleToString(e)),s.writeEndElement(),s.writeEndElement()}for(let t=0;t<a.count;t++){s.writeStartElement("style:style"),s.writeAttributeString("style:name",v.format("ro{0}",t+1)),s.writeAttributeString("style:family","table-row"),s.writeStartElement("style:table-row-properties");let e=l.get(t);s.writeAttributeString("style:row-height",this.doubleToString(e)),s.writeAttributeString("fo:break-before","auto"),s.writeAttributeString("style:use-optimal-row-height","false"),s.writeEndElement(),s.writeEndElement()}s.writeStartElement("style:style"),s.writeAttributeString("style:name","ta1"),s.writeAttributeString("style:family","table"),s.writeAttributeString("style:master-page-name","Default"),s.writeStartElement("style:table-properties"),s.writeAttributeString("table:display","true"),s.writeAttributeString("style:writing-mode","lr-tb"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("style:style"),s.writeAttributeString("style:name","gr1"),s.writeAttributeString("style:family","graphic"),s.writeStartElement("style:graphic-properties"),s.writeAttributeString("draw:stroke","none"),s.writeAttributeString("draw:fill","none"),s.writeAttributeString("draw:textarea-horizontal-align","center"),s.writeAttributeString("draw:textarea-vertical-align","middle"),s.writeAttributeString("draw:color-mode","standard"),s.writeAttributeString("draw:luminance","0%"),s.writeAttributeString("draw:contrast","0%"),s.writeAttributeString("draw:gamma","100%"),s.writeAttributeString("draw:red","0%"),s.writeAttributeString("draw:green","0%"),s.writeAttributeString("draw:blue","0%"),s.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),s.writeAttributeString("draw:image-opacity","100%"),s.writeAttributeString("style:mirror","none"),s.writeEndElement(),s.writeEndElement(),s.writeStartElement("style:style"),s.writeAttributeString("style:name","P1"),s.writeAttributeString("style:family","paragraph"),s.writeStartElement("style:paragraph-properties"),s.writeAttributeString("fo:text-align","center"),s.writeEndElement(),s.writeEndElement();for(let t=0;t<this.dataStyleList.stimulsoft.countItems;t++){let e=this.dataStyleList.stimulsoft.getByIndex(t);e.isNumeric&&(s.writeStartElement("number:number-style"),e.NegativeBraces?(s.writeAttributeString("style:name",v.format("N{0}P0",t+1)),s.writeAttributeString("style:volatile","true")):s.writeAttributeString("style:name",v.format("N{0}",t+1))," "!=e.DecimalComma&&(s.writeAttributeString("number:language",","==e.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==e.DecimalComma?"RU":"US")),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",e.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),s.writeAttributeString("number:grouping",3==e.GroupDigits?"true":"false"),s.writeEndElement(),s.writeEndElement(),e.NegativeBraces&&(s.writeStartElement("number:number-style"),s.writeAttributeString("style:name",v.format("N{0}",t+1))," "!=e.DecimalComma&&(s.writeAttributeString("number:language",","==e.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==e.DecimalComma?"RU":"US")),s.writeElementString("number:text","("),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",e.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),s.writeAttributeString("number:grouping",3==e.GroupDigits?"true":"false"),s.writeEndElement(),s.writeElementString("number:text",")"),s.writeStartElement("style:map"),s.writeAttributeString("style:condition","value()>=0"),s.writeAttributeString("style:apply-style-name",v.format("N{0}P0",t+1)),s.writeEndElement(),s.writeEndElement())),e.isPercent&&(s.writeStartElement("number:percentage-style"),s.writeAttributeString("style:name",v.format("N{0}",t+1))," "!=e.DecimalComma&&(s.writeAttributeString("number:language",","==e.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==e.DecimalComma?"RU":"US")),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",e.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),3==e.GroupDigits&&s.writeAttributeString("number:grouping","true"),s.writeEndElement(),s.writeElementString("number:text","%"),s.writeEndElement()),e.isCurrency&&(s.writeStartElement("number:currency-style"),s.writeAttributeString("style:name",v.format("N{0}",t+1))," "!=e.DecimalComma&&(s.writeAttributeString("number:language",","==e.DecimalComma?"ru":"en"),s.writeAttributeString("number:country",","==e.DecimalComma?"RU":"US")),e.CurrencyPositionBefore&&s.writeElementString("number:currency-symbol",e.CurrencySymbol),s.writeStartElement("number:number"),s.writeAttributeString("number:decimal-places",e.DecimalDigits.toString()),s.writeAttributeString("number:min-integer-digits","1"),s.writeAttributeString("number:grouping",3==e.GroupDigits?"true":"false"),s.writeEndElement(),e.CurrencyPositionBefore||s.writeElementString("number:currency-symbol",e.CurrencySymbol),s.writeEndElement()),e.isDate&&(s.writeStartElement("number:date-style"),s.writeAttributeString("style:name",v.format("N{0}",t+1)),this.writeDateTimeFormatString(s,e.DateTimeFormatString,"d"),s.writeEndElement()),e.isTime&&(s.writeStartElement("number:time-style"),s.writeAttributeString("style:name",v.format("N{0}",t+1)),v.isNullOrEmpty(e.DateTimeFormatString)||-1==e.DateTimeFormatString.indexOf("h")||(s.writeAttributeString("number:language","en"),s.writeAttributeString("number:country","US")),this.writeDateTimeFormatString(s,e.DateTimeFormatString,"t"),s.writeEndElement())}for(let t=0;t<this.cellStyleList.stimulsoft.countItems;t++){let e=this.cellStyleList.stimulsoft.getByIndex(t);s.writeStartElement("style:style"),s.writeAttributeString("style:name",v.format("ce{0}",t+1)),s.writeAttributeString("style:family","table-cell"),s.writeAttributeString("style:parent-style-name","Default"),-1!=e.DataStyle&&s.writeAttributeString("style:data-style-name",v.format("N{0}",e.DataStyle+1)),s.writeStartElement("style:table-cell-properties"),e.BackColor.a>0?s.writeAttributeString("fo:background-color",this.getColorString(e.BackColor)):s.writeAttributeString("fo:background-color","transparent"),e.VertAlign==StiVertAlignment.Center&&s.writeAttributeString("style:vertical-align","middle"),e.VertAlign==StiVertAlignment.Top&&s.writeAttributeString("style:vertical-align","top"),s.writeAttributeString("style:text-align-source","fix"),s.writeAttributeString("style:repeat-content","false"),e.Wordwrap&&s.writeAttributeString("fo:wrap-option","wrap"),s.writeAttributeString("fo:padding","0in"),s.writeAttributeString("fo:border-left",e.BorderLeft),s.writeAttributeString("fo:border-right",e.BorderRight),s.writeAttributeString("fo:border-top",e.BorderTop),s.writeAttributeString("fo:border-bottom",e.BorderBottom),0!=e.Angle&&(s.writeAttributeString("style:rotation-angle",e.Angle.toString()),s.writeAttributeString("style:rotation-align","none")),s.writeEndElement(),s.writeStartElement("style:paragraph-properties"),e.HorAlign==StiTextHorAlignment.Left&&s.writeAttributeString("fo:text-align","start"),e.HorAlign==StiTextHorAlignment.Center&&s.writeAttributeString("fo:text-align","center"),e.HorAlign==StiTextHorAlignment.Right&&s.writeAttributeString("fo:text-align","end"),e.HorAlign==StiTextHorAlignment.Width&&s.writeAttributeString("fo:text-align","justify"),s.writeAttributeString("fo:margin-left","0cm"),s.writeEndElement(),s.writeStartElement("style:text-properties"),s.writeAttributeString("fo:color",this.getColorString(e.FontColor)),s.writeAttributeString("style:font-name",e.FontName);let i=v.format("{0}pt",e.FontSize).stimulsoft.replaceAll(",",".");s.writeAttributeString("fo:font-size",i),s.writeAttributeString("fo:font-size-asian",i),s.writeAttributeString("fo:font-size-complex",i),e.Italic&&(s.writeAttributeString("fo:font-style","italic"),s.writeAttributeString("fo:font-style-asian","italic"),s.writeAttributeString("fo:font-style-complex","italic")),e.Underline&&(s.writeAttributeString("style:text-underline-style","solid"),s.writeAttributeString("style:text-underline-width","auto"),s.writeAttributeString("style:text-underline-color","font-color")),e.Bold&&(s.writeAttributeString("fo:font-weight","bold"),s.writeAttributeString("fo:font-weight-asian","bold"),s.writeAttributeString("fo:font-weight-complex","bold")),s.writeEndElement(),s.writeEndElement()}s.writeFullEndElement(),s.writeStartElement("office:body"),s.writeStartElement("office:spreadsheet"),s.writeStartElement("table:calculation-settings"),s.writeAttributeString("table:use-regular-expressions","false"),s.writeEndElement(),this.currentPassNumber=t["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?3:2;for(let t=0;t<this.matrixList.stimulsoft.countItems;t++)this.writeTableFromMatrix(s,t,a,m);return s.writeEndElement(),s.writeEndElement(),s.writeFullEndElement(),s.writeEndDocument(),s.flush(),n}writeDateTimeFormatString(t,e,i){if(v.isNullOrEmpty(e)&&(e=i),1==e.length){let t=this.currentCulture.dateTimeFormat;switch(e){case"d":e=t.shortDatePattern;break;case"D":e=t.longDatePattern;break;case"f":e=t.shortDatePattern+" "+t.shortTimePattern;break;case"F":e=t.fullDateTimePattern;break;case"g":e=t.shortDatePattern+" "+t.shortTimePattern;break;case"G":e=t.shortDatePattern+" "+t.longTimePattern;break;case"m":case"M":e=s.currentCulture.name.stimulsoft.contains("en")||s.currentCulture.name.stimulsoft.contains("us")?"MMMM d":"d MMMM";break;case"r":case"R":e="ddd, dd MMM yyyy HH\\:mm\\:ss \\G\\M\\T";break;case"s":e="yyyy\\-MM\\-dd\\THH\\:mm\\:ss";break;case"t":e=t.shortTimePattern;break;case"T":e=t.longTimePattern;break;case"u":e="yyyy\\-MM\\-dd HH\\:mm\\:ss\\Z";break;case"U":e=t.fullDateTimePattern;break;case"y":case"Y":e=t.yearMonthPattern;break}e=e.stimulsoft.replaceAll('"',"").stimulsoft.replaceAll("'","")}let r=0;while(r<e.length){let i=e.charAt(r),n=1;while(r+1<e.length&&e.charAt(r+1)==i)r++,n++;switch(r++,i){case"d":1==n&&(t.writeStartElement("number:day"),t.writeEndElement()),2==n&&(t.writeStartElement("number:day"),t.writeAttributeString("number:style","long"),t.writeEndElement()),3==n&&(t.writeStartElement("number:day-of-week"),t.writeEndElement()),4==n&&(t.writeStartElement("number:day-of-week"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"M":1==n&&(t.writeStartElement("number:month"),t.writeEndElement()),2==n&&(t.writeStartElement("number:month"),t.writeAttributeString("number:style","long"),t.writeEndElement()),3==n&&(t.writeStartElement("number:month"),t.writeAttributeString("number:textual","true"),t.writeEndElement()),4==n&&(t.writeStartElement("number:month"),t.writeAttributeString("number:style","long"),t.writeAttributeString("number:textual","true"),t.writeEndElement());break;case"y":1!=n&&2!=n||(t.writeStartElement("number:year"),t.writeEndElement()),3!=n&&4!=n||(t.writeStartElement("number:year"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"s":1==n&&(t.writeStartElement("number:seconds"),t.writeEndElement()),2==n&&(t.writeStartElement("number:seconds"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"m":1==n&&(t.writeStartElement("number:minutes"),t.writeEndElement()),2==n&&(t.writeStartElement("number:minutes"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;case"h":case"H":1==n&&(t.writeStartElement("number:hours"),t.writeEndElement()),2==n&&(t.writeStartElement("number:hours"),t.writeAttributeString("number:style","long"),t.writeEndElement());break;default:t.writeElementString("number:text",i);break}}}writeTableFromMatrix(t,r,s,o){let a=this.matrixList[r],g=this.minRowList[r],h=this.maxRowList[r],p=this.cellStyleTableList[r],S=this.sheetNameList[r],d=c.create2(Boolean,a.coordY.countItems,a.coordX.countItems);t.writeStartElement("table:table"),t.writeAttributeString("table:name",S),t.writeAttributeString("table:style-name","ta1"),t.writeAttributeString("table:print","false");for(let e=0;e<a.coordX.countItems-1;e++){let i=a.coordX.getByIndex(e+1)-a.coordX.getByIndex(e),r=o.get(i);t.writeStartElement("table:table-column"),t.writeAttributeString("table:style-name",v.format("co{0}",r+1)),t.writeAttributeString("table:default-cell-style-name","Default"),t.writeEndElement()}let u=Math.max(a.coordY.countItems/200,1),f=0;for(let r=g+1;r<h+1;r++){let o=r/u|0;o>f&&(f=o,this.invokeExporting2(r,a.coordY.countItems,this.currentPassNumber,this.maximumPassNumber));let c=a.coordY.getByIndex(r)-a.coordY.getByIndex(r-1),g=s.get(c);t.writeStartElement("table:table-row"),t.writeAttributeString("table:style-name",v.format("ro{0}",g+1));for(let s=1;s<a.coordX.countItems;s++){let o=a.cells[r-1][s-1];if(d[r][s])t.writeStartElement("table:covered-table-cell"),t.writeEndElement();else if(null!=o){for(let t=0;t<=o.height;t++)for(let e=0;e<=o.width;e++)d[r+t][s+e]=!0;let c=p[r-1][s-1],g=this.cellStyleList[c].DataStyle;t.writeStartElement("table:table-cell"),t.writeAttributeString("table:style-name",v.format("ce{0}",c+1)),(o.width>0||o.height>0)&&(t.writeAttributeString("table:number-columns-spanned",(o.width+1).toString()),t.writeAttributeString("table:number-rows-spanned",(o.height+1).toString()));let h=o.component.stimulsoft.as(m),u=o.text,f=o.component.stimulsoft.as(n);if(null==f||v.isNullOrEmpty(f.excelDataValue)||(u=f.excelDataValue),!o.component.isExportAsImage(e.StiExportFormat.Ods)&&(!v.isNullOrEmpty(u)||null!=h&&null!=h.excelDataValue)){let e=!1,r=0,n=w.now,s=null;if(-1!=g&&null!=h&&null!=h.excelDataValue&&"-"!=h.excelDataValue){let t=h.excelDataValue,i=t.replace(/[^\d.,-]/g,"").stimulsoft.replaceAll(",",".");s=this.dataStyleList[g],e=!0;try{if(s.isDate||s.isTime){let i=w.tryParseExact(t,[null]);i.successfully?n=i.result:e=!1}else r=parseFloat(i),isNaN(r)&&(e=!1,r=0)}catch(t){e=!1}e||null!=u||(u=t)}if(e)if(s.isDate)t.writeAttributeString("office:value-type","date"),t.writeAttributeString("office:date-value",n.toString("yyyy-MM-dd"));else if(s.isTime)t.writeAttributeString("office:value-type","time"),t.writeAttributeString("office:time-value",n.toString("PTHH\\Hmm\\Mss\\S"));else{let e=r.toString().stimulsoft.replaceAll(",",".");s.isNumeric&&t.writeAttributeString("office:value-type","float"),s.isPercent&&t.writeAttributeString("office:value-type","percentage"),s.isCurrency&&t.writeAttributeString("office:value-type","currency"),t.writeAttributeString("office:value",e)}else t.writeAttributeString("office:value-type","string");let o=i.StiExportUtils.splitString(u,!0);for(let e=0;e<o.length;e++){let i=o[e];t.writeStartElement("text:p"),t.writeString(i),t.writeEndElement()}}if(o.component.isExportAsImage(e.StiExportFormat.Ods)){t.writeAttributeString("office:value-type","string");let i=o.component.stimulsoft.as(l);if(null!=i){let n=null,l={ref:this.imageResolution};if(n=i.getImage(l,e.StiExportFormat.Ods),null!=n){let e=a.getRealImageData(o,n);null!=e&&(n=e);let i=this.imageCache.addImageInt(n),l=a.coordX.getByIndex(s+o.width)-a.coordX.getByIndex(s-1),m=a.coordY.getByIndex(r+o.height)-a.coordY.getByIndex(r-1),c=v.format("'{0}'.{1}{2}",S,this.getColumnName(o.left+o.width+1),o.top+o.height+1+1);t.writeStartElement("draw:frame"),t.writeAttributeString("table:end-cell-address",c),t.writeAttributeString("table:end-x","0in"),t.writeAttributeString("table:end-y","0in"),t.writeAttributeString("draw:z-index","0"),t.writeAttributeString("draw:name",v.format("Picture{0}",i+1)),t.writeAttributeString("draw:style-name","gr1"),t.writeAttributeString("draw:text-style-name","P1"),t.writeAttributeString("text:anchor-type","paragraph"),t.writeAttributeString("svg:x",this.doubleToString(0)),t.writeAttributeString("svg:y",this.doubleToString(0)),t.writeAttributeString("svg:width",this.doubleToString(l)),t.writeAttributeString("svg:height",this.doubleToString(m)),t.writeStartElement("draw:image"),t.writeAttributeString("xlink:href",v.format("Pictures/{0:D5}.jpg",i+1)),t.writeAttributeString("xlink:type","simple"),t.writeAttributeString("xlink:show","embed"),t.writeAttributeString("xlink:actuate","onLoad"),t.writeStartElement("text:p"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement()}}}t.writeEndElement()}else{let e=p[r-1][s-1];t.writeStartElement("table:table-cell"),t.writeAttributeString("table:style-name",v.format("ce{0}",e+1)),t.writeEndElement()}}t.writeEndElement()}t.writeEndElement()}exportOds(r,n,l){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to ODT format"),null==l)throw new Error("The 'settings' argument cannot be equal in null.");let m=l.pageRange;this.imageResolution=l.imageResolution,this.imageQuality=l.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100,this.currentCulture=s.currentCulture;try{s.currentCulture=s.cultures["en-US"],this.imageCache=new e.StiImageCache(t["StiOptions"].Export.OpenDocumentCalc.allowImageComparer,!0,a.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.dataStyleList=[],this.sheetNameList=[],this.matrixList=[],this.firstPageIndexList=[],this.minRowList=[],this.maxRowList=[],this.cellStyleTableList=[],this.currentPassNumber=0,this.maximumPassNumber=t["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages?4:3;let l=m.getSelectedPages(r.renderedPages);if(t["StiOptions"].Export.OpenDocumentCalc.divideSegmentPages&&(l=i.StiSegmentPagesDivider.divide(l,this),this.currentPassNumber=1),this.isStopped)return;let c=new o;if(c.begin(n,!0),c.addFile("content.xml",this.writeContent(r,l)),c.addFile("mimetype",this.writeMimetype()),c.addFile("meta.xml",this.writeMeta()),c.addFile("META-INF/manifest.xml",this.writeManifest()),c.addFile("settings.xml",this.writeSettings()),c.addFile("styles.xml",this.writeStyles(l)),this.imageCache.imagePackedStore.stimulsoft.countItems>0)for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft.countItems;t++)c.addFile(v.format("Pictures/{0:D5}.jpg",t+1),this.writeImage(t));c.end()}finally{s.currentCulture=this.currentCulture,this.sheetNameList.stimulsoft.clear(),this.sheetNameList=null,this.firstPageIndexList.stimulsoft.clear(),this.firstPageIndexList=null,this.minRowList.stimulsoft.clear(),this.minRowList=null,this.maxRowList.stimulsoft.clear(),this.maxRowList=null;for(let t of this.matrixList)null!=t&&t.clear();this.matrixList.stimulsoft.clear(),this.matrixList=null,this.cellStyleTableList.stimulsoft.clear(),this.cellStyleTableList=null,this.dataStyleList.stimulsoft.clear(),this.dataStyleList=null,this.cellStyleList.stimulsoft.clear(),this.cellStyleList=null,this.imageCache.clear(),this.imageCache=null,r.renderedPages.cacheMode&&i.StiMatrix.GCCollect()}}}i.StiOdsExportService=T}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.System.StiArray,n=t.Base.Zip.StiZipWriter20,s=t.Report.ImageFormat,o=t.Report.Components.IStiExportImageExtended,a=t.Report.Components.StiText,l=t.System.Collections.Hashtable,m=t.Report.Components.StiPageOrientation,c=t.System.DateTime,g=t.System.Xml.Formatting,h=t.System.Xml.XmlTextWriter,p=t.System.Text.Encoding,w=t.System.IO.StreamWriter,S=t.System.Drawing.Color,d=t.System.StiString,u=t.System.IO.MemoryStream,f=t.Base.Localization.StiLocalization;class E{constructor(){this.BorderLeft="none",this.BorderRight="none",this.BorderTop="none",this.BorderBottom="none",this.BackColor=S.transparent,this.VertAlign=StiVertAlignment.Bottom}}class v{constructor(){this.FontName="Arial",this.FontSize=6,this.Bold=!1,this.Italic=!1,this.Underline=!1,this.FontColor=S.black,this.HorAlign=StiTextHorAlignment.Left,this.Angle=0}}class b extends i.StiExportService{constructor(){super(...arguments),this._matrix=null,this._removeEmptySpaceAtBottom=t["StiOptions"].Export.OpenDocumentWriter.removeEmptySpaceAtBottom,this.imageCache=null,this.cellStyleList=null,this.paragraphStyleList=null,this.xmlIndentation=1,this.imageQuality=.75,this.imageResolution=96,this.usePageHeadersAndFooters=!1}implements(){return[i.IStiOdtExportService]}get defaultExtension(){return"odt"}get exportFormat(){return e.StiExportFormat.Odt}get groupCategory(){return"Word"}get position(){return i.StiExportPosition.Odt}get exportNameInMenu(){return f.get("Export","ExportTypeWriterFile")}get multipleFiles(){return!1}getFilter(){return f.get("FileFilters","WriterFiles")}exportTo(t,e,i){this.exportOdt(t,e,i)}exportToAsync(e,i,r,n){t.Report.Export.StiExportImageHelper.convertAllImages(i,t.System.Drawing.Imaging.ImageFormat.Jpeg).try(()=>{this.exportTo(i,r,n),null!=i&&null!=i.preparedExportImages&&(i.preparedExportImages.clear(),i.preparedExportImages=null),e()})}get matrix(){return this._matrix}get removeEmptySpaceAtBottom(){return this._removeEmptySpaceAtBottom}doubleToString(t){return Math.round2(t/100,4).toString().stimulsoft.replaceAll(",",".")+"in"}getColumnName(t){let e=t/26|0,i=t%26,r="";return e>0&&(r+=String.fromCharCode(65+e-1)),r+=String.fromCharCode(65+i),r}getColorString(t){return"#"+d.format("{0:X8}",t.toArgb()).substr(2)}getCellStyleNumber(t,e,i,r){let n=new E,s=!0,o=!0;for(let n=0;n<i;n++)null==this.matrix.bordersY[t+n][e]&&(s=!1),null==this.matrix.bordersY[t+n][e+r]&&(o=!1);let a=!0,l=!0,m;for(let n=0;n<r;n++)null==this.matrix.bordersX[t][e+n]&&(a=!1),null==this.matrix.bordersX[t+i][e+n]&&(l=!1);if(a&&(n.BorderTop=this.getStringFromBorder(this.matrix.bordersX[t][e])),s&&(n.BorderLeft=this.getStringFromBorder(this.matrix.bordersY[t][e])),l&&(n.BorderBottom=this.getStringFromBorder(this.matrix.bordersX[t+i][e])),o&&(n.BorderRight=this.getStringFromBorder(this.matrix.bordersY[t][e+r])),null!=this.matrix.cells[t][e]){let i=this.matrix.cells[t][e];if(n.BackColor=i.cellStyle.color,n.VertAlign=i.cellStyle.vertAlignment,null!=i.cellStyle.textOptions){let t=i.cellStyle.textOptions.angle;(t>45&&t<135||t>225&&t<315)&&(i.cellStyle.horAlignment==StiTextHorAlignment.Left&&(n.VertAlign=StiVertAlignment.Bottom),i.cellStyle.horAlignment==StiTextHorAlignment.Center&&(n.VertAlign=StiVertAlignment.Center),i.cellStyle.horAlignment==StiTextHorAlignment.Right&&(n.VertAlign=StiVertAlignment.Top),i.cellStyle.horAlignment==StiTextHorAlignment.Width&&(n.VertAlign=StiVertAlignment.Bottom))}}if(this.cellStyleList.length>0)for(let t=0;t<this.cellStyleList.length;t++){let e=this.cellStyleList[t];if(e.BorderLeft==n.BorderLeft&&e.BorderRight==n.BorderRight&&e.BorderTop==n.BorderTop&&e.BorderBottom==n.BorderBottom&&e.BackColor.equals(n.BackColor)&&e.VertAlign==n.VertAlign)return t}return this.cellStyleList.push(n),this.cellStyleList.length-1}getStringFromBorder(t){return d.format("{0} solid {1}",this.doubleToString(t.size),this.getColorString(t.color))}getParagraphStyleNumber(t,e){let i=this.matrix.cells[t][e].cellStyle,r=new v;r.FontName=i.font.name,r.FontSize=i.font.sizeInPoints,r.Bold=i.font.bold,r.Italic=i.font.italic,r.Underline=i.font.underline,r.FontColor=i.textColor,r.HorAlign=i.horAlignment;let n=0,s;if(null!=i.textOptions&&(n=i.textOptions.angle),n>45&&n<135&&(r.Angle=90),n>225&&n<315&&(r.Angle=270),0!=r.Angle&&(i.vertAlignment==StiVertAlignment.Top&&(r.HorAlign=StiTextHorAlignment.Left),i.vertAlignment==StiVertAlignment.Center&&(r.HorAlign=StiTextHorAlignment.Center),i.vertAlignment==StiVertAlignment.Bottom&&(r.HorAlign=StiTextHorAlignment.Right)),this.paragraphStyleList.length>0)for(let t=0;t<this.paragraphStyleList.length;t++){let e=this.paragraphStyleList[t];if(e.FontName==r.FontName&&e.FontSize==r.FontSize&&e.Bold==r.Bold&&e.Italic==r.Italic&&e.Underline==r.Underline&&e.FontColor.equals(r.FontColor)&&e.HorAlign==r.HorAlign&&e.Angle==r.Angle)return t}return this.paragraphStyleList.push(r),this.paragraphStyleList.length-1}writeMimetype(){let t=new u,e=new w(t,p.ASCII);return e.write("application/vnd.oasis.opendocument.text"),e.flush(),t}writeMeta(){let t=new u,e=new h(p.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?g.None:g.Indented,e.writeStartDocument(),e.writeStartElement("office:document-meta"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),e.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:meta");let i=d.format("{0}",c.now.toString("yyyy-MM-ddTHH:mm:ss"));return e.writeElementString("meta:generator","Stimulsoft Reports"),e.writeElementString("meta:creation-date",i),e.writeElementString("dc:date",i),e.writeElementString("meta:editing-cycles","1"),e.writeElementString("meta:editing-duration","PT0M01S"),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 1"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 2"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 3"),e.writeEndElement(),e.writeStartElement("meta:user-defined"),e.writeAttributeString("meta:name","Info 4"),e.writeEndElement(),e.writeStartElement("meta:document-statistic"),e.writeAttributeString("meta:table-count","1"),e.writeAttributeString("meta:image-count","0"),e.writeAttributeString("meta:object-count","0"),e.writeAttributeString("meta:page-count","1"),e.writeAttributeString("meta:paragraph-count","1"),e.writeAttributeString("meta:word-count","1"),e.writeAttributeString("meta:character-count","1"),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeManifest(){let t=new u,e=new h(p.UTF8,t);e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?g.None:g.Indented,e.writeStartDocument(),e.writeStartElement("manifest:manifest"),e.writeAttributeString("xmlns:manifest","urn:oasis:names:tc:opendocument:xmlns:manifest:1.0"),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","application/vnd.oasis.opendocument.text"),e.writeAttributeString("manifest:full-path","/"),e.writeEndElement();for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft.countItems;t++)e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","image/jpeg"),e.writeAttributeString("manifest:full-path",d.format("Pictures/{0:D5}.jpg",t+1)),e.writeEndElement();return e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","content.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","styles.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","meta.xml"),e.writeEndElement(),e.writeStartElement("manifest:file-entry"),e.writeAttributeString("manifest:media-type","text/xml"),e.writeAttributeString("manifest:full-path","settings.xml"),e.writeEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeImage(t){let e=new u,i=this.imageCache.imagePackedStore[t];return e.write(i,0,i.length),e}writeSettings(){let t=new u,e=new h(p.UTF8,t);return e.indentation=this.xmlIndentation<0?0:this.xmlIndentation,e.formatting=this.xmlIndentation<0?g.None:g.Indented,e.writeStartDocument(),e.writeStartElement("office:document-settings"),e.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),e.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),e.writeAttributeString("xmlns:config","urn:oasis:names:tc:opendocument:xmlns:config:1.0"),e.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),e.writeAttributeString("office:version","1.1"),e.writeStartElement("office:settings"),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:view-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaWidth"),e.writeAttributeString("config:type","int"),e.writeString("43208"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewAreaHeight"),e.writeAttributeString("config:type","int"),e.writeString("22174"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ShowRedlineChanges"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","InBrowseMode"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item-map-indexed"),e.writeAttributeString("config:name","Views"),e.writeStartElement("config:config-item-map-entry"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewId"),e.writeAttributeString("config:type","string"),e.writeString("view2"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewLeft"),e.writeAttributeString("config:type","int"),e.writeString("3002"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ViewTop"),e.writeAttributeString("config:type","int"),e.writeString("10435"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleLeft"),e.writeAttributeString("config:type","int"),e.writeString("-10107"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleTop"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleRight"),e.writeAttributeString("config:type","int"),e.writeString("33099"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","VisibleBottom"),e.writeAttributeString("config:type","int"),e.writeString("22172"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ZoomFactor"),e.writeAttributeString("config:type","short"),e.writeString("100"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsSelectedFrame"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("config:config-item-set"),e.writeAttributeString("config:name","ooo:configuration-settings"),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintReversed"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","OutlineLevelYieldsNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LinkUpdateMode"),e.writeAttributeString("config:type","short"),e.writeString("1"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintEmptyPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreFirstLineIndentInNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CharacterCompressionType"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintSingleJobs"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UpdateFromTemplate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPaperFromSetup"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddFrameOffsets"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintLeftPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","RedlineProtectionKey"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintTables"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ChartAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintControls"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterSetup"),e.writeAttributeString("config:type","base64Binary"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IgnoreTabsAndBlanksForLineCalculation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintAnnotationMode"),e.writeAttributeString("config:type","short"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","LoadReadonly"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaSpacingToTableCells"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddExternalLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ApplyUserData"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","FieldAutoUpdate"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveVersionOnClose"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","SaveGlobalDocumentLinks"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsKernAsianPunctuation"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AlignTabStopPosition"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ClipAsCharacterAnchoredWriterFlyFrames"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseDataSource"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotCaptureDrawObjsOnPage"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","TableRowKeep"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintFaxName"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","ConsiderTextWrapOnObjPos"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldPrinterMetrics"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintRightPages"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","IsLabelDocument"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerLineSpacing"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AddParaTableSpacingAtStart"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerTextWrapping"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotResetParaAttrsForNumFont"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintProspect"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintGraphics"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","AllowPrintJobCancel"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommandType"),e.writeAttributeString("config:type","int"),e.writeString("0"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","DoNotJustifyLinesWithManualBreak"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseFormerObjectPositioning"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrinterIndependentLayout"),e.writeAttributeString("config:type","string"),e.writeString("high-resolution"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UseOldNumbering"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintPageBackground"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","CurrentDatabaseCommand"),e.writeAttributeString("config:type","string"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintDrawings"),e.writeAttributeString("config:type","boolean"),e.writeString("true"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","PrintBlackFonts"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeStartElement("config:config-item"),e.writeAttributeString("config:name","UnxForceZeroExtLeading"),e.writeAttributeString("config:type","boolean"),e.writeString("false"),e.writeEndElement(),e.writeEndElement(),e.writeFullEndElement(),e.writeFullEndElement(),e.writeEndDocument(),e.flush(),t}writeStyles(t){let e=new u,i=new h(p.UTF8,e);i.indentation=this.xmlIndentation<0?0:this.xmlIndentation,i.formatting=this.xmlIndentation<0?g.None:g.Indented,i.writeStartDocument(),i.writeStartElement("office:document-styles"),i.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),i.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),i.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),i.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),i.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),i.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),i.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),i.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),i.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),i.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),i.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),i.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),i.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),i.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),i.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),i.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),i.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),i.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),i.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),i.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),i.writeAttributeString("office:version","1.1"),i.writeStartElement("office:font-face-decls"),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Arial"),i.writeAttributeString("svg:font-family","Arial"),i.writeEndElement(),i.writeStartElement("style:font-face"),i.writeAttributeString("style:name","Tahoma"),i.writeAttributeString("svg:font-family","Tahoma"),i.writeAttributeString("style:font-family-generic","system"),i.writeAttributeString("style:font-pitch","variable"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("office:styles"),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","graphic"),i.writeStartElement("style:graphic-properties"),i.writeAttributeString("draw:shadow-offset-x","0.3cm"),i.writeAttributeString("draw:shadow-offset-y","0.3cm"),i.writeAttributeString("draw:start-line-spacing-horizontal","0.283cm"),i.writeAttributeString("draw:start-line-spacing-vertical","0.283cm"),i.writeAttributeString("draw:end-line-spacing-horizontal","0.283cm"),i.writeAttributeString("draw:end-line-spacing-vertical","0.283cm"),i.writeAttributeString("style:flow-with-text","false"),i.writeEndElement(),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("style:text-autospace","ideograph-alpha"),i.writeAttributeString("style:line-break","strict"),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeAttributeString("style:font-independent-line-spacing","false"),i.writeStartElement("style:tab-stops"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:use-window-font-color","true"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("style:letter-kerning","true"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","paragraph"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:hyphenation-ladder-count","no-limit"),i.writeAttributeString("style:text-autospace","ideograph-alpha"),i.writeAttributeString("style:punctuation-wrap","hanging"),i.writeAttributeString("style:line-break","strict"),i.writeAttributeString("style:tab-stop-distance","1.251cm"),i.writeAttributeString("style:writing-mode","page"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:use-window-font-color","true"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("style:letter-kerning","true"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:language-asian","zxx"),i.writeAttributeString("style:country-asian","none"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:language-complex","zxx"),i.writeAttributeString("style:country-complex","none"),i.writeAttributeString("fo:hyphenate","false"),i.writeAttributeString("fo:hyphenation-remain-char-count","2"),i.writeAttributeString("fo:hyphenation-push-char-count","2"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table"),i.writeStartElement("style:table-properties"),i.writeAttributeString("table:border-model","collapsing"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:default-style"),i.writeAttributeString("style:family","table-row"),i.writeStartElement("style:table-row-properties"),i.writeAttributeString("fo:keep-together","auto"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Standard"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:class","text"),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Title"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:next-style-name","Text_20_body"),i.writeAttributeString("style:class","text"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0.423cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeAttributeString("fo:keep-with-next","always"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial1"),i.writeAttributeString("fo:font-size","14pt"),i.writeAttributeString("style:font-name-asian","Lucida Sans Unicode"),i.writeAttributeString("style:font-size-asian","14pt"),i.writeAttributeString("style:font-name-complex","Tahoma"),i.writeAttributeString("style:font-size-complex","14pt"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Text_20_body"),i.writeAttributeString("style:display-name","Text body"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","text"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Subtitle"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Title"),i.writeAttributeString("style:next-style-name","Text_20_body"),i.writeAttributeString("style:class","chapter"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:text-align","center"),i.writeAttributeString("style:justify-single-word","false"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("fo:font-size","14pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:font-size-asian","14pt"),i.writeAttributeString("style:font-style-asian","italic"),i.writeAttributeString("style:font-size-complex","14pt"),i.writeAttributeString("style:font-style-complex","italic"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","List"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Text_20_body"),i.writeAttributeString("style:class","list"),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Caption"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","extra"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("fo:margin-top","0.212cm"),i.writeAttributeString("fo:margin-bottom","0.212cm"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("fo:font-size","10pt"),i.writeAttributeString("fo:font-style","italic"),i.writeAttributeString("style:font-size-asian","12pt"),i.writeAttributeString("style:font-style-asian","italic"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeAttributeString("style:font-size-complex","12pt"),i.writeAttributeString("style:font-style-complex","italic"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Index"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","index"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeStartElement("style:text-properties"),i.writeAttributeString("style:font-name","Arial"),i.writeAttributeString("style:font-name-complex","Tahoma1"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Table_20_Contents"),i.writeAttributeString("style:display-name","Table Contents"),i.writeAttributeString("style:family","paragraph"),i.writeAttributeString("style:parent-style-name","Standard"),i.writeAttributeString("style:class","extra"),i.writeStartElement("style:paragraph-properties"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:line-number","0"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:style"),i.writeAttributeString("style:name","Graphics"),i.writeAttributeString("style:family","graphic"),i.writeStartElement("style:graphic-properties"),i.writeAttributeString("text:anchor-type","paragraph"),i.writeAttributeString("svg:x","0cm"),i.writeAttributeString("svg:y","0cm"),i.writeAttributeString("style:wrap","dynamic"),i.writeAttributeString("style:number-wrapped-paragraphs","no-limit"),i.writeAttributeString("style:wrap-contour","false"),i.writeAttributeString("style:vertical-pos","top"),i.writeAttributeString("style:vertical-rel","paragraph"),i.writeAttributeString("style:horizontal-pos","center"),i.writeAttributeString("style:horizontal-rel","paragraph"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-style"),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","1"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","2"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","3"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","4"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","5"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),
i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","6"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","7"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","8"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","9"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("text:outline-level-style"),i.writeAttributeString("text:level","10"),i.writeAttributeString("style:num-format",""),i.writeStartElement("style:list-level-properties"),i.writeAttributeString("text:min-label-distance","0.381cm"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("text:notes-configuration"),i.writeAttributeString("text:note-class","footnote"),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("text:start-value","0"),i.writeAttributeString("text:footnotes-position","page"),i.writeAttributeString("text:start-numbering-at","document"),i.writeEndElement(),i.writeStartElement("text:notes-configuration"),i.writeAttributeString("text:note-class","endnote"),i.writeAttributeString("style:num-format","i"),i.writeAttributeString("text:start-value","0"),i.writeEndElement(),i.writeStartElement("text:linenumbering-configuration"),i.writeAttributeString("text:number-lines","false"),i.writeAttributeString("text:offset","0.499cm"),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("text:number-position","left"),i.writeAttributeString("text:increment","5"),i.writeEndElement(),i.writeEndElement();let r=t.getByIndex(0),n=r.unit.convertToHInches(r.pageHeight*r.segmentPerHeight),s=r.unit.convertToHInches(r.pageWidth*r.segmentPerWidth),o=r.unit.convertToHInches(r.margins.left),a=r.unit.convertToHInches(r.margins.right),l=r.unit.convertToHInches(r.margins.top),c=r.unit.convertToHInches(r.margins.bottom)-4;return c<0&&(c=0),i.writeStartElement("office:automatic-styles"),i.writeStartElement("style:page-layout"),i.writeAttributeString("style:name","pm1"),i.writeStartElement("style:page-layout-properties"),i.writeAttributeString("fo:page-width",this.doubleToString(s)),i.writeAttributeString("fo:page-height",this.doubleToString(n)),i.writeAttributeString("style:num-format","1"),i.writeAttributeString("style:print-orientation",r.orientation==m.Portrait?"portrait":"landscape"),i.writeAttributeString("fo:margin-top",this.doubleToString(l)),i.writeAttributeString("fo:margin-bottom",this.doubleToString(c)),i.writeAttributeString("fo:margin-left",this.doubleToString(o)),i.writeAttributeString("fo:margin-right",this.doubleToString(a)),i.writeAttributeString("style:writing-mode","lr-tb"),i.writeAttributeString("style:footnote-max-height","0cm"),i.writeStartElement("style:footnote-sep"),i.writeAttributeString("style:width","0.018cm"),i.writeAttributeString("style:distance-before-sep","0.101cm"),i.writeAttributeString("style:distance-after-sep","0.101cm"),i.writeAttributeString("style:adjustment","left"),i.writeAttributeString("style:rel-width","25%"),i.writeAttributeString("style:color","#000000"),i.writeEndElement(),i.writeEndElement(),i.writeStartElement("style:header-style"),i.writeEndElement(),i.writeStartElement("style:footer-style"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeStartElement("office:master-styles"),i.writeStartElement("style:master-page"),i.writeAttributeString("style:name","Standard"),i.writeAttributeString("style:page-layout-name","pm1"),i.writeEndElement(),i.writeEndElement(),i.writeFullEndElement(),i.writeEndDocument(),i.flush(),e}writeContent(){let i=new u,n=new h(p.UTF8,i);n.indentation=this.xmlIndentation<0?0:this.xmlIndentation,n.formatting=this.xmlIndentation<0?g.None:g.Indented,n.writeStartDocument(),n.writeStartElement("office:document-content"),n.writeAttributeString("xmlns:office","urn:oasis:names:tc:opendocument:xmlns:office:1.0"),n.writeAttributeString("xmlns:style","urn:oasis:names:tc:opendocument:xmlns:style:1.0"),n.writeAttributeString("xmlns:text","urn:oasis:names:tc:opendocument:xmlns:text:1.0"),n.writeAttributeString("xmlns:table","urn:oasis:names:tc:opendocument:xmlns:table:1.0"),n.writeAttributeString("xmlns:draw","urn:oasis:names:tc:opendocument:xmlns:drawing:1.0"),n.writeAttributeString("xmlns:fo","urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0"),n.writeAttributeString("xmlns:xlink","http://www.w3.org/1999/xlink"),n.writeAttributeString("xmlns:dc","http://purl.org/dc/elements/1.1/"),n.writeAttributeString("xmlns:meta","urn:oasis:names:tc:opendocument:xmlns:meta:1.0"),n.writeAttributeString("xmlns:number","urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0"),n.writeAttributeString("xmlns:svg","urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0"),n.writeAttributeString("xmlns:chart","urn:oasis:names:tc:opendocument:xmlns:chart:1.0"),n.writeAttributeString("xmlns:dr3d","urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"),n.writeAttributeString("xmlns:math","http://www.w3.org/1998/Math/MathML"),n.writeAttributeString("xmlns:form","urn:oasis:names:tc:opendocument:xmlns:form:1.0"),n.writeAttributeString("xmlns:script","urn:oasis:names:tc:opendocument:xmlns:script:1.0"),n.writeAttributeString("xmlns:ooo","http://openoffice.org/2004/office"),n.writeAttributeString("xmlns:ooow","http://openoffice.org/2004/writer"),n.writeAttributeString("xmlns:oooc","http://openoffice.org/2004/calc"),n.writeAttributeString("xmlns:dom","http://www.w3.org/2001/xml-events"),n.writeAttributeString("xmlns:xforms","http://www.w3.org/2002/xforms"),n.writeAttributeString("xmlns:xsd","http://www.w3.org/2001/XMLSchema"),n.writeAttributeString("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),n.writeAttributeString("office:version","1.1");let s=r.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),m=r.create2(Number,this.matrix.coordY.countItems,this.matrix.coordX.countItems),c=new l,w=new l,S=[];for(let t=1;t<this.matrix.coordY.countItems;t++){let e=this.matrix.coordY.getByIndex(t)-this.matrix.coordY.getByIndex(t-1);if(!c.containsKey(e)){let t=c.count;c.set(e,t),w.set(t,e)}S[t-1]=0|c.get(e);for(let e=1;e<this.matrix.coordX.countItems;e++){let i=this.matrix.cells[t-1][e-1];if(!s[t][e])if(null!=i){for(let r=0;r<=i.height;r++)for(let n=0;n<=i.width;n++)s[t+r][e+n]=!0;m[t-1][e-1]=this.getCellStyleNumber(t-1,e-1,i.height+1,i.width+1);let r=this.getParagraphStyleNumber(t-1,e-1)}else m[t-1][e-1]=this.getCellStyleNumber(t-1,e-1,1,1)}}n.writeStartElement("office:scripts"),n.writeEndElement();let f=new l;for(let t of this.paragraphStyleList)f.set(t.FontName,t.FontName);n.writeStartElement("office:font-face-decls");for(let t of f.keys){let e=f.get(t);n.writeStartElement("style:font-face"),n.writeAttributeString("style:name",e),n.writeAttributeString("svg:font-family",e),n.writeEndElement()}n.writeEndElement(),n.writeStartElement("office:automatic-styles"),n.writeStartElement("style:style"),n.writeAttributeString("style:name","Table1"),n.writeAttributeString("style:family","table"),n.writeStartElement("style:table-properties");let E=this.matrix.coordX.getByIndex(this.matrix.coordX.countItems-1)-this.matrix.coordX.getByIndex(0);n.writeAttributeString("style:width",this.doubleToString(E)),n.writeAttributeString("table:align","left"),n.writeEndElement(),n.writeEndElement();for(let t=0;t<this.matrix.coordX.countItems-1;t++){n.writeStartElement("style:style"),n.writeAttributeString("style:name",d.format("Table1.{0}",this.getColumnName(t))),n.writeAttributeString("style:family","table-column"),n.writeStartElement("style:table-column-properties");let e=this.matrix.coordX.getByIndex(t+1)-this.matrix.coordX.getByIndex(t);n.writeAttributeString("style:column-width",this.doubleToString(e)),n.writeEndElement(),n.writeEndElement()}for(let t=0;t<c.count;t++){n.writeStartElement("style:style"),n.writeAttributeString("style:name",d.format("Table1.{0}",t+1)),n.writeAttributeString("style:family","table-row"),n.writeStartElement("style:table-row-properties");let e=w.get(t);n.writeAttributeString("style:row-height",this.doubleToString(e)),n.writeEndElement(),n.writeEndElement()}for(let t=0;t<this.cellStyleList.stimulsoft.countItems;t++){let e=this.cellStyleList[t];n.writeStartElement("style:style"),n.writeAttributeString("style:name",d.format("cell{0}",t+1)),n.writeAttributeString("style:family","table-cell"),n.writeStartElement("style:table-cell-properties"),e.VertAlign==StiVertAlignment.Center&&n.writeAttributeString("style:vertical-align","middle"),e.VertAlign==StiVertAlignment.Bottom&&n.writeAttributeString("style:vertical-align","bottom"),e.BackColor.a>0?n.writeAttributeString("fo:background-color",this.getColorString(e.BackColor)):n.writeAttributeString("fo:background-color","transparent"),n.writeAttributeString("fo:padding","0in"),n.writeAttributeString("fo:border-left",e.BorderLeft),n.writeAttributeString("fo:border-right",e.BorderRight),n.writeAttributeString("fo:border-top",e.BorderTop),n.writeAttributeString("fo:border-bottom",e.BorderBottom),n.writeEndElement(),n.writeEndElement()}for(let t=0;t<this.paragraphStyleList.stimulsoft.countItems;t++){let e=this.paragraphStyleList[t];n.writeStartElement("style:style"),n.writeAttributeString("style:name",d.format("par{0}",t+1)),n.writeAttributeString("style:family","paragraph"),n.writeAttributeString("style:parent-style-name","Table_20_Contents"),e.HorAlign!=StiTextHorAlignment.Left&&(n.writeStartElement("style:paragraph-properties"),e.HorAlign==StiTextHorAlignment.Center&&n.writeAttributeString("fo:text-align","center"),e.HorAlign==StiTextHorAlignment.Right&&n.writeAttributeString("fo:text-align","right"),e.HorAlign==StiTextHorAlignment.Width&&n.writeAttributeString("fo:text-align","justify"),n.writeEndElement()),n.writeStartElement("style:text-properties"),n.writeAttributeString("fo:color",this.getColorString(e.FontColor)),n.writeAttributeString("style:font-name",e.FontName);let i=d.format("{0}pt",e.FontSize).stimulsoft.replaceAll(",",".");n.writeAttributeString("fo:font-size",i),n.writeAttributeString("fo:font-size-asian",i),n.writeAttributeString("fo:font-size-complex",i),e.Italic&&(n.writeAttributeString("fo:font-style","italic"),n.writeAttributeString("fo:font-style-asian","italic"),n.writeAttributeString("fo:font-style-complex","italic")),e.Underline&&(n.writeAttributeString("style:text-underline-style","solid"),n.writeAttributeString("style:text-underline-width","auto"),n.writeAttributeString("style:text-underline-color","font-color")),e.Bold&&(n.writeAttributeString("fo:font-weight","bold"),n.writeAttributeString("fo:font-weight-asian","bold"),n.writeAttributeString("fo:font-weight-complex","bold")),0!=e.Angle&&n.writeAttributeString("style:text-rotation-angle",d.format("{0}",e.Angle)),n.writeEndElement(),n.writeEndElement()}n.writeStartElement("style:style"),n.writeAttributeString("style:name","parEnd"),n.writeAttributeString("style:family","paragraph"),n.writeAttributeString("style:parent-style-name","Table_20_Contents"),n.writeStartElement("style:text-properties");let b=d.format("{0}pt",1).stimulsoft.replaceAll(",",".");n.writeAttributeString("fo:font-size",b),n.writeAttributeString("fo:font-size-asian",b),n.writeAttributeString("fo:font-size-complex",b),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("style:style"),n.writeAttributeString("style:name","fr1"),n.writeAttributeString("style:family","graphic"),n.writeAttributeString("style:parent-style-name","Graphics"),n.writeStartElement("style:graphic-properties"),n.writeAttributeString("style:vertical-pos","middle"),n.writeAttributeString("style:vertical-rel","paragraph"),n.writeAttributeString("style:horizontal-pos","center"),n.writeAttributeString("style:horizontal-rel","paragraph"),n.writeAttributeString("fo:background-color","transparent"),n.writeAttributeString("style:background-transparency","100%"),n.writeAttributeString("style:shadow","none"),n.writeAttributeString("style:mirror","none"),n.writeAttributeString("fo:clip","rect(0cm 0cm 0cm 0cm)"),n.writeAttributeString("draw:luminance","0%"),n.writeAttributeString("draw:contrast","0%"),n.writeAttributeString("draw:red","0%"),n.writeAttributeString("draw:green","0%"),n.writeAttributeString("draw:blue","0%"),n.writeAttributeString("draw:gamma","100%"),n.writeAttributeString("draw:color-inversion","false"),n.writeAttributeString("draw:image-opacity","100%"),n.writeAttributeString("draw:color-mode","standard"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeStartElement("office:body"),n.writeStartElement("office:text"),n.writeStartElement("office:forms"),n.writeAttributeString("form:automatic-focus","false"),n.writeAttributeString("form:apply-design-mode","false"),n.writeEndElement(),n.writeStartElement("text:sequence-decls"),n.writeStartElement("text:sequence-decl"),n.writeAttributeString("text:display-outline-level","0"),n.writeAttributeString("text:name","Illustration"),n.writeEndElement(),n.writeStartElement("text:sequence-decl"),n.writeAttributeString("text:display-outline-level","0"),n.writeAttributeString("text:name","Table"),n.writeEndElement(),n.writeStartElement("text:sequence-decl"),n.writeAttributeString("text:display-outline-level","0"),n.writeAttributeString("text:name","Text"),n.writeEndElement(),n.writeStartElement("text:sequence-decl"),n.writeAttributeString("text:display-outline-level","0"),n.writeAttributeString("text:name","Drawing"),n.writeEndElement(),n.writeEndElement(),s=r.create2(Boolean,this.matrix.coordY.countItems,this.matrix.coordX.countItems),n.writeStartElement("table:table"),n.writeAttributeString("table:name","Table1"),n.writeAttributeString("table:style-name","Table1");for(let t=0;t<this.matrix.coordX.countItems-1;t++)n.writeStartElement("table:table-column"),n.writeAttributeString("table:style-name",d.format("Table1.{0}",this.getColumnName(t))),n.writeEndElement();let y=Math.max(this.matrix.coordY.countItems/200,1),x=0;for(let i=1;i<this.matrix.coordY.countItems;i++){let r=i/y|0;r>x&&(x=r,this.invokeExporting2(i,this.matrix.coordY.countItems,this.currentPassNumber,this.maximumPassNumber)),n.writeStartElement("table:table-row"),n.writeAttributeString("table:style-name",d.format("Table1.{0}",S[i-1]+1));for(let r=1;r<this.matrix.coordX.countItems;r++){let l=this.matrix.cells[i-1][r-1];if(s[i][r])n.writeStartElement("table:covered-table-cell"),n.writeEndElement();else if(null!=l){for(let t=0;t<=l.height;t++)for(let e=0;e<=l.width;e++)s[i+t][r+e]=!0;let c=m[i-1][r-1],g=this.getParagraphStyleNumber(i-1,r-1);if(n.writeStartElement("table:table-cell"),n.writeAttributeString("table:style-name",d.format("cell{0}",c+1)),l.width>0&&n.writeAttributeString("table:number-columns-spanned",d.format("{0}",l.width+1)),l.height>0&&n.writeAttributeString("table:number-rows-spanned",d.format("{0}",l.height+1)),n.writeAttributeString("office:value-type","string"),l.component.stimulsoft.is(a)&&!l.component.isExportAsImage(e.StiExportFormat.Odt)&&null!=l.text){let e=l.text;0!=this.paragraphStyleList[g].stimulsoft.as(v).Angle&&(e=e.stimulsoft.replaceAll("\n"," "));let i=t.Report.Export.StiExportUtils.splitString(e,!0);for(let t=0;t<i.stimulsoft.countItems;t++){let e=i[t];n.writeStartElement("text:p"),n.writeAttributeString("text:style-name",d.format("par{0}",g+1)),n.writeString(e),n.writeEndElement()}}if(l.component.isExportAsImage(e.StiExportFormat.Odt)){let t=l.component.stimulsoft.as(o);if(null!=t){let e=this.imageResolution,s={ref:e},o=t.getImage(s);if(e=s.ref,null!=o){let t=this.imageCache.addImageIntRaw(o,o.imageFormat),e=this.matrix.coordX.getByIndex(r+l.width)-this.matrix.coordX.getByIndex(r-1),s=this.matrix.coordY.getByIndex(i+l.height)-this.matrix.coordY.getByIndex(i-1);n.writeStartElement("text:p"),n.writeAttributeString("text:style-name","Table_20_Contents"),n.writeStartElement("draw:frame"),n.writeAttributeString("draw:style-name","fr1"),n.writeAttributeString("draw:name",d.format("Picture{0}",t+1)),n.writeAttributeString("text:anchor-type","paragraph"),n.writeAttributeString("svg:width",this.doubleToString(e)),n.writeAttributeString("svg:height",this.doubleToString(s)),n.writeAttributeString("draw:z-index","0"),n.writeStartElement("draw:image"),n.writeAttributeString("xlink:href",d.format("Pictures/{0:D5}.jpg",t+1)),n.writeAttributeString("xlink:type","simple"),n.writeAttributeString("xlink:show","embed"),n.writeAttributeString("xlink:actuate","onLoad"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement()}}}n.writeEndElement()}else{let t=m[i-1][r-1];n.writeStartElement("table:table-cell"),n.writeAttributeString("table:style-name",d.format("cell{0}",t+1)),n.writeEndElement()}}n.writeEndElement()}return n.writeEndElement(),n.writeStartElement("text:p"),n.writeAttributeString("text:style-name","parEnd"),n.writeEndElement(),n.writeEndElement(),n.writeEndElement(),n.writeFullEndElement(),n.writeEndDocument(),n.flush(),i}exportOdt(r,o,a){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to ODT format"),null==a)throw new Error("The 'settings' argument cannot be equal in null.");let l=a.pageRange;this.usePageHeadersAndFooters=a.usePageHeadersAndFooters,this._removeEmptySpaceAtBottom=a.removeEmptySpaceAtBottom,this.imageResolution=a.imageResolution,this.imageQuality=a.imageQuality,this.xmlIndentation=-1,this.imageQuality<0&&(this.imageQuality=0),this.imageQuality>1&&(this.imageQuality=1),this.imageResolution<10&&(this.imageResolution=10),this.imageResolution=this.imageResolution/100;try{this.imageCache=new e.StiImageCache(t["StiOptions"].Export.OpenDocumentWriter.allowImageComparer,!0,s.Jpeg,this.imageQuality,!1),this.cellStyleList=[],this.paragraphStyleList=[],this.currentPassNumber=0,this.maximumPassNumber=3+(t["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0);let a=l.getSelectedPages(r.renderedPages);if(t["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages&&(a=i.StiSegmentPagesDivider.divide(a,this),this.currentPassNumber++),this.isStopped)return;let m=new n;if(m.begin(o,!0),this._matrix=new i.StiMatrix(a,!0,this),this.currentPassNumber=2+(t["StiOptions"].Export.OpenDocumentWriter.divideSegmentPages?1:0),m.addFile("content.xml",this.writeContent()),m.addFile("mimetype",this.writeMimetype()),m.addFile("meta.xml",this.writeMeta()),m.addFile("META-INF/manifest.xml",this.writeManifest()),m.addFile("settings.xml",this.writeSettings()),m.addFile("styles.xml",this.writeStyles(a)),this.imageCache.imagePackedStore.stimulsoft.countItems>0)for(let t=0;t<this.imageCache.imagePackedStore.stimulsoft.countItems;t++)m.addFile(d.format("Pictures/{0:D5}.jpg",t+1),this.writeImage(t));m.end()}finally{null!=this.matrix&&(this.matrix.clear(),this._matrix=null),this.cellStyleList.stimulsoft.clear(),this.cellStyleList=null,this.paragraphStyleList.stimulsoft.clear(),this.paragraphStyleList=null,this.imageCache.clear(),this.imageCache=null,r.renderedPages.cacheMode&&i.StiMatrix.GCCollect()}}}i.StiOdtExportService=b}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.Base.Localization.StiLocalization;class n{}class s{}class o extends i.StiExportService{constructor(){super(...arguments),this.colorList=null,this.fontList=null,this.styleList=null,this.unicodeMapArray=null,this.codePageToFont=null,this.charsetCount=0,this.fontToCodePages=null,this.baseFontNumber=0,this.usePageHeadersAndFooters=!1,this.imageResolution=.96,this.imageQuality=.75,this.imageFormat=e.StiExportFormat.Rtf,this.useStyles=!1,this.bookmarkList=null,this.usedBookmarks=null}get defaultExtension(){return"rtf"}get exportFormat(){return e.StiExportFormat.Rtf}get groupCategory(){return"Word"}get position(){return i.StiExportPosition.Rtf}get exportNameInMenu(){return r.get("Export","ExportTypeRtfFile")}getFilter(){return r.get("FileFilters","RtfFiles")}exportTo(t,e,i){}get multipleFiles(){return!1}getColorNumberInt(t,e){if(t.length>0)for(let i=0;i<t.length;i++)if(t[i].stimulsoft.equals(e))return i;let i;return t.push(e),t.length-1}getColorNumber(t,e){return this.getColorNumberInt(t,e).toString()}getFontNumber2(t,e){if(t.length>0)for(let i=0;i<t.length;i++){let r;if(t[i].name==e.name)return i*(0==this.charsetCount?1:this.charsetCount)}let i;return t.push(e),(t.length-1)*(0==this.charsetCount?1:this.charsetCount)}getFontNumber3(t,e,i){if(t.length>0)for(let r=0;r<t.length;r++){let n;if(t[r].name==e.name)return r*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(i)}let r;return t.push(e),(t.length-1)*(0==this.charsetCount?1:this.charsetCount)+this.getCharsetIndex(i)}getCharsetIndex(t){let e=0;if(0==this.charsetCount)return this.codePageToFont[e]=1,0;return this.codePageToFont[e]}}i.StiRtfExportService=o}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={})),function(t){var e;!function(e){var i;!function(i){var r=t.Report.Export.StiTxtBorderType,n=t.Report.Components.IStiTextHorAlignment,s=t.Report.Components.IStiVertAlignment,o=t.Base.Drawing.StiTextRenderer,a=t.Base.Drawing.StiHtmlState,l=t.Report.Components.StiText,m=t.Report.Components.StiCheckBox,c=t.System.StiString,g=t.System.IO.StreamWriter,h=t.System.StiArray,p=t.Report.Components.IStiTextOptions,w=t.System.Char,S=t.System.Text.StringBuilder,d=t.System.IO.MemoryStream,u=t.Base.Drawing.StiTextHorAlignment,f=t.Base.Localization.StiLocalization;class E extends i.StiExportService{constructor(){super(...arguments),this.borderCodes=[6,9,12,10,5,3,13,11,14,7,15,1,2,4,8],this.firstEscapeCodeIndex=63742,this.ltrMark=" 0E",this.useFullVerticalBorder=!0,this.useFullHorizontalBorder=!0}implements(){return[i.IStiTxtExportService]}get defaultExtension(){return"txt"}exportTo(t,e,i){this.exportTxt(t,e,i)}exportToAsync(t,e,i,r){this.exportTo(e,i,r),t()}get exportFormat(){return e.StiExportFormat.Text}get groupCategory(){return"Word"}get position(){return i.StiExportPosition.Txt}get exportNameInMenu(){return f.get("Export","ExportTypeTxtFile")}getFilter(){return f.get("FileFilters","TxtFiles")}get multipleFiles(){return!1}getBorderChar(t,e){if(this.useFullVerticalBorder)switch(e){case r.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼ ─  ".charCodeAt(t);case r.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬ ═  ".charCodeAt(t);default:return"-|+++++++++ -  ".charCodeAt(t)}else switch(e){case r.UnicodeSingle:return"─│┌┐└┘├┤┬┴┼    ".charCodeAt(t);case r.UnicodeDouble:return"═║╔╗╚╝╠╣╦╩╬    ".charCodeAt(t);default:return"-|+++++++++    ".charCodeAt(t)}}lineFill(t,e,i,r){let n=this.borderCodes[e-1];for(let e=0;e<r;e++)-1==this.borderCodes.indexOf(t[i+e])?32==t[i+e]&&(t[i+e]=n):t[i+e]|=n}lineFillChar(t,e,i,r){for(let n=0;n<r;n++)t[i+n]=e}checkWordWrap(t,e,r,n){let s=e.ref;if(this.useEscapeCodes)for(let t=0;t<s.length;t++){let e=s[t],r=new S(e);if(i.StiBidirectionalConvert.stringContainArabicOrHebrew(e)){let t=e.length;while(w.isWhitespace(e,t-1))t--;r.insert(t,"<#ltrMark>")}let n=0;while(n<r.length){if("<"==r.charAt(n)&&n<r.length+1&&"#"==r.charAt(n+1)){let t=n,e=new S;while("<"==r.charAt(t)&&t<r.length+1&&"#"==r.charAt(t+1)){while(t<r.length&&">"!=r.charAt(t))e.append(r.charAt(t)),t++;if(e.append(">"),t++,t>r.length-1)break}t>r.length-1?e.append(String.fromCharCode(65535)):(e.append(r.charAt(t)),t++);let i=this.getEscapeNumber(this.escapeCodesList,e.toString());r.remove(n,t-n),r.insert(n,String.fromCharCode(this.firstEscapeCodeIndex-i))}n++}r.length!=s[t].length&&(s[t]=r.toString())}else for(let t=0;t<s.length;t++)if(i.StiBidirectionalConvert.stringContainArabicOrHebrew(s[t])){let e=s[t],i=e.length-1;while(w.isWhitespace(e,i))i--;let r=e.charAt(i)+this.ltrMark,n=this.getEscapeNumber(this.escapeCodesList,r);i==e.length-1?s[t]=e.substring(0,i)+String.fromCharCode(this.firstEscapeCodeIndex-n):s[t]=e.substring(0,i)+String.fromCharCode(this.firstEscapeCodeIndex-n)+e.substring(i+1)}let o=r;this.useFullVerticalBorder?this.needVerticalBorders[t.left+t.width]&&o--:!this.useFullTextBoxWidth&&o>1&&o--;let a=!1,l=t.component.stimulsoft.as(p);if(null!=l&&(a=l.textOptions.wordWrap),a){let t=s.stimulsoft.clone();for(let e=0;e<t.length;e++){let i=t[e];if(i.length>o-1&&o>1){let r=h.create(Number,i.length),n=0,s=0;while(" "==i.charAt(s))r[s]=n,s++;for(let t=s;t<i.length;t++)" "==i.charAt(t)&&n++,r[t]=n;let a=o-1-1,l=a;if(r[a]>0)if(r[a]!=r[a+1]){l=a++;while(" "==i.charAt(a))a++}else{while(" "!=i.charAt(a))a--;l=a++;while(" "==i.charAt(l))l--}else a++;t[e]=i.substring(0,l+1),t.stimulsoft.insert(e+1,i.substr(a,i.length-a))}}t.length>s.length&&(s=t)}if(n)for(let t=0;t<s.length;t++)s[t].length>o&&(s[t]=s[t].substring(0,o));e.ref=s}checkGrow(t,e,i){while(t.length<=i)t.push([]),e.push(!1)}addCharsToLine(t,e,i,r){for(let n=0;n<i;n++)t[e].push(r)}getStyleNumber(t,e){if(t.length>0)for(let i=0;i<t.length;i++){let r=t[i];if(r.Bold==e.Bold&&r.Italic==e.Italic&&r.Underline==e.Underline&&r.Codes==e.Codes)return i}let i;return t.push(e),t.length-1}getEscapeNumber(t,e){if(t.length>0)for(let i=0;i<t.length;i++)if(t[i]==e)return i+1;let i;return t.push(e),t.length}getEscapeNames(t,e){let i=this.styleList[t],r=this.styleList[e],n=new S;return!i.Bold&&r.Bold&&n.append("<#b>"),i.Bold&&!r.Bold&&n.append("<#/b>"),!i.Italic&&r.Italic&&n.append("<#i>"),i.Italic&&!r.Italic&&n.append("<#/i>"),!i.Underline&&r.Underline&&n.append("<#u>"),i.Underline&&!r.Underline&&n.append("<#/u>"),n}exportTxt(r,p,w){if(e.StiLogService.write(this.stimulsoft.getType(),"Export report to Text format"),this.report=r,null==w)throw new Error("The 'settings' argument cannot be equal in null.");let f=w.pageRange,E=w.encoding,b=w.drawBorder,y=w.borderType,x=w.killSpaceLines,A=w.killSpaceGraphLines,T=w.putFeedPageCode,P=w.cutLongLines,L=w.zoomX,C=w.zoomY;this.useEscapeCodes=w.useEscapeCodes;let F=w.escapeCodesCollectionName;this.useFullTextBoxWidth=t["StiOptions"].Export.Text.useFullTextBoxWidth,this.useFullVerticalBorder=t["StiOptions"].Export.Text.useFullVerticalBorder,this.useFullHorizontalBorder=t["StiOptions"].Export.Text.useFullHorizontalBorder;const R=9.7,B=18;0==x&&(A=!1),0==b&&(A=!1),this.useFullVerticalBorder&&(this.useFullTextBoxWidth=!1);let I=new d,k=null!=E?new g(I,E):new g(I),D=f.getSelectedPages(r.renderedPages),N=0;this.styleList=[];let H=new v;this.getStyleNumber(this.styleList,H),this.escapeCodesList=[],this.currentPassNumber=0,this.maximumPassNumber=3;let O=new i.StiMatrix(D,!1,this);if(this.isStopped)return;this.needVerticalBorders=h.create(Boolean,O.coordX.countItems);for(let t=1;t<O.coordX.countItems;t++){let e=!1;for(let i=1;i<O.coordY.countItems;i++)if(null!=O.bordersY[i-1][t]){e=!0;break}this.needVerticalBorders[t-1]=e}this.needHorizontalBorders=h.create(Boolean,O.coordY.countItems);for(let t=1;t<O.coordY.countItems;t++){let e=!1;for(let i=1;i<O.coordX.countItems;i++)if(null!=O.bordersX[t][i-1]){e=!0;break}this.needHorizontalBorders[t-1]=e}let M=h.create(Number,O.coordX.countItems);for(let t=1;t<O.coordX.countItems;t++){let e=O.coordX.getByIndex(t),i=O.coordX.getByIndex(t-1);M[t-1]=Math.round((e-i)/(R/L)),this.useFullVerticalBorder&&this.needVerticalBorders[t-1]&&M[t-1]++}let U=h.create2(Boolean,O.coordY.countItems,O.coordX.countItems),X=h.create2(Number,O.coordY.countItems,O.coordX.countItems),W=h.create2(Number,O.coordY.countItems,O.coordX.countItems);for(let r=1;r<O.coordY.countItems;r++)for(let n=1;n<O.coordX.countItems;n++)if(!U[r-1][n-1]){let s=O.cells[r-1][n-1];if(X[r-1][n-1]=M[n-1],null!=s){if(s.width>0)for(let t=0;t<s.width;t++)X[r-1][n-1]+=M[n-1+1+t];if(null!=s.component){if(null!=s.component){let t=s.component.tagValue;if(!c.isNullOrWhiteSpace(t)){t=t.trim();let e=parseInt(t);!isNaN(e)&&e>0&&(X[r-1][n-1]=e,this.useFullVerticalBorder&&this.needVerticalBorders[n-1+s.width]&&X[r-1][n-1]++)}}let g=s.text,h=s.component.stimulsoft.as(m);if(null!=h&&null!=h.checkedValue){let e=!1,i=!1;h.checkedValue.stimulsoft.is(Boolean)&&(h.checkedValue?e=!0:i=!0),h.checkedValue.stimulsoft.is(String)&&("True"==h.checkedValue?e=!0:i=!0),e&&(g=t["StiOptions"].Export.Text.checkBoxTextForTrue),i&&(g=t["StiOptions"].Export.Text.checkBoxTextForFalse)}if(!s.component.isExportAsImage(e.StiExportFormat.Text)&&!c.isNullOrEmpty(g)){if(s.component.stimulsoft.is(l)&&s.component.stimulsoft.as(l).checkAllowHtmlTags()){let t=new a(""),e=o.parseHtmlToStates(g,t),i=new S;for(let t of e)i.append(o.prepareStateText(t.text));g=i.toString()}let t=i.StiExportUtils.splitString(g.stimulsoft.replaceAll("\r",""),!1),e={ref:t};this.checkWordWrap(s,e,X[r-1][n-1],P),t=e.ref;let m=t.length;W[r-1][n-1]=m}}for(let t=0;t<=s.height;t++){for(let e=0;e<=s.width;e++)U[r-1+t][n-1+e]=!0;X[r-1+t][n-1]=X[r-1][n-1]}}}let z=h.create(Number,O.coordY.countItems);N=1;for(let t=1;t<O.coordY.countItems;t++){let e=O.coordY.getByIndex(t),i=O.coordY.getByIndex(t-1),r=Math.round((e-i)/(B/C));r<1&&(r=1);for(let e=1;e<O.coordX.countItems;e++){let i=O.cells[t-1][e-1];null!=i&&i.height<1&&W[t-1][e-1]>r&&(r=W[t-1][e-1])}this.useFullHorizontalBorder&&this.needHorizontalBorders[t-1]&&r++,z[t-1]=r,N+=r}N++;let j=[],Y=[],G=[];for(let t=0;t<N;t++)j.push([]),Y.push([]),G.push(!1);U=h.create2(Boolean,O.coordY.countItems,O.coordX.countItems);let V=b?1:0,_=new l;_.vertAlignment=StiVertAlignment.Center,_.horAlignment=u.Center,this.currentPassNumber=2;for(let r=1;r<O.coordY.countItems;r++){this.invokeExporting2(r,O.coordY.countItems,this.currentPassNumber,this.maximumPassNumber);for(let t=0;t<O.horizontalPageBreaks.length;t++)O.horizontalPageBreaks[t]==r-1&&(G[V-(b&&r>1&&this.needHorizontalBorders[r-1-1]?1:0)]=!0);let g=b?1:0;for(let h=1;h<O.coordX.countItems;h++){let p=O.cells[r-1][h-1],w=X[r-1][h-1],d=z[r-1];if(!U[r-1][h-1]){let f=0,E=0,y=0;if(null!=p){f=p.width,E=p.height;for(let t=0;t<=p.width;t++)for(let e=0;e<=p.height;e++)U[r-1+e][h-1+t]=!0;if(p.height>0)for(let t=0;t<p.height;t++)d+=z[r-1+1+t];if(this.useFullHorizontalBorder&&this.needHorizontalBorders[r-1+E]&&d--,null!=p.component){let f=p.component.stimulsoft.as(l);if(null!=f){let t=new v;t.Bold=f.font.bold,t.Italic=f.font.italic,t.Underline=f.font.underline,t.Codes=null,y=this.getStyleNumber(this.styleList,t)}let E=p.text,b=p.component.stimulsoft.as(m);if(null!=b&&null!=b.checkedValue){let e=!1,i=!1;b.checkedValue.stimulsoft.is(Boolean)&&(b.checkedValue?e=!0:i=!0),b.checkedValue.stimulsoft.is(String)&&("True"==b.checkedValue?e=!0:i=!0),e&&(E=t["StiOptions"].Export.Text.checkBoxTextForTrue),i&&(E=t["StiOptions"].Export.Text.checkBoxTextForFalse)}if(!p.component.isExportAsImage(e.StiExportFormat.Text)&&!c.isNullOrEmpty(E)){if(p.component.stimulsoft.is(l)&&p.component.stimulsoft.as(l).checkAllowHtmlTags()){let t=new a(""),e=o.parseHtmlToStates(E,t),i=new S;for(let t of e)i.append(o.prepareStateText(t.text));E=i.toString()}let t=i.StiExportUtils.splitString(E.stimulsoft.replaceAll("\r",""),!1),e={ref:t};this.checkWordWrap(p,e,X[r-1][h-1],P),t=e.ref;let m=0,c=p.component.stimulsoft.as(s);null!=b&&(c=_),null!=c&&t.length<d&&((c.vertAlignment&StiVertAlignment.Center)>0&&(m=Math.trunc((d-t.length)/2)),(c.vertAlignment&StiVertAlignment.Bottom)>0&&(m=d-t.length));for(let e=0;e<t.length;e++){let i=0,r=w;this.useFullVerticalBorder?this.needVerticalBorders[p.left+p.width]&&r--:!this.useFullTextBoxWidth&&r>1&&r--;let s=p.component.stimulsoft.as(n);null!=b&&(s=_),null!=s&&(s.horAlignment==u.Center&&(i=Math.trunc((r-t[e].length)/2)),s.horAlignment==u.Right&&(i=r-t[e].length));let o=g+i,a=V+m+e;o<0&&(o=0);let l=o+t[e].length;this.checkGrow(j,G,a),j[a].length<l&&this.addCharsToLine(j,a,l-j[a].length,32);for(let i=0;i<t[e].length;i++){let r=t[e].charCodeAt(i);r<32&&(r+=65280),j[a][o+i]=r}}}}}else this.useFullHorizontalBorder&&this.needHorizontalBorders[r-1]&&d--;this.useFullHorizontalBorder||d--;for(let t=0;t<d;t++){Y[V+t].length<g+w&&this.addCharsToLine(Y,V+t,g+w-Y[V+t].length,0);let e=w;this.useFullVerticalBorder?null!=p&&this.needVerticalBorders[p.left+p.width]&&e--:!this.useFullTextBoxWidth&&e>1&&e--,this.lineFillChar(Y[V+t],y,g,e)}if(b){let t=g+w-1;for(let e=-1;e<=d;e++)this.checkGrow(j,G,V+e),j[V+e].length<t+1&&this.addCharsToLine(j,V+e,t+1-j[V+e].length,32);let e=!0,i=!0;for(let t=0;t<E+1;t++)null==O.bordersY[r-1+t][h-1]&&(e=!1),null==O.bordersY[r-1+t][h-1+f+1]&&(i=!1);let n=!0,s=!0;for(let t=0;t<f+1;t++)null==O.bordersX[r-1][h-1+t]&&(n=!1),null==O.bordersX[r-1+E+1][h-1+t]&&(s=!1);if(n&&(this.lineFill(j[V-1],14,g-1,1),this.lineFill(j[V-1],1,g,w-1),this.lineFill(j[V-1],13,g+w-1,1)),e){this.lineFill(j[V-1],15,g-1,1);for(let t=0;t<d;t++)this.lineFill(j[V+t],2,g-1,1);this.lineFill(j[V+d],12,g-1,1)}if(i){this.lineFill(j[V-1],15,g+w-1,1);for(let t=0;t<d;t++)this.lineFill(j[V+t],2,g+w-1,1);this.lineFill(j[V+d],12,g+w-1,1)}s&&(this.lineFill(j[V+d],14,g-1,1),this.lineFill(j[V+d],1,g,w-1),this.lineFill(j[V+d],13,g+w-1,1))}}g+=w}V+=z[r-1]}if(b){let t=!0;for(let e=0;e<j.length;e++)if(j[e].length>0&&32!=j[e][0]){t=!1;break}if(t)for(let t=0;t<j.length;t++)j[t].length>0&&j[t].stimulsoft.removeRange(0,1),Y[t].length>0&&Y[t].stimulsoft.removeRange(0,1)}if(!(t.Base.jlFrR.QjjKg.ILZdh()||t.Base.jlFrR.QjjKg.ZPBpE()||(t.Base.jlFrR.QjjKg.IUXAv()||t.Base.jlFrR.QjjKg.vqVPJ()||t.Base.jlFrR.QjjKg.GHewH())&&t.System.NodeJs.isStandaloneVersion)){let t=(O.coordX.getByIndex(O.coordX.countItems-1)-O.coordX.getByIndex(0))/(R/L),e=Math.max(1,Math.trunc(t/2-10));k.writeLine(c.fill(" ",e)+"---=== TRIAL ===---\r\n")}let q=j.length-1;while(q>0&&0==j[q].length)q--;let K=0;for(let e=0;e<j.length;e++){if(j[e].length>0){for(let t=0;t<this.borderCodes.length;t++){let i=this.borderCodes[t],r=this.getBorderChar(t,y);for(let t=0;t<j[e].length;t++)j[e][t]==i&&(j[e][t]=r)}if(t["StiOptions"].Export.Text.trimTrailingSpaces,A){let t=this.getBorderChar(1,y),i=!0;for(let r=0;r<j[e].length;r++){let n=j[e][r];n!=t&&32!=n&&(i=!1)}i&&(j[e]=[])}T&&G[e]&&(this.useEscapeCodes&&k.write(this.getEscapeNames(K,0).toString()),K=0,k.write("\f")),this.useEscapeCodes}let i=j[e];if(!x&&e<=q||i.length>0){let r=i.length;if(t["StiOptions"].Export.Text.trimTrailingSpaces)while(r>0&&32==i[r-1])r--;let n="";for(let t=0;t<r;t++){let e=i[t];e>=65280&&(e-=65280),n+=String.fromCharCode(e)}t["StiOptions"].Export.Text.removeLastNewLineMarker&&e==q?k.write(n):k.writeLine(n)}}let Q=new S;this.useEscapeCodes&&Q.append(this.getEscapeNames(K,0)),T&&Q.append("\f"),Q.length>0&&k.write(Q.toString()),k.flush(),this.useEscapeCodes,I.writeTo(p),I.close(),this.needVerticalBorders=null,this.needHorizontalBorders=null,this.styleList=null,this.escapeCodesList=null}}i.StiTxtExportService=E;class v{}}(i=e.Export||(e.Export={}))}(e=t.Report||(t.Report={}))}(Stimulsoft||(Stimulsoft={}));;
var Stimulsoft;
(function (Stimulsoft) {
    var Reflection;
    (function (Reflection) {
        class StiTypesHelper {
            static run(type, namespace) {
                if (type === undefined) {
                    StiTypesHelper.run(Stimulsoft, "Stimulsoft");
                    return;
                }
                namespace = namespace.stimulsoft.replaceAll("Stimulsoft.System", "System");
                for (let name in type) {
                    if (typeof type[name] == "function") {
                        type[name].ssTypeName = name;
                        type[name].ssNamespace = namespace;
                    }
                    else if (typeof type[name] == "object") {
                        StiTypesHelper.run(type[name], namespace + "." + name);
                    }
                }
            }
        }
        Reflection.StiTypesHelper = StiTypesHelper;
    })(Reflection = Stimulsoft.Reflection || (Stimulsoft.Reflection = {}));
})(Stimulsoft || (Stimulsoft = {}));
Stimulsoft.Reflection.StiTypesHelper.run();
if (typeof module === "object") {
    module.exports = Stimulsoft;
}
;